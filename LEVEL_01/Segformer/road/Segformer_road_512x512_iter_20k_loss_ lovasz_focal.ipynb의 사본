{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":64201,"status":"ok","timestamp":1654046692453,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"nllMQ6RCsenv","outputId":"a843d290-09ea-41af-87d0-79e345a527e5"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18513,"status":"ok","timestamp":1654046710960,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"PPb5e_glt9i6","outputId":"e140332d-e227-4fe0-b32b-a6a0fd84e186"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Looking in links: https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","Collecting mmcv-full\n","  Downloading https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/mmcv_full-1.5.2-cp37-cp37m-manylinux1_x86_64.whl (46.4 MB)\n","\u001b[K     |████████████████████████████████| 46.4 MB 10.1 MB/s \n","\u001b[?25hCollecting yapf\n","  Downloading yapf-0.32.0-py2.py3-none-any.whl (190 kB)\n","\u001b[K     |████████████████████████████████| 190 kB 4.3 MB/s \n","\u001b[?25hRequirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (4.1.2.30)\n","Collecting addict\n","  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (3.13)\n","Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (7.1.2)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (1.21.6)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (21.3)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->mmcv-full) (3.0.9)\n","Installing collected packages: yapf, addict, mmcv-full\n","Successfully installed addict-2.4.0 mmcv-full-1.5.2 yapf-0.32.0\n","Cloning into 'mmsegmentation'...\n","remote: Enumerating objects: 7196, done.\u001b[K\n","remote: Counting objects: 100% (201/201), done.\u001b[K\n","remote: Compressing objects: 100% (159/159), done.\u001b[K\n","remote: Total 7196 (delta 54), reused 157 (delta 42), pack-reused 6995\u001b[K\n","Receiving objects: 100% (7196/7196), 13.87 MiB | 13.68 MiB/s, done.\n","Resolving deltas: 100% (5226/5226), done.\n"]}],"source":["!pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","!git clone https://github.com/open-mmlab/mmsegmentation.git"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2457,"status":"ok","timestamp":1654046713395,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"zU2hdo-iuDM_","outputId":"44de2e77-2952-4f43-941b-7ece887eea89"},"outputs":[{"name":"stdout","output_type":"stream","text":["Setup complete. Using torch 1.11.0+cu113 (Tesla P100-PCIE-16GB)\n"]}],"source":["import torch\n","\n","print(f\"Setup complete. Using torch {torch.__version__} ({torch.cuda.get_device_properties(0).name if torch.cuda.is_available() else 'CPU'})\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15,"status":"ok","timestamp":1654046713396,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"5Y38Lq6KuG75","outputId":"7b1ad2aa-ac24-4bda-e142-326f5831ce8e"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/mmsegmentation\n"]}],"source":["%cd mmsegmentation"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"scnWNR9VuKnB"},"outputs":[],"source":["from mmseg.apis import inference_segmentor, init_segmentor, show_result_pyplot\n","import mmcv"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nZ7kLaEfuMhh"},"outputs":[],"source":["import os.path as osp\n","import numpy as np\n","from PIL import Image\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38950,"status":"ok","timestamp":1654046754396,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"O5uVMzGxuRlJ","outputId":"9b596dbe-07c4-4188-83f0-d93bff5bf788"},"outputs":[{"name":"stdout","output_type":"stream","text":["--2022-06-01 01:25:15--  https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","Resolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28\n","Connecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 328290585 (313M) [application/octet-stream]\n","Saving to: ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’\n","\n","//content/mmsegment 100%[===================>] 313.08M  7.56MB/s    in 37s     \n","\n","2022-06-01 01:25:54 (8.43 MB/s) - ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’ saved [328290585/328290585]\n","\n"]}],"source":["!mkdir checkpoints\n","!wget -O //content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"km0JLIuRumCX"},"outputs":[],"source":["from mmseg.datasets.builder import DATASETS\n","from mmseg.datasets.custom import CustomDataset\n","\n","classes = ('background', 'road')\n","palette = [[0, 0, 0], [255, 255, 0]]\n","\n","@DATASETS.register_module()\n","class SIADataset(CustomDataset):\n","  CLASSES = classes\n","  PALETTE = palette\n","  def __init__(self, split, **kwargs):\n","    super().__init__(img_suffix='.png', seg_map_suffix='.png', \n","                     split=split, **kwargs)\n","    assert osp.exists(self.img_dir) and self.split is not None"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":529,"status":"ok","timestamp":1654046754903,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"Qx5ugOgwuxGW","outputId":"db4f5fe8-7138-42d8-dee3-157770c4e3dd"},"outputs":[{"name":"stdout","output_type":"stream","text":["norm_cfg = dict(type='SyncBN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=19,\n","        norm_cfg=dict(type='SyncBN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=dict(\n","            type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0)),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'CityscapesDataset'\n","data_root = 'data/cityscapes/'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (1024, 1024)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","    dict(type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', prob=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(2048, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/train',\n","        ann_dir='gtFine/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","            dict(\n","                type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', prob=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ]),\n","    val=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]),\n","    test=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]))\n","log_config = dict(\n","    interval=50, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = None\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=160000)\n","checkpoint_config = dict(by_epoch=False, interval=16000)\n","evaluation = dict(interval=16000, metric='mIoU', pre_eval=True)\n","\n"]}],"source":["# config 파일을 설정하고, 다운로드 받은 pretrained 모델을 checkpoint로 설정. \n","config_file = '/content/mmsegmentation/configs/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes.py'\n","checkpoint_file = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","from mmcv import Config\n","\n","cfg = Config.fromfile(config_file)\n","print(cfg.pretty_text)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"caVFRT7QvWE8"},"outputs":[],"source":["cfg.norm_cfg = dict(type='BN', requires_grad=True)\n","#cfg.model.backbone.norm_cfg = cfg.norm_cfg\n","cfg.model.decode_head.norm_cfg = cfg.norm_cfg\n","\n","cfg.model.decode_head.num_classes = 2\n","\n","cfg.device='cuda'\n","\n","cfg.model.decode_head.loss_decode = [dict(type='FocalLoss', loss_weight = 1.0),\n","                                    dict(type='LovaszLoss', loss_weight = 1.0, reduction='none')]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X9IpatmxvYMt"},"outputs":[],"source":["cfg.img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","cfg.crop_size = (512, 512)\n","cfg.train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=cfg.crop_size, cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(type='Normalize', **cfg.img_norm_cfg),\n","    dict(type='Pad', size=cfg.crop_size, pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg']),\n","]\n","\n","cfg.val_pipeline = [\n","                    dict(type='LoadImageFromFile'),\n","                    dict(\n","                        type='MultiScaleFlipAug',\n","                        img_scale=(1024, 1024),\n","                        flip=False,\n","                        transforms=[\n","                                    dict(type='Resize', keep_ratio=True),\n","                                    dict(type='RandomFlip'),\n","                                    dict(\n","                                        type='Normalize',\n","                                        mean=[123.675, 116.28, 103.53],\n","                                        std=[58.395, 57.12, 57.375],\n","                                        to_rgb=True),\n","                                    dict(type='ImageToTensor', keys=['img']),\n","                                    dict(type='Collect', keys=['img'])\n","                                    ]),\n","                    \n","]\n","\n","cfg.test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            #dict(type='ResizeToMultiple', size_divisor=32),\n","            dict(type='RandomFlip'),\n","            dict(type='Normalize', **cfg.img_norm_cfg),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img']),\n","        ])\n","]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_4PNB6hGvds4"},"outputs":[],"source":["cfg.dataset_type = 'SIADataset'\n","cfg.data_root = '/content/drive/MyDrive/SIA'\n","\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.train.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","\n","cfg.data.val.type = 'SIADataset'\n","cfg.data.val.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.val.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.val.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.val.pipeline = cfg.test_pipeline\n","cfg.data.val.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","\n","cfg.data.test.type = 'SIADataset'\n","cfg.data.test.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.test.img_dir = 'Data_set/road_dataset/img_dir/val'\n","cfg.data.test.ann_dir = 'Data_set/road_dataset/ann_01_dir/val'\n","cfg.data.test.pipeline = cfg.test_pipeline\n","cfg.data.test.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":54},"executionInfo":{"elapsed":17,"status":"ok","timestamp":1654046754905,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"jXNN3BblvrfK","outputId":"5774c39e-cf23-476d-e0bf-ae693851c511"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["\"\\ncfg.data.train.type = 'SIADataset'\\ncfg.data.train.data_root = '/content/drive/MyDrive/SIA'\\ncfg.data.train.img_dir = 'images/up025'\\ncfg.data.train.ann_dir = 'labels'\\ncfg.data.train.pipeline = cfg.train_pipeline\\ncfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\\n\""]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["'''\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'images/up025'\n","cfg.data.train.ann_dir = 'labels'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\n","'''"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l1Gc8ttSvw8e"},"outputs":[],"source":["cfg.load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","# Set up working dir to save files and logs.\n","cfg.work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1265,"status":"ok","timestamp":1654046756160,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"vvSIfRurv0sm","outputId":"f9949f20-6c03-4c62-8ce4-7aa2dc979940"},"outputs":[{"name":"stdout","output_type":"stream","text":["Config:\n","norm_cfg = dict(type='BN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=2,\n","        norm_cfg=dict(type='BN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=[\n","            dict(type='FocalLoss', loss_weight=1.0),\n","            dict(type='LovaszLoss', loss_weight=1.0, reduction='none')\n","        ]),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'SIADataset'\n","data_root = '/content/drive/MyDrive/SIA'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (512, 512)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","            dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', flip_ratio=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","    ),\n","    val=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","    ),\n","    test=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/val',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt')\n",")\n","log_config = dict(\n","    interval=100, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=20000)\n","checkpoint_config = dict(by_epoch=False, interval=1000)\n","evaluation = dict(interval=1000, metric='mIoU', pre_eval=True)\n","device = 'cuda'\n","val_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'\n","seed = 0\n","gpu_ids = range(0, 1)\n","\n"]}],"source":["cfg.runner.max_iteTrs = 200\n","cfg.log_config.interval = 100\n","cfg.evaluation.interval = 1000  # 모델 학습시 평가를 몇 번째 iteration마다 할 것인지 지정\n","cfg.checkpoint_config.interval = 1000  # 모델 학습시 학습한 모델을 몇 번째 iteration마다 저장할 것인지 지정\n","\n","cfg.runner = dict(type='IterBasedRunner', max_iters=20000)  # Iteration으로 동작, Epoch로 동작하게 변경할 수도 있음\n","# cfg.runner = dict(type='EpochBasedRunner', max_epochs=4000)  # Epoch로 변경\n","cfg.workflow = [('train', 1)]\n","\n","# Set seed to facitate reproducing the result\n","cfg.seed = 0\n","#set_random_seed(0, deterministic=False)\n","cfg.gpu_ids = range(1)\n","\n","# Let's have a look at the final config used for training\n","print(f'Config:\\n{cfg.pretty_text}')"]},{"cell_type":"markdown","metadata":{"id":"xP_db_FP_lnS"},"source":["### 모델 학습"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14255081,"status":"ok","timestamp":1654061011240,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"8IlH2WxNwFFW","outputId":"cb62e2a5-38df-4e61-bf92-b204dc81d500"},"outputs":[{"name":"stderr","output_type":"stream","text":["2022-06-01 01:25:58,494 - mmseg - INFO - Loaded 542 images\n","2022-06-01 01:26:13,219 - mmseg - INFO - Loaded 66 images\n","2022-06-01 01:26:13,224 - mmseg - INFO - load checkpoint from local path: /content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","2022-06-01 01:26:13,756 - mmseg - WARNING - The model and loaded state dict do not match exactly\n","\n","size mismatch for decode_head.conv_seg.weight: copying a param with shape torch.Size([19, 256, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 256, 1, 1]).\n","size mismatch for decode_head.conv_seg.bias: copying a param with shape torch.Size([19]) from checkpoint, the shape in current model is torch.Size([2]).\n","2022-06-01 01:26:13,766 - mmseg - INFO - Start running, host: root@0ec7a018e4aa, work_dir: /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2\n","2022-06-01 01:26:13,767 - mmseg - INFO - Hooks will be executed in the following order:\n","before_run:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_epoch:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_iter:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n"," -------------------- \n","after_train_iter:\n","(ABOVE_NORMAL) OptimizerHook                      \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_train_epoch:\n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_epoch:\n","(LOW         ) IterTimerHook                      \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_epoch:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_run:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","2022-06-01 01:26:13,769 - mmseg - INFO - workflow: [('train', 1)], max: 20000 iters\n","2022-06-01 01:26:13,772 - mmseg - INFO - Checkpoints will be saved to /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2 by HardDiskBackend.\n","2022-06-01 01:28:29,801 - mmseg - INFO - Iter [100/20000]\tlr: 3.940e-06, eta: 7:28:33, time: 1.352, data_time: 0.953, memory: 3323, decode.loss_focal: 0.0731, decode.loss_lovasz: 0.5180, decode.acc_seg: 78.3572, loss: 0.5911\n","2022-06-01 01:30:37,263 - mmseg - INFO - Iter [200/20000]\tlr: 7.881e-06, eta: 7:13:27, time: 1.275, data_time: 0.882, memory: 3323, decode.loss_focal: 0.0614, decode.loss_lovasz: 0.4628, decode.acc_seg: 82.5499, loss: 0.5242\n","2022-06-01 01:32:46,196 - mmseg - INFO - Iter [300/20000]\tlr: 1.178e-05, eta: 7:08:37, time: 1.289, data_time: 0.898, memory: 3323, decode.loss_focal: 0.0499, decode.loss_lovasz: 0.4129, decode.acc_seg: 84.9398, loss: 0.4628\n","2022-06-01 01:34:52,940 - mmseg - INFO - Iter [400/20000]\tlr: 1.564e-05, eta: 7:03:20, time: 1.267, data_time: 0.876, memory: 3323, decode.loss_focal: 0.0429, decode.loss_lovasz: 0.3892, decode.acc_seg: 87.0852, loss: 0.4322\n","2022-06-01 01:36:59,061 - mmseg - INFO - Iter [500/20000]\tlr: 1.946e-05, eta: 6:58:55, time: 1.261, data_time: 0.871, memory: 3323, decode.loss_focal: 0.0432, decode.loss_lovasz: 0.3510, decode.acc_seg: 87.7837, loss: 0.3942\n","2022-06-01 01:38:16,574 - mmseg - INFO - Iter [600/20000]\tlr: 2.324e-05, eta: 6:29:05, time: 0.775, data_time: 0.381, memory: 3323, decode.loss_focal: 0.0429, decode.loss_lovasz: 0.3237, decode.acc_seg: 88.4881, loss: 0.3666\n","2022-06-01 01:38:57,113 - mmseg - INFO - Iter [700/20000]\tlr: 2.698e-05, eta: 5:50:24, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0443, decode.loss_lovasz: 0.3237, decode.acc_seg: 88.8644, loss: 0.3680\n","2022-06-01 01:39:37,946 - mmseg - INFO - Iter [800/20000]\tlr: 3.068e-05, eta: 5:21:21, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0435, decode.loss_lovasz: 0.3104, decode.acc_seg: 89.2376, loss: 0.3539\n","2022-06-01 01:40:19,343 - mmseg - INFO - Iter [900/20000]\tlr: 3.434e-05, eta: 4:58:48, time: 0.414, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0469, decode.loss_lovasz: 0.3121, decode.acc_seg: 89.1980, loss: 0.3591\n","2022-06-01 01:41:00,444 - mmseg - INFO - Saving checkpoint at 1000 iterations\n","2022-06-01 01:41:22,263 - mmseg - INFO - Iter [1000/20000]\tlr: 3.796e-05, eta: 4:47:26, time: 0.629, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0485, decode.loss_lovasz: 0.3133, decode.acc_seg: 89.0036, loss: 0.3618\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.2 task/s, elapsed: 296s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 01:46:18,325 - mmseg - INFO - per class results:\n","2022-06-01 01:46:18,328 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 89.87 | 94.82 |\n","|    road    | 58.52 | 73.25 |\n","+------------+-------+-------+\n","2022-06-01 01:46:18,331 - mmseg - INFO - Summary:\n","2022-06-01 01:46:18,333 - mmseg - INFO - \n","+-------+------+-------+\n","|  aAcc | mIoU |  mAcc |\n","+-------+------+-------+\n","| 91.14 | 74.2 | 84.04 |\n","+-------+------+-------+\n","2022-06-01 01:46:18,335 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9114, mIoU: 0.7420, mAcc: 0.8404, IoU.background: 0.8987, IoU.road: 0.5852, Acc.background: 0.9482, Acc.road: 0.7325\n","2022-06-01 01:47:01,422 - mmseg - INFO - Iter [1100/20000]\tlr: 4.154e-05, eta: 5:57:03, time: 3.392, data_time: 2.989, memory: 3323, decode.loss_focal: 0.0440, decode.loss_lovasz: 0.2982, decode.acc_seg: 90.0409, loss: 0.3423\n","2022-06-01 01:47:42,418 - mmseg - INFO - Iter [1200/20000]\tlr: 4.508e-05, eta: 5:36:16, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0428, decode.loss_lovasz: 0.2839, decode.acc_seg: 90.0014, loss: 0.3268\n","2022-06-01 01:48:23,541 - mmseg - INFO - Iter [1300/20000]\tlr: 4.859e-05, eta: 5:18:36, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0447, decode.loss_lovasz: 0.2957, decode.acc_seg: 89.7892, loss: 0.3404\n","2022-06-01 01:49:04,517 - mmseg - INFO - Iter [1400/20000]\tlr: 5.205e-05, eta: 5:03:20, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0466, decode.loss_lovasz: 0.2877, decode.acc_seg: 90.0930, loss: 0.3343\n","2022-06-01 01:49:45,246 - mmseg - INFO - Iter [1500/20000]\tlr: 5.547e-05, eta: 4:49:58, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0440, decode.loss_lovasz: 0.2873, decode.acc_seg: 89.8414, loss: 0.3313\n","2022-06-01 01:50:26,067 - mmseg - INFO - Iter [1600/20000]\tlr: 5.520e-05, eta: 4:38:12, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0399, decode.loss_lovasz: 0.2676, decode.acc_seg: 91.1932, loss: 0.3076\n","2022-06-01 01:51:08,891 - mmseg - INFO - Iter [1700/20000]\tlr: 5.490e-05, eta: 4:28:05, time: 0.428, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0452, decode.loss_lovasz: 0.2907, decode.acc_seg: 90.3253, loss: 0.3359\n","2022-06-01 01:51:49,732 - mmseg - INFO - Iter [1800/20000]\tlr: 5.460e-05, eta: 4:18:42, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0403, decode.loss_lovasz: 0.2696, decode.acc_seg: 91.0483, loss: 0.3100\n","2022-06-01 01:52:30,750 - mmseg - INFO - Iter [1900/20000]\tlr: 5.430e-05, eta: 4:10:15, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0418, decode.loss_lovasz: 0.2792, decode.acc_seg: 90.5992, loss: 0.3211\n","2022-06-01 01:53:11,529 - mmseg - INFO - Saving checkpoint at 2000 iterations\n","2022-06-01 01:53:31,802 - mmseg - INFO - Iter [2000/20000]\tlr: 5.400e-05, eta: 4:05:35, time: 0.610, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0457, decode.loss_lovasz: 0.2840, decode.acc_seg: 90.0911, loss: 0.3297\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 01:57:44,525 - mmseg - INFO - per class results:\n","2022-06-01 01:57:44,527 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.08 | 96.01 |\n","|    road    | 61.73 | 73.69 |\n","+------------+-------+-------+\n","2022-06-01 01:57:44,530 - mmseg - INFO - Summary:\n","2022-06-01 01:57:44,532 - mmseg - INFO - \n","+------+-------+-------+\n","| aAcc |  mIoU |  mAcc |\n","+------+-------+-------+\n","| 92.2 | 76.41 | 84.85 |\n","+------+-------+-------+\n","2022-06-01 01:57:44,534 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9220, mIoU: 0.7641, mAcc: 0.8485, IoU.background: 0.9108, IoU.road: 0.6173, Acc.background: 0.9601, Acc.road: 0.7369\n","2022-06-01 01:58:25,329 - mmseg - INFO - Iter [2100/20000]\tlr: 5.370e-05, eta: 4:34:17, time: 2.935, data_time: 2.534, memory: 3323, decode.loss_focal: 0.0418, decode.loss_lovasz: 0.2655, decode.acc_seg: 90.6979, loss: 0.3072\n","2022-06-01 01:59:08,208 - mmseg - INFO - Iter [2200/20000]\tlr: 5.340e-05, eta: 4:26:08, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0448, decode.loss_lovasz: 0.2734, decode.acc_seg: 90.5388, loss: 0.3182\n","2022-06-01 01:59:49,024 - mmseg - INFO - Iter [2300/20000]\tlr: 5.310e-05, eta: 4:18:22, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0443, decode.loss_lovasz: 0.2804, decode.acc_seg: 90.1186, loss: 0.3247\n","2022-06-01 02:00:29,874 - mmseg - INFO - Iter [2400/20000]\tlr: 5.280e-05, eta: 4:11:12, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0362, decode.loss_lovasz: 0.2434, decode.acc_seg: 92.1000, loss: 0.2796\n","2022-06-01 02:01:10,644 - mmseg - INFO - Iter [2500/20000]\tlr: 5.250e-05, eta: 4:04:32, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0414, decode.loss_lovasz: 0.2576, decode.acc_seg: 91.1301, loss: 0.2990\n","2022-06-01 02:01:51,457 - mmseg - INFO - Iter [2600/20000]\tlr: 5.220e-05, eta: 3:58:20, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0419, decode.loss_lovasz: 0.2796, decode.acc_seg: 90.8987, loss: 0.3215\n","2022-06-01 02:02:32,219 - mmseg - INFO - Iter [2700/20000]\tlr: 5.190e-05, eta: 3:52:33, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0434, decode.loss_lovasz: 0.2731, decode.acc_seg: 90.2216, loss: 0.3165\n","2022-06-01 02:03:15,094 - mmseg - INFO - Iter [2800/20000]\tlr: 5.160e-05, eta: 3:47:20, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0423, decode.loss_lovasz: 0.2661, decode.acc_seg: 90.5285, loss: 0.3084\n","2022-06-01 02:03:55,833 - mmseg - INFO - Iter [2900/20000]\tlr: 5.130e-05, eta: 3:42:13, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0378, decode.loss_lovasz: 0.2548, decode.acc_seg: 91.4103, loss: 0.2926\n","2022-06-01 02:04:36,706 - mmseg - INFO - Saving checkpoint at 3000 iterations\n","2022-06-01 02:04:55,050 - mmseg - INFO - Iter [3000/20000]\tlr: 5.100e-05, eta: 3:39:09, time: 0.592, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0393, decode.loss_lovasz: 0.2566, decode.acc_seg: 91.5302, loss: 0.2959\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 02:09:07,858 - mmseg - INFO - per class results:\n","2022-06-01 02:09:07,859 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 90.66 | 94.62 |\n","|    road    | 62.46 |  78.8 |\n","+------------+-------+-------+\n","2022-06-01 02:09:07,861 - mmseg - INFO - Summary:\n","2022-06-01 02:09:07,863 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 91.92 | 76.56 | 86.71 |\n","+-------+-------+-------+\n","2022-06-01 02:09:07,865 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9192, mIoU: 0.7656, mAcc: 0.8671, IoU.background: 0.9066, IoU.road: 0.6246, Acc.background: 0.9462, Acc.road: 0.7880\n","2022-06-01 02:09:48,482 - mmseg - INFO - Iter [3100/20000]\tlr: 5.070e-05, eta: 3:57:29, time: 2.934, data_time: 2.535, memory: 3323, decode.loss_focal: 0.0391, decode.loss_lovasz: 0.2522, decode.acc_seg: 91.6229, loss: 0.2913\n","2022-06-01 02:10:29,188 - mmseg - INFO - Iter [3200/20000]\tlr: 5.040e-05, eta: 3:52:16, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0413, decode.loss_lovasz: 0.2528, decode.acc_seg: 91.3926, loss: 0.2941\n","2022-06-01 02:11:12,005 - mmseg - INFO - Iter [3300/20000]\tlr: 5.010e-05, eta: 3:47:30, time: 0.428, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0395, decode.loss_lovasz: 0.2689, decode.acc_seg: 91.1669, loss: 0.3084\n","2022-06-01 02:11:52,680 - mmseg - INFO - Iter [3400/20000]\tlr: 4.980e-05, eta: 3:42:48, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0372, decode.loss_lovasz: 0.2470, decode.acc_seg: 91.7608, loss: 0.2842\n","2022-06-01 02:12:33,491 - mmseg - INFO - Iter [3500/20000]\tlr: 4.950e-05, eta: 3:38:20, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0390, decode.loss_lovasz: 0.2688, decode.acc_seg: 91.2056, loss: 0.3078\n","2022-06-01 02:13:14,299 - mmseg - INFO - Iter [3600/20000]\tlr: 4.920e-05, eta: 3:34:05, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0368, decode.loss_lovasz: 0.2409, decode.acc_seg: 91.9973, loss: 0.2777\n","2022-06-01 02:13:55,015 - mmseg - INFO - Iter [3700/20000]\tlr: 4.890e-05, eta: 3:30:01, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0379, decode.loss_lovasz: 0.2470, decode.acc_seg: 91.7976, loss: 0.2849\n","2022-06-01 02:14:37,887 - mmseg - INFO - Iter [3800/20000]\tlr: 4.860e-05, eta: 3:26:17, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0456, decode.loss_lovasz: 0.2637, decode.acc_seg: 90.9806, loss: 0.3093\n","2022-06-01 02:15:18,702 - mmseg - INFO - Iter [3900/20000]\tlr: 4.830e-05, eta: 3:22:33, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0421, decode.loss_lovasz: 0.2620, decode.acc_seg: 91.1355, loss: 0.3041\n","2022-06-01 02:15:59,343 - mmseg - INFO - Saving checkpoint at 4000 iterations\n","2022-06-01 02:16:16,501 - mmseg - INFO - Iter [4000/20000]\tlr: 4.800e-05, eta: 3:20:07, time: 0.578, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0392, decode.loss_lovasz: 0.2742, decode.acc_seg: 90.7631, loss: 0.3134\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 02:20:29,486 - mmseg - INFO - per class results:\n","2022-06-01 02:20:29,488 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.5 | 97.69 |\n","|    road    | 60.35 | 67.12 |\n","+------------+-------+-------+\n","2022-06-01 02:20:29,489 - mmseg - INFO - Summary:\n","2022-06-01 02:20:29,492 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.47 | 75.93 | 82.41 |\n","+-------+-------+-------+\n","2022-06-01 02:20:29,496 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9247, mIoU: 0.7593, mAcc: 0.8241, IoU.background: 0.9150, IoU.road: 0.6035, Acc.background: 0.9769, Acc.road: 0.6712\n","2022-06-01 02:21:10,371 - mmseg - INFO - Iter [4100/20000]\tlr: 4.770e-05, eta: 3:33:01, time: 2.939, data_time: 2.537, memory: 3323, decode.loss_focal: 0.0350, decode.loss_lovasz: 0.2439, decode.acc_seg: 92.0514, loss: 0.2789\n","2022-06-01 02:21:50,990 - mmseg - INFO - Iter [4200/20000]\tlr: 4.740e-05, eta: 3:29:11, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0370, decode.loss_lovasz: 0.2575, decode.acc_seg: 91.6672, loss: 0.2944\n","2022-06-01 02:22:31,758 - mmseg - INFO - Iter [4300/20000]\tlr: 4.710e-05, eta: 3:25:30, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0345, decode.loss_lovasz: 0.2342, decode.acc_seg: 92.1480, loss: 0.2687\n","2022-06-01 02:23:14,516 - mmseg - INFO - Iter [4400/20000]\tlr: 4.680e-05, eta: 3:22:05, time: 0.428, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0355, decode.loss_lovasz: 0.2343, decode.acc_seg: 92.4604, loss: 0.2698\n","2022-06-01 02:23:55,247 - mmseg - INFO - Iter [4500/20000]\tlr: 4.650e-05, eta: 3:18:40, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0353, decode.loss_lovasz: 0.2325, decode.acc_seg: 92.4517, loss: 0.2678\n","2022-06-01 02:24:35,942 - mmseg - INFO - Iter [4600/20000]\tlr: 4.620e-05, eta: 3:15:21, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0377, decode.loss_lovasz: 0.2386, decode.acc_seg: 92.0315, loss: 0.2763\n","2022-06-01 02:25:16,836 - mmseg - INFO - Iter [4700/20000]\tlr: 4.590e-05, eta: 3:12:11, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0408, decode.loss_lovasz: 0.2624, decode.acc_seg: 91.0212, loss: 0.3032\n","2022-06-01 02:25:57,464 - mmseg - INFO - Iter [4800/20000]\tlr: 4.560e-05, eta: 3:09:05, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0402, decode.loss_lovasz: 0.2528, decode.acc_seg: 91.5933, loss: 0.2930\n","2022-06-01 02:26:40,244 - mmseg - INFO - Iter [4900/20000]\tlr: 4.530e-05, eta: 3:06:12, time: 0.428, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0404, decode.loss_lovasz: 0.2376, decode.acc_seg: 91.3427, loss: 0.2781\n","2022-06-01 02:27:20,929 - mmseg - INFO - Saving checkpoint at 5000 iterations\n","2022-06-01 02:27:43,300 - mmseg - INFO - Iter [5000/20000]\tlr: 4.500e-05, eta: 3:04:26, time: 0.631, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0365, decode.loss_lovasz: 0.2426, decode.acc_seg: 92.1966, loss: 0.2791\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 254s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 02:31:57,453 - mmseg - INFO - per class results:\n","2022-06-01 02:31:57,455 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.35 | 95.33 |\n","|    road    | 64.27 | 78.86 |\n","+------------+-------+-------+\n","2022-06-01 02:31:57,457 - mmseg - INFO - Summary:\n","2022-06-01 02:31:57,459 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.52 | 77.81 | 87.09 |\n","+-------+-------+-------+\n","2022-06-01 02:31:57,462 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9252, mIoU: 0.7781, mAcc: 0.8709, IoU.background: 0.9135, IoU.road: 0.6427, Acc.background: 0.9533, Acc.road: 0.7886\n","2022-06-01 02:32:38,252 - mmseg - INFO - Iter [5100/20000]\tlr: 4.470e-05, eta: 3:13:58, time: 2.950, data_time: 2.548, memory: 3323, decode.loss_focal: 0.0367, decode.loss_lovasz: 0.2462, decode.acc_seg: 92.1669, loss: 0.2829\n","2022-06-01 02:33:19,085 - mmseg - INFO - Iter [5200/20000]\tlr: 4.440e-05, eta: 3:10:54, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0368, decode.loss_lovasz: 0.2454, decode.acc_seg: 91.7297, loss: 0.2822\n","2022-06-01 02:33:59,983 - mmseg - INFO - Iter [5300/20000]\tlr: 4.410e-05, eta: 3:07:55, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0359, decode.loss_lovasz: 0.2366, decode.acc_seg: 91.8607, loss: 0.2725\n","2022-06-01 02:34:40,869 - mmseg - INFO - Iter [5400/20000]\tlr: 4.380e-05, eta: 3:05:02, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0359, decode.loss_lovasz: 0.2419, decode.acc_seg: 92.0033, loss: 0.2778\n","2022-06-01 02:35:23,728 - mmseg - INFO - Iter [5500/20000]\tlr: 4.350e-05, eta: 3:02:18, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0352, decode.loss_lovasz: 0.2295, decode.acc_seg: 92.5266, loss: 0.2647\n","2022-06-01 02:36:04,566 - mmseg - INFO - Iter [5600/20000]\tlr: 4.320e-05, eta: 2:59:34, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0366, decode.loss_lovasz: 0.2368, decode.acc_seg: 91.8785, loss: 0.2733\n","2022-06-01 02:36:44,972 - mmseg - INFO - Iter [5700/20000]\tlr: 4.290e-05, eta: 2:56:53, time: 0.404, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0364, decode.loss_lovasz: 0.2345, decode.acc_seg: 92.2906, loss: 0.2709\n","2022-06-01 02:37:25,352 - mmseg - INFO - Iter [5800/20000]\tlr: 4.260e-05, eta: 2:54:15, time: 0.404, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0364, decode.loss_lovasz: 0.2318, decode.acc_seg: 92.4833, loss: 0.2682\n","2022-06-01 02:38:06,153 - mmseg - INFO - Iter [5900/20000]\tlr: 4.230e-05, eta: 2:51:43, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0394, decode.loss_lovasz: 0.2521, decode.acc_seg: 91.0803, loss: 0.2916\n","2022-06-01 02:38:48,867 - mmseg - INFO - Saving checkpoint at 6000 iterations\n","2022-06-01 02:39:07,305 - mmseg - INFO - Iter [6000/20000]\tlr: 4.200e-05, eta: 2:50:02, time: 0.612, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0356, decode.loss_lovasz: 0.2348, decode.acc_seg: 92.5488, loss: 0.2704\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 254s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 02:43:21,523 - mmseg - INFO - per class results:\n","2022-06-01 02:43:21,525 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.96 |  96.9 |\n","|    road    | 64.21 | 73.88 |\n","+------------+-------+-------+\n","2022-06-01 02:43:21,526 - mmseg - INFO - Summary:\n","2022-06-01 02:43:21,528 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.97 | 78.08 | 85.39 |\n","+-------+-------+-------+\n","2022-06-01 02:43:21,533 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9297, mIoU: 0.7808, mAcc: 0.8539, IoU.background: 0.9196, IoU.road: 0.6421, Acc.background: 0.9690, Acc.road: 0.7388\n","2022-06-01 02:44:02,649 - mmseg - INFO - Iter [6100/20000]\tlr: 4.170e-05, eta: 2:57:17, time: 2.953, data_time: 2.549, memory: 3323, decode.loss_focal: 0.0338, decode.loss_lovasz: 0.2391, decode.acc_seg: 92.5995, loss: 0.2728\n","2022-06-01 02:44:43,479 - mmseg - INFO - Iter [6200/20000]\tlr: 4.140e-05, eta: 2:54:41, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0368, decode.loss_lovasz: 0.2311, decode.acc_seg: 92.1047, loss: 0.2679\n","2022-06-01 02:45:24,569 - mmseg - INFO - Iter [6300/20000]\tlr: 4.110e-05, eta: 2:52:09, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0355, decode.loss_lovasz: 0.2328, decode.acc_seg: 92.3216, loss: 0.2683\n","2022-06-01 02:46:05,483 - mmseg - INFO - Iter [6400/20000]\tlr: 4.080e-05, eta: 2:49:40, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0314, decode.loss_lovasz: 0.2236, decode.acc_seg: 93.2286, loss: 0.2550\n","2022-06-01 02:46:46,647 - mmseg - INFO - Iter [6500/20000]\tlr: 4.050e-05, eta: 2:47:15, time: 0.412, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0370, decode.loss_lovasz: 0.2362, decode.acc_seg: 91.9021, loss: 0.2732\n","2022-06-01 02:47:29,590 - mmseg - INFO - Iter [6600/20000]\tlr: 4.020e-05, eta: 2:44:57, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0351, decode.loss_lovasz: 0.2207, decode.acc_seg: 92.5695, loss: 0.2558\n","2022-06-01 02:48:10,368 - mmseg - INFO - Iter [6700/20000]\tlr: 3.990e-05, eta: 2:42:38, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0362, decode.loss_lovasz: 0.2337, decode.acc_seg: 91.8085, loss: 0.2699\n","2022-06-01 02:48:51,192 - mmseg - INFO - Iter [6800/20000]\tlr: 3.960e-05, eta: 2:40:21, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0370, decode.loss_lovasz: 0.2369, decode.acc_seg: 92.1122, loss: 0.2740\n","2022-06-01 02:49:32,013 - mmseg - INFO - Iter [6900/20000]\tlr: 3.930e-05, eta: 2:38:07, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0298, decode.loss_lovasz: 0.2217, decode.acc_seg: 93.1210, loss: 0.2515\n","2022-06-01 02:50:13,003 - mmseg - INFO - Saving checkpoint at 7000 iterations\n","2022-06-01 02:50:31,237 - mmseg - INFO - Iter [7000/20000]\tlr: 3.900e-05, eta: 2:36:30, time: 0.592, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0373, decode.loss_lovasz: 0.2384, decode.acc_seg: 92.0541, loss: 0.2757\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 02:54:44,161 - mmseg - INFO - per class results:\n","2022-06-01 02:54:44,162 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.83 | 96.35 |\n","|    road    |  64.6 | 76.04 |\n","+------------+-------+-------+\n","2022-06-01 02:54:44,163 - mmseg - INFO - Summary:\n","2022-06-01 02:54:44,169 - mmseg - INFO - \n","+-------+-------+------+\n","|  aAcc |  mIoU | mAcc |\n","+-------+-------+------+\n","| 92.89 | 78.21 | 86.2 |\n","+-------+-------+------+\n","2022-06-01 02:54:44,171 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9289, mIoU: 0.7821, mAcc: 0.8620, IoU.background: 0.9183, IoU.road: 0.6460, Acc.background: 0.9635, Acc.road: 0.7604\n","2022-06-01 02:55:27,435 - mmseg - INFO - Iter [7100/20000]\tlr: 3.870e-05, eta: 2:42:05, time: 2.962, data_time: 2.557, memory: 3323, decode.loss_focal: 0.0345, decode.loss_lovasz: 0.2167, decode.acc_seg: 92.8513, loss: 0.2512\n","2022-06-01 02:56:08,438 - mmseg - INFO - Iter [7200/20000]\tlr: 3.840e-05, eta: 2:39:49, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0321, decode.loss_lovasz: 0.2201, decode.acc_seg: 92.9927, loss: 0.2522\n","2022-06-01 02:56:49,421 - mmseg - INFO - Iter [7300/20000]\tlr: 3.810e-05, eta: 2:37:35, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0359, decode.loss_lovasz: 0.2276, decode.acc_seg: 92.1737, loss: 0.2636\n","2022-06-01 02:57:30,446 - mmseg - INFO - Iter [7400/20000]\tlr: 3.780e-05, eta: 2:35:23, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0354, decode.loss_lovasz: 0.2270, decode.acc_seg: 92.2895, loss: 0.2624\n","2022-06-01 02:58:11,437 - mmseg - INFO - Iter [7500/20000]\tlr: 3.750e-05, eta: 2:33:14, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0351, decode.loss_lovasz: 0.2326, decode.acc_seg: 92.4994, loss: 0.2677\n","2022-06-01 02:58:54,491 - mmseg - INFO - Iter [7600/20000]\tlr: 3.720e-05, eta: 2:31:11, time: 0.431, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0349, decode.loss_lovasz: 0.2271, decode.acc_seg: 92.7157, loss: 0.2620\n","2022-06-01 02:59:35,472 - mmseg - INFO - Iter [7700/20000]\tlr: 3.690e-05, eta: 2:29:06, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0319, decode.loss_lovasz: 0.2185, decode.acc_seg: 92.8725, loss: 0.2504\n","2022-06-01 03:00:16,551 - mmseg - INFO - Iter [7800/20000]\tlr: 3.660e-05, eta: 2:27:04, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0361, decode.loss_lovasz: 0.2370, decode.acc_seg: 92.4130, loss: 0.2731\n","2022-06-01 03:00:57,581 - mmseg - INFO - Iter [7900/20000]\tlr: 3.630e-05, eta: 2:25:04, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0335, decode.loss_lovasz: 0.2304, decode.acc_seg: 92.7719, loss: 0.2639\n","2022-06-01 03:01:38,659 - mmseg - INFO - Saving checkpoint at 8000 iterations\n","2022-06-01 03:01:57,769 - mmseg - INFO - Iter [8000/20000]\tlr: 3.600e-05, eta: 2:23:34, time: 0.602, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0353, decode.loss_lovasz: 0.2342, decode.acc_seg: 92.2941, loss: 0.2695\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 03:06:10,615 - mmseg - INFO - per class results:\n","2022-06-01 03:06:10,617 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.7 | 96.29 |\n","|    road    | 64.13 | 75.71 |\n","+------------+-------+-------+\n","2022-06-01 03:06:10,618 - mmseg - INFO - Summary:\n","2022-06-01 03:06:10,620 - mmseg - INFO - \n","+-------+-------+------+\n","|  aAcc |  mIoU | mAcc |\n","+-------+-------+------+\n","| 92.77 | 77.92 | 86.0 |\n","+-------+-------+------+\n","2022-06-01 03:06:10,624 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9277, mIoU: 0.7792, mAcc: 0.8600, IoU.background: 0.9170, IoU.road: 0.6413, Acc.background: 0.9629, Acc.road: 0.7571\n","2022-06-01 03:06:51,538 - mmseg - INFO - Iter [8100/20000]\tlr: 3.570e-05, eta: 2:27:49, time: 2.938, data_time: 2.535, memory: 3323, decode.loss_focal: 0.0332, decode.loss_lovasz: 0.2294, decode.acc_seg: 92.7596, loss: 0.2626\n","2022-06-01 03:07:34,352 - mmseg - INFO - Iter [8200/20000]\tlr: 3.540e-05, eta: 2:25:48, time: 0.428, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0331, decode.loss_lovasz: 0.2138, decode.acc_seg: 93.1092, loss: 0.2469\n","2022-06-01 03:08:15,241 - mmseg - INFO - Iter [8300/20000]\tlr: 3.510e-05, eta: 2:23:47, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0347, decode.loss_lovasz: 0.2210, decode.acc_seg: 92.8674, loss: 0.2557\n","2022-06-01 03:08:56,430 - mmseg - INFO - Iter [8400/20000]\tlr: 3.480e-05, eta: 2:21:49, time: 0.412, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0316, decode.loss_lovasz: 0.2213, decode.acc_seg: 92.9914, loss: 0.2529\n","2022-06-01 03:09:37,369 - mmseg - INFO - Iter [8500/20000]\tlr: 3.450e-05, eta: 2:19:51, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0333, decode.loss_lovasz: 0.2183, decode.acc_seg: 92.9229, loss: 0.2516\n","2022-06-01 03:10:18,307 - mmseg - INFO - Iter [8600/20000]\tlr: 3.420e-05, eta: 2:17:56, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0351, decode.loss_lovasz: 0.2261, decode.acc_seg: 92.4970, loss: 0.2613\n","2022-06-01 03:11:01,402 - mmseg - INFO - Iter [8700/20000]\tlr: 3.390e-05, eta: 2:16:05, time: 0.431, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2224, decode.acc_seg: 92.8131, loss: 0.2550\n","2022-06-01 03:11:42,259 - mmseg - INFO - Iter [8800/20000]\tlr: 3.360e-05, eta: 2:14:13, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0308, decode.loss_lovasz: 0.2165, decode.acc_seg: 93.4365, loss: 0.2472\n","2022-06-01 03:12:23,254 - mmseg - INFO - Iter [8900/20000]\tlr: 3.330e-05, eta: 2:12:22, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0338, decode.loss_lovasz: 0.2176, decode.acc_seg: 92.7537, loss: 0.2514\n","2022-06-01 03:13:04,208 - mmseg - INFO - Saving checkpoint at 9000 iterations\n","2022-06-01 03:13:24,538 - mmseg - INFO - Iter [9000/20000]\tlr: 3.300e-05, eta: 2:10:58, time: 0.613, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2087, decode.acc_seg: 93.1530, loss: 0.2413\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 254s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 03:17:38,887 - mmseg - INFO - per class results:\n","2022-06-01 03:17:38,889 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.07 | 96.69 |\n","|    road    | 65.15 | 75.64 |\n","+------------+-------+-------+\n","2022-06-01 03:17:38,891 - mmseg - INFO - Summary:\n","2022-06-01 03:17:38,892 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.09 | 78.61 | 86.16 |\n","+-------+-------+-------+\n","2022-06-01 03:17:38,894 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9309, mIoU: 0.7861, mAcc: 0.8616, IoU.background: 0.9207, IoU.road: 0.6515, Acc.background: 0.9669, Acc.road: 0.7564\n","2022-06-01 03:18:19,934 - mmseg - INFO - Iter [9100/20000]\tlr: 3.270e-05, eta: 2:14:15, time: 2.954, data_time: 2.551, memory: 3323, decode.loss_focal: 0.0362, decode.loss_lovasz: 0.2256, decode.acc_seg: 92.1785, loss: 0.2618\n","2022-06-01 03:19:00,945 - mmseg - INFO - Iter [9200/20000]\tlr: 3.240e-05, eta: 2:12:23, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0338, decode.loss_lovasz: 0.2148, decode.acc_seg: 92.9119, loss: 0.2485\n","2022-06-01 03:19:43,923 - mmseg - INFO - Iter [9300/20000]\tlr: 3.210e-05, eta: 2:10:34, time: 0.430, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0338, decode.loss_lovasz: 0.2247, decode.acc_seg: 92.8813, loss: 0.2585\n","2022-06-01 03:20:24,858 - mmseg - INFO - Iter [9400/20000]\tlr: 3.180e-05, eta: 2:08:44, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0342, decode.loss_lovasz: 0.2202, decode.acc_seg: 92.6963, loss: 0.2545\n","2022-06-01 03:21:05,658 - mmseg - INFO - Iter [9500/20000]\tlr: 3.150e-05, eta: 2:06:56, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0335, decode.loss_lovasz: 0.2175, decode.acc_seg: 92.5718, loss: 0.2510\n","2022-06-01 03:21:46,608 - mmseg - INFO - Iter [9600/20000]\tlr: 3.120e-05, eta: 2:05:09, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0322, decode.loss_lovasz: 0.2103, decode.acc_seg: 92.9297, loss: 0.2424\n","2022-06-01 03:22:27,578 - mmseg - INFO - Iter [9700/20000]\tlr: 3.090e-05, eta: 2:03:24, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0335, decode.loss_lovasz: 0.2199, decode.acc_seg: 92.7633, loss: 0.2534\n","2022-06-01 03:23:10,508 - mmseg - INFO - Iter [9800/20000]\tlr: 3.060e-05, eta: 2:01:42, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0287, decode.loss_lovasz: 0.2003, decode.acc_seg: 93.5518, loss: 0.2291\n","2022-06-01 03:23:51,439 - mmseg - INFO - Iter [9900/20000]\tlr: 3.030e-05, eta: 1:59:59, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0336, decode.loss_lovasz: 0.2115, decode.acc_seg: 92.9730, loss: 0.2451\n","2022-06-01 03:24:32,468 - mmseg - INFO - Saving checkpoint at 10000 iterations\n","2022-06-01 03:24:52,856 - mmseg - INFO - Iter [10000/20000]\tlr: 3.000e-05, eta: 1:58:38, time: 0.614, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2113, decode.acc_seg: 93.0417, loss: 0.2439\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 03:29:07,477 - mmseg - INFO - per class results:\n","2022-06-01 03:29:07,479 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.84 | 95.97 |\n","|    road    | 65.37 | 78.18 |\n","+------------+-------+-------+\n","2022-06-01 03:29:07,481 - mmseg - INFO - Summary:\n","2022-06-01 03:29:07,483 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.93 | 78.61 | 87.08 |\n","+-------+-------+-------+\n","2022-06-01 03:29:07,487 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9293, mIoU: 0.7861, mAcc: 0.8708, IoU.background: 0.9184, IoU.road: 0.6537, Acc.background: 0.9597, Acc.road: 0.7818\n","2022-06-01 03:29:48,416 - mmseg - INFO - Iter [10100/20000]\tlr: 2.970e-05, eta: 2:01:06, time: 2.956, data_time: 2.553, memory: 3323, decode.loss_focal: 0.0343, decode.loss_lovasz: 0.2134, decode.acc_seg: 92.8064, loss: 0.2477\n","2022-06-01 03:30:29,298 - mmseg - INFO - Iter [10200/20000]\tlr: 2.940e-05, eta: 1:59:22, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0319, decode.loss_lovasz: 0.2115, decode.acc_seg: 93.1637, loss: 0.2433\n","2022-06-01 03:31:12,531 - mmseg - INFO - Iter [10300/20000]\tlr: 2.910e-05, eta: 1:57:41, time: 0.432, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0317, decode.loss_lovasz: 0.2116, decode.acc_seg: 93.4206, loss: 0.2433\n","2022-06-01 03:31:53,619 - mmseg - INFO - Iter [10400/20000]\tlr: 2.880e-05, eta: 1:55:59, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2135, decode.acc_seg: 92.9551, loss: 0.2461\n","2022-06-01 03:32:34,396 - mmseg - INFO - Iter [10500/20000]\tlr: 2.850e-05, eta: 1:54:17, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0315, decode.loss_lovasz: 0.2114, decode.acc_seg: 93.3665, loss: 0.2429\n","2022-06-01 03:33:15,413 - mmseg - INFO - Iter [10600/20000]\tlr: 2.820e-05, eta: 1:52:38, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0313, decode.loss_lovasz: 0.2118, decode.acc_seg: 92.8817, loss: 0.2431\n","2022-06-01 03:33:56,219 - mmseg - INFO - Iter [10700/20000]\tlr: 2.790e-05, eta: 1:50:59, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0341, decode.loss_lovasz: 0.2144, decode.acc_seg: 93.0195, loss: 0.2484\n","2022-06-01 03:34:37,174 - mmseg - INFO - Iter [10800/20000]\tlr: 2.760e-05, eta: 1:49:21, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0311, decode.loss_lovasz: 0.2086, decode.acc_seg: 93.1686, loss: 0.2397\n","2022-06-01 03:35:20,073 - mmseg - INFO - Iter [10900/20000]\tlr: 2.730e-05, eta: 1:47:46, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0322, decode.loss_lovasz: 0.2066, decode.acc_seg: 93.3227, loss: 0.2388\n","2022-06-01 03:36:01,115 - mmseg - INFO - Saving checkpoint at 11000 iterations\n","2022-06-01 03:36:23,425 - mmseg - INFO - Iter [11000/20000]\tlr: 2.700e-05, eta: 1:46:28, time: 0.634, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0292, decode.loss_lovasz: 0.2021, decode.acc_seg: 93.9314, loss: 0.2312\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 03:40:38,113 - mmseg - INFO - per class results:\n","2022-06-01 03:40:38,115 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.93 | 95.78 |\n","|    road    | 66.09 | 79.63 |\n","+------------+-------+-------+\n","2022-06-01 03:40:38,117 - mmseg - INFO - Summary:\n","2022-06-01 03:40:38,119 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.03 | 79.01 | 87.71 |\n","+-------+-------+-------+\n","2022-06-01 03:40:38,121 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9303, mIoU: 0.7901, mAcc: 0.8771, IoU.background: 0.9193, IoU.road: 0.6609, Acc.background: 0.9578, Acc.road: 0.7963\n","2022-06-01 03:41:19,480 - mmseg - INFO - Iter [11100/20000]\tlr: 2.670e-05, eta: 1:48:18, time: 2.961, data_time: 2.554, memory: 3323, decode.loss_focal: 0.0313, decode.loss_lovasz: 0.2018, decode.acc_seg: 93.3438, loss: 0.2331\n","2022-06-01 03:42:00,950 - mmseg - INFO - Iter [11200/20000]\tlr: 2.640e-05, eta: 1:46:40, time: 0.415, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0303, decode.loss_lovasz: 0.2004, decode.acc_seg: 93.5540, loss: 0.2307\n","2022-06-01 03:42:42,195 - mmseg - INFO - Iter [11300/20000]\tlr: 2.610e-05, eta: 1:45:03, time: 0.412, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0339, decode.loss_lovasz: 0.2139, decode.acc_seg: 92.8078, loss: 0.2478\n","2022-06-01 03:43:25,369 - mmseg - INFO - Iter [11400/20000]\tlr: 2.580e-05, eta: 1:43:29, time: 0.432, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0318, decode.loss_lovasz: 0.2142, decode.acc_seg: 93.0493, loss: 0.2460\n","2022-06-01 03:44:06,471 - mmseg - INFO - Iter [11500/20000]\tlr: 2.550e-05, eta: 1:41:53, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0349, decode.loss_lovasz: 0.2149, decode.acc_seg: 92.6245, loss: 0.2498\n","2022-06-01 03:44:47,759 - mmseg - INFO - Iter [11600/20000]\tlr: 2.520e-05, eta: 1:40:19, time: 0.413, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2061, decode.acc_seg: 93.1366, loss: 0.2387\n","2022-06-01 03:45:28,858 - mmseg - INFO - Iter [11700/20000]\tlr: 2.490e-05, eta: 1:38:46, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0329, decode.loss_lovasz: 0.2075, decode.acc_seg: 93.1240, loss: 0.2404\n","2022-06-01 03:46:09,867 - mmseg - INFO - Iter [11800/20000]\tlr: 2.460e-05, eta: 1:37:13, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0315, decode.loss_lovasz: 0.2184, decode.acc_seg: 93.1761, loss: 0.2499\n","2022-06-01 03:46:50,974 - mmseg - INFO - Iter [11900/20000]\tlr: 2.430e-05, eta: 1:35:42, time: 0.411, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0294, decode.loss_lovasz: 0.2034, decode.acc_seg: 93.7486, loss: 0.2328\n","2022-06-01 03:47:34,099 - mmseg - INFO - Saving checkpoint at 12000 iterations\n","2022-06-01 03:47:55,775 - mmseg - INFO - Iter [12000/20000]\tlr: 2.400e-05, eta: 1:34:27, time: 0.648, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0315, decode.loss_lovasz: 0.2116, decode.acc_seg: 93.3351, loss: 0.2431\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 03:52:08,636 - mmseg - INFO - per class results:\n","2022-06-01 03:52:08,638 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.95 | 96.25 |\n","|    road    | 65.37 | 77.28 |\n","+------------+-------+-------+\n","2022-06-01 03:52:08,639 - mmseg - INFO - Summary:\n","2022-06-01 03:52:08,641 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.01 | 78.66 | 86.76 |\n","+-------+-------+-------+\n","2022-06-01 03:52:08,643 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9301, mIoU: 0.7866, mAcc: 0.8676, IoU.background: 0.9195, IoU.road: 0.6537, Acc.background: 0.9625, Acc.road: 0.7728\n","2022-06-01 03:52:49,534 - mmseg - INFO - Iter [12100/20000]\tlr: 2.370e-05, eta: 1:35:42, time: 2.938, data_time: 2.536, memory: 3323, decode.loss_focal: 0.0316, decode.loss_lovasz: 0.2069, decode.acc_seg: 93.2356, loss: 0.2385\n","2022-06-01 03:53:30,469 - mmseg - INFO - Iter [12200/20000]\tlr: 2.340e-05, eta: 1:34:09, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0326, decode.loss_lovasz: 0.2050, decode.acc_seg: 93.2354, loss: 0.2376\n","2022-06-01 03:54:11,410 - mmseg - INFO - Iter [12300/20000]\tlr: 2.310e-05, eta: 1:32:36, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0354, decode.loss_lovasz: 0.2114, decode.acc_seg: 92.5834, loss: 0.2469\n","2022-06-01 03:54:52,191 - mmseg - INFO - Iter [12400/20000]\tlr: 2.280e-05, eta: 1:31:05, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0282, decode.loss_lovasz: 0.1913, decode.acc_seg: 93.9398, loss: 0.2195\n","2022-06-01 03:55:34,901 - mmseg - INFO - Iter [12500/20000]\tlr: 2.250e-05, eta: 1:29:36, time: 0.427, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0299, decode.loss_lovasz: 0.1999, decode.acc_seg: 93.8305, loss: 0.2297\n","2022-06-01 03:56:15,656 - mmseg - INFO - Iter [12600/20000]\tlr: 2.220e-05, eta: 1:28:06, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0308, decode.loss_lovasz: 0.2033, decode.acc_seg: 93.3844, loss: 0.2341\n","2022-06-01 03:56:56,369 - mmseg - INFO - Iter [12700/20000]\tlr: 2.190e-05, eta: 1:26:37, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0317, decode.loss_lovasz: 0.2032, decode.acc_seg: 93.2430, loss: 0.2349\n","2022-06-01 03:57:37,253 - mmseg - INFO - Iter [12800/20000]\tlr: 2.160e-05, eta: 1:25:08, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0306, decode.loss_lovasz: 0.2004, decode.acc_seg: 93.7740, loss: 0.2310\n","2022-06-01 03:58:18,235 - mmseg - INFO - Iter [12900/20000]\tlr: 2.130e-05, eta: 1:23:41, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0325, decode.loss_lovasz: 0.2052, decode.acc_seg: 93.1620, loss: 0.2377\n","2022-06-01 03:58:58,873 - mmseg - INFO - Saving checkpoint at 13000 iterations\n","2022-06-01 03:59:18,283 - mmseg - INFO - Iter [13000/20000]\tlr: 2.100e-05, eta: 1:22:25, time: 0.600, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0295, decode.loss_lovasz: 0.1854, decode.acc_seg: 94.0802, loss: 0.2149\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 04:03:33,021 - mmseg - INFO - per class results:\n","2022-06-01 04:03:33,023 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.13 | 96.42 |\n","|    road    | 65.91 | 77.36 |\n","+------------+-------+-------+\n","2022-06-01 04:03:33,024 - mmseg - INFO - Summary:\n","2022-06-01 04:03:33,026 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.17 | 79.02 | 86.89 |\n","+-------+-------+-------+\n","2022-06-01 04:03:33,028 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9317, mIoU: 0.7902, mAcc: 0.8689, IoU.background: 0.9213, IoU.road: 0.6591, Acc.background: 0.9642, Acc.road: 0.7736\n","2022-06-01 04:04:15,773 - mmseg - INFO - Iter [13100/20000]\tlr: 2.070e-05, eta: 1:23:13, time: 2.975, data_time: 2.575, memory: 3323, decode.loss_focal: 0.0300, decode.loss_lovasz: 0.1948, decode.acc_seg: 93.6631, loss: 0.2248\n","2022-06-01 04:04:56,386 - mmseg - INFO - Iter [13200/20000]\tlr: 2.040e-05, eta: 1:21:45, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0306, decode.loss_lovasz: 0.2001, decode.acc_seg: 93.4456, loss: 0.2308\n","2022-06-01 04:05:37,182 - mmseg - INFO - Iter [13300/20000]\tlr: 2.010e-05, eta: 1:20:17, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0305, decode.loss_lovasz: 0.2024, decode.acc_seg: 93.6493, loss: 0.2329\n","2022-06-01 04:06:17,788 - mmseg - INFO - Iter [13400/20000]\tlr: 1.980e-05, eta: 1:18:49, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0299, decode.loss_lovasz: 0.2050, decode.acc_seg: 93.5510, loss: 0.2349\n","2022-06-01 04:06:58,292 - mmseg - INFO - Iter [13500/20000]\tlr: 1.950e-05, eta: 1:17:23, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0314, decode.loss_lovasz: 0.2138, decode.acc_seg: 93.1759, loss: 0.2452\n","2022-06-01 04:07:41,109 - mmseg - INFO - Iter [13600/20000]\tlr: 1.920e-05, eta: 1:15:58, time: 0.428, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0297, decode.loss_lovasz: 0.1941, decode.acc_seg: 93.7136, loss: 0.2237\n","2022-06-01 04:08:21,654 - mmseg - INFO - Iter [13700/20000]\tlr: 1.890e-05, eta: 1:14:32, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0310, decode.loss_lovasz: 0.1979, decode.acc_seg: 93.7592, loss: 0.2289\n","2022-06-01 04:09:02,144 - mmseg - INFO - Iter [13800/20000]\tlr: 1.860e-05, eta: 1:13:08, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0308, decode.loss_lovasz: 0.2032, decode.acc_seg: 93.3616, loss: 0.2339\n","2022-06-01 04:09:42,653 - mmseg - INFO - Iter [13900/20000]\tlr: 1.830e-05, eta: 1:11:44, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0307, decode.loss_lovasz: 0.2069, decode.acc_seg: 93.3890, loss: 0.2376\n","2022-06-01 04:10:23,273 - mmseg - INFO - Saving checkpoint at 14000 iterations\n","2022-06-01 04:10:43,102 - mmseg - INFO - Iter [14000/20000]\tlr: 1.800e-05, eta: 1:10:29, time: 0.604, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0293, decode.loss_lovasz: 0.1957, decode.acc_seg: 93.7058, loss: 0.2250\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 04:14:55,735 - mmseg - INFO - per class results:\n","2022-06-01 04:14:55,737 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.8 | 95.71 |\n","|    road    | 65.62 |  79.3 |\n","+------------+-------+-------+\n","2022-06-01 04:14:55,739 - mmseg - INFO - Summary:\n","2022-06-01 04:14:55,742 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.91 | 78.71 | 87.51 |\n","+-------+-------+-------+\n","2022-06-01 04:14:55,745 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9291, mIoU: 0.7871, mAcc: 0.8751, IoU.background: 0.9180, IoU.road: 0.6562, Acc.background: 0.9571, Acc.road: 0.7930\n","2022-06-01 04:15:38,358 - mmseg - INFO - Iter [14100/20000]\tlr: 1.770e-05, eta: 1:10:52, time: 2.953, data_time: 2.554, memory: 3323, decode.loss_focal: 0.0303, decode.loss_lovasz: 0.1927, decode.acc_seg: 94.1305, loss: 0.2230\n","2022-06-01 04:16:18,979 - mmseg - INFO - Iter [14200/20000]\tlr: 1.740e-05, eta: 1:09:27, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0298, decode.loss_lovasz: 0.1979, decode.acc_seg: 93.7241, loss: 0.2277\n","2022-06-01 04:16:59,923 - mmseg - INFO - Iter [14300/20000]\tlr: 1.710e-05, eta: 1:08:03, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0288, decode.loss_lovasz: 0.1877, decode.acc_seg: 93.9295, loss: 0.2166\n","2022-06-01 04:17:40,442 - mmseg - INFO - Iter [14400/20000]\tlr: 1.680e-05, eta: 1:06:40, time: 0.405, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0295, decode.loss_lovasz: 0.1992, decode.acc_seg: 93.6216, loss: 0.2287\n","2022-06-01 04:18:21,208 - mmseg - INFO - Iter [14500/20000]\tlr: 1.650e-05, eta: 1:05:16, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0280, decode.loss_lovasz: 0.1941, decode.acc_seg: 94.1118, loss: 0.2221\n","2022-06-01 04:19:01,919 - mmseg - INFO - Iter [14600/20000]\tlr: 1.620e-05, eta: 1:03:54, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0304, decode.loss_lovasz: 0.2007, decode.acc_seg: 93.4370, loss: 0.2311\n","2022-06-01 04:19:44,661 - mmseg - INFO - Iter [14700/20000]\tlr: 1.590e-05, eta: 1:02:33, time: 0.427, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0316, decode.loss_lovasz: 0.2119, decode.acc_seg: 93.1545, loss: 0.2435\n","2022-06-01 04:20:25,291 - mmseg - INFO - Iter [14800/20000]\tlr: 1.560e-05, eta: 1:01:11, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0312, decode.loss_lovasz: 0.2100, decode.acc_seg: 93.1614, loss: 0.2412\n","2022-06-01 04:21:06,107 - mmseg - INFO - Iter [14900/20000]\tlr: 1.530e-05, eta: 0:59:51, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0290, decode.loss_lovasz: 0.1798, decode.acc_seg: 94.0586, loss: 0.2087\n","2022-06-01 04:21:46,817 - mmseg - INFO - Saving checkpoint at 15000 iterations\n","2022-06-01 04:22:06,715 - mmseg - INFO - Iter [15000/20000]\tlr: 1.500e-05, eta: 0:58:37, time: 0.606, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0283, decode.loss_lovasz: 0.1933, decode.acc_seg: 93.8748, loss: 0.2216\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 04:26:19,585 - mmseg - INFO - per class results:\n","2022-06-01 04:26:19,589 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.13 | 96.38 |\n","|    road    | 65.98 | 77.58 |\n","+------------+-------+-------+\n","2022-06-01 04:26:19,591 - mmseg - INFO - Summary:\n","2022-06-01 04:26:19,594 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.17 | 79.06 | 86.98 |\n","+-------+-------+-------+\n","2022-06-01 04:26:19,597 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9317, mIoU: 0.7906, mAcc: 0.8698, IoU.background: 0.9213, IoU.road: 0.6598, Acc.background: 0.9638, Acc.road: 0.7758\n","2022-06-01 04:27:00,345 - mmseg - INFO - Iter [15100/20000]\tlr: 1.470e-05, eta: 0:58:39, time: 2.936, data_time: 2.536, memory: 3323, decode.loss_focal: 0.0312, decode.loss_lovasz: 0.2056, decode.acc_seg: 93.3924, loss: 0.2368\n","2022-06-01 04:27:43,026 - mmseg - INFO - Iter [15200/20000]\tlr: 1.440e-05, eta: 0:57:18, time: 0.427, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0275, decode.loss_lovasz: 0.1880, decode.acc_seg: 94.3698, loss: 0.2155\n","2022-06-01 04:28:23,706 - mmseg - INFO - Iter [15300/20000]\tlr: 1.410e-05, eta: 0:55:57, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0281, decode.loss_lovasz: 0.1865, decode.acc_seg: 94.1760, loss: 0.2145\n","2022-06-01 04:29:04,456 - mmseg - INFO - Iter [15400/20000]\tlr: 1.380e-05, eta: 0:54:36, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0282, decode.loss_lovasz: 0.1903, decode.acc_seg: 93.9473, loss: 0.2185\n","2022-06-01 04:29:44,522 - mmseg - INFO - Iter [15500/20000]\tlr: 1.350e-05, eta: 0:53:16, time: 0.401, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0276, decode.loss_lovasz: 0.1862, decode.acc_seg: 94.0212, loss: 0.2137\n","2022-06-01 04:30:24,440 - mmseg - INFO - Iter [15600/20000]\tlr: 1.320e-05, eta: 0:51:56, time: 0.399, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0302, decode.loss_lovasz: 0.2037, decode.acc_seg: 93.5412, loss: 0.2339\n","2022-06-01 04:31:04,441 - mmseg - INFO - Iter [15700/20000]\tlr: 1.290e-05, eta: 0:50:37, time: 0.400, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0297, decode.loss_lovasz: 0.1885, decode.acc_seg: 93.8782, loss: 0.2183\n","2022-06-01 04:31:47,363 - mmseg - INFO - Iter [15800/20000]\tlr: 1.260e-05, eta: 0:49:19, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0268, decode.loss_lovasz: 0.1847, decode.acc_seg: 94.3930, loss: 0.2114\n","2022-06-01 04:32:27,914 - mmseg - INFO - Iter [15900/20000]\tlr: 1.230e-05, eta: 0:48:01, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0301, decode.loss_lovasz: 0.2027, decode.acc_seg: 93.5414, loss: 0.2328\n","2022-06-01 04:33:08,445 - mmseg - INFO - Saving checkpoint at 16000 iterations\n","2022-06-01 04:33:27,287 - mmseg - INFO - Iter [16000/20000]\tlr: 1.200e-05, eta: 0:46:48, time: 0.594, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0314, decode.loss_lovasz: 0.2131, decode.acc_seg: 93.0441, loss: 0.2445\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 04:37:42,143 - mmseg - INFO - per class results:\n","2022-06-01 04:37:42,145 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.11 | 96.21 |\n","|    road    | 66.19 | 78.37 |\n","+------------+-------+-------+\n","2022-06-01 04:37:42,146 - mmseg - INFO - Summary:\n","2022-06-01 04:37:42,149 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.17 | 79.15 | 87.29 |\n","+-------+-------+-------+\n","2022-06-01 04:37:42,152 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9317, mIoU: 0.7915, mAcc: 0.8729, IoU.background: 0.9211, IoU.road: 0.6619, Acc.background: 0.9621, Acc.road: 0.7837\n","2022-06-01 04:38:23,053 - mmseg - INFO - Iter [16100/20000]\tlr: 1.170e-05, eta: 0:46:32, time: 2.958, data_time: 2.555, memory: 3323, decode.loss_focal: 0.0288, decode.loss_lovasz: 0.1853, decode.acc_seg: 94.0290, loss: 0.2141\n","2022-06-01 04:39:03,741 - mmseg - INFO - Iter [16200/20000]\tlr: 1.140e-05, eta: 0:45:13, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0288, decode.loss_lovasz: 0.1932, decode.acc_seg: 93.8260, loss: 0.2220\n","2022-06-01 04:39:46,312 - mmseg - INFO - Iter [16300/20000]\tlr: 1.110e-05, eta: 0:43:55, time: 0.426, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0296, decode.loss_lovasz: 0.1997, decode.acc_seg: 93.5336, loss: 0.2293\n","2022-06-01 04:40:27,275 - mmseg - INFO - Iter [16400/20000]\tlr: 1.080e-05, eta: 0:42:37, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0287, decode.loss_lovasz: 0.1924, decode.acc_seg: 93.9396, loss: 0.2211\n","2022-06-01 04:41:07,884 - mmseg - INFO - Iter [16500/20000]\tlr: 1.050e-05, eta: 0:41:20, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0296, decode.loss_lovasz: 0.1909, decode.acc_seg: 93.7903, loss: 0.2205\n","2022-06-01 04:41:48,712 - mmseg - INFO - Iter [16600/20000]\tlr: 1.020e-05, eta: 0:40:03, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0272, decode.loss_lovasz: 0.1764, decode.acc_seg: 94.4514, loss: 0.2036\n","2022-06-01 04:42:29,646 - mmseg - INFO - Iter [16700/20000]\tlr: 9.903e-06, eta: 0:38:46, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0306, decode.loss_lovasz: 0.1898, decode.acc_seg: 93.7280, loss: 0.2204\n","2022-06-01 04:43:10,422 - mmseg - INFO - Iter [16800/20000]\tlr: 9.603e-06, eta: 0:37:30, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0296, decode.loss_lovasz: 0.1889, decode.acc_seg: 93.8141, loss: 0.2185\n","2022-06-01 04:43:53,274 - mmseg - INFO - Iter [16900/20000]\tlr: 9.303e-06, eta: 0:36:15, time: 0.429, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0311, decode.loss_lovasz: 0.2010, decode.acc_seg: 93.3862, loss: 0.2321\n","2022-06-01 04:44:34,172 - mmseg - INFO - Saving checkpoint at 17000 iterations\n","2022-06-01 04:44:56,573 - mmseg - INFO - Iter [17000/20000]\tlr: 9.003e-06, eta: 0:35:03, time: 0.633, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0303, decode.loss_lovasz: 0.1988, decode.acc_seg: 93.4602, loss: 0.2292\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 04:49:12,028 - mmseg - INFO - per class results:\n","2022-06-01 04:49:12,030 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.87 | 95.48 |\n","|    road    | 66.32 | 80.88 |\n","+------------+-------+-------+\n","2022-06-01 04:49:12,032 - mmseg - INFO - Summary:\n","2022-06-01 04:49:12,034 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.99 | 79.09 | 88.18 |\n","+-------+-------+-------+\n","2022-06-01 04:49:12,037 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9299, mIoU: 0.7909, mAcc: 0.8818, IoU.background: 0.9187, IoU.road: 0.6632, Acc.background: 0.9548, Acc.road: 0.8088\n","2022-06-01 04:49:53,023 - mmseg - INFO - Iter [17100/20000]\tlr: 8.703e-06, eta: 0:34:32, time: 2.964, data_time: 2.561, memory: 3323, decode.loss_focal: 0.0292, decode.loss_lovasz: 0.1918, decode.acc_seg: 94.0727, loss: 0.2210\n","2022-06-01 04:50:33,871 - mmseg - INFO - Iter [17200/20000]\tlr: 8.403e-06, eta: 0:33:15, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0269, decode.loss_lovasz: 0.1830, decode.acc_seg: 94.3682, loss: 0.2098\n","2022-06-01 04:51:14,680 - mmseg - INFO - Iter [17300/20000]\tlr: 8.103e-06, eta: 0:31:59, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0306, decode.loss_lovasz: 0.1872, decode.acc_seg: 93.8318, loss: 0.2178\n","2022-06-01 04:51:57,644 - mmseg - INFO - Iter [17400/20000]\tlr: 7.803e-06, eta: 0:30:44, time: 0.430, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0276, decode.loss_lovasz: 0.1924, decode.acc_seg: 94.0569, loss: 0.2200\n","2022-06-01 04:52:38,472 - mmseg - INFO - Iter [17500/20000]\tlr: 7.503e-06, eta: 0:29:29, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0293, decode.loss_lovasz: 0.1971, decode.acc_seg: 93.7270, loss: 0.2264\n","2022-06-01 04:53:19,103 - mmseg - INFO - Iter [17600/20000]\tlr: 7.203e-06, eta: 0:28:14, time: 0.406, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0265, decode.loss_lovasz: 0.1802, decode.acc_seg: 94.3314, loss: 0.2067\n","2022-06-01 04:53:59,917 - mmseg - INFO - Iter [17700/20000]\tlr: 6.903e-06, eta: 0:26:59, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0302, decode.loss_lovasz: 0.1846, decode.acc_seg: 94.0316, loss: 0.2149\n","2022-06-01 04:54:40,774 - mmseg - INFO - Iter [17800/20000]\tlr: 6.603e-06, eta: 0:25:45, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0284, decode.loss_lovasz: 0.1834, decode.acc_seg: 94.4515, loss: 0.2117\n","2022-06-01 04:55:23,415 - mmseg - INFO - Iter [17900/20000]\tlr: 6.303e-06, eta: 0:24:32, time: 0.426, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0281, decode.loss_lovasz: 0.1858, decode.acc_seg: 93.9228, loss: 0.2139\n","2022-06-01 04:56:04,211 - mmseg - INFO - Saving checkpoint at 18000 iterations\n","2022-06-01 04:56:25,702 - mmseg - INFO - Iter [18000/20000]\tlr: 6.003e-06, eta: 0:23:21, time: 0.623, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0274, decode.loss_lovasz: 0.1803, decode.acc_seg: 94.4950, loss: 0.2077\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 05:00:41,015 - mmseg - INFO - per class results:\n","2022-06-01 05:00:41,017 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.11 | 96.17 |\n","|    road    | 66.27 | 78.61 |\n","+------------+-------+-------+\n","2022-06-01 05:00:41,019 - mmseg - INFO - Summary:\n","2022-06-01 05:00:41,023 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.17 | 79.19 | 87.39 |\n","+-------+-------+-------+\n","2022-06-01 05:00:41,026 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9317, mIoU: 0.7919, mAcc: 0.8739, IoU.background: 0.9211, IoU.road: 0.6627, Acc.background: 0.9617, Acc.road: 0.7861\n","2022-06-01 05:01:21,868 - mmseg - INFO - Iter [18100/20000]\tlr: 5.703e-06, eta: 0:22:34, time: 2.962, data_time: 2.560, memory: 3323, decode.loss_focal: 0.0281, decode.loss_lovasz: 0.1983, decode.acc_seg: 93.8617, loss: 0.2265\n","2022-06-01 05:02:02,519 - mmseg - INFO - Iter [18200/20000]\tlr: 5.403e-06, eta: 0:21:20, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0298, decode.loss_lovasz: 0.1957, decode.acc_seg: 93.5059, loss: 0.2254\n","2022-06-01 05:02:43,303 - mmseg - INFO - Iter [18300/20000]\tlr: 5.103e-06, eta: 0:20:06, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0300, decode.loss_lovasz: 0.1962, decode.acc_seg: 93.6593, loss: 0.2262\n","2022-06-01 05:03:24,148 - mmseg - INFO - Iter [18400/20000]\tlr: 4.803e-06, eta: 0:18:52, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0265, decode.loss_lovasz: 0.1779, decode.acc_seg: 94.4721, loss: 0.2044\n","2022-06-01 05:04:07,098 - mmseg - INFO - Iter [18500/20000]\tlr: 4.503e-06, eta: 0:17:39, time: 0.429, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0281, decode.loss_lovasz: 0.1796, decode.acc_seg: 94.1170, loss: 0.2077\n","2022-06-01 05:04:47,900 - mmseg - INFO - Iter [18600/20000]\tlr: 4.203e-06, eta: 0:16:27, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0297, decode.loss_lovasz: 0.1884, decode.acc_seg: 93.7938, loss: 0.2182\n","2022-06-01 05:05:28,891 - mmseg - INFO - Iter [18700/20000]\tlr: 3.903e-06, eta: 0:15:14, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0301, decode.loss_lovasz: 0.1998, decode.acc_seg: 93.4244, loss: 0.2299\n","2022-06-01 05:06:09,669 - mmseg - INFO - Iter [18800/20000]\tlr: 3.603e-06, eta: 0:14:02, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0275, decode.loss_lovasz: 0.1873, decode.acc_seg: 94.4218, loss: 0.2148\n","2022-06-01 05:06:50,406 - mmseg - INFO - Iter [18900/20000]\tlr: 3.303e-06, eta: 0:12:50, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0258, decode.loss_lovasz: 0.1763, decode.acc_seg: 94.7137, loss: 0.2021\n","2022-06-01 05:07:32,847 - mmseg - INFO - Saving checkpoint at 19000 iterations\n","2022-06-01 05:07:52,531 - mmseg - INFO - Iter [19000/20000]\tlr: 3.003e-06, eta: 0:11:39, time: 0.621, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0266, decode.loss_lovasz: 0.1880, decode.acc_seg: 94.2333, loss: 0.2145\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 05:12:07,805 - mmseg - INFO - per class results:\n","2022-06-01 05:12:07,807 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.12 | 96.12 |\n","|    road    | 66.41 | 78.92 |\n","+------------+-------+-------+\n","2022-06-01 05:12:07,808 - mmseg - INFO - Summary:\n","2022-06-01 05:12:07,813 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.19 | 79.27 | 87.52 |\n","+-------+-------+-------+\n","2022-06-01 05:12:07,815 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9319, mIoU: 0.7927, mAcc: 0.8752, IoU.background: 0.9212, IoU.road: 0.6641, Acc.background: 0.9612, Acc.road: 0.7892\n","2022-06-01 05:12:48,507 - mmseg - INFO - Iter [19100/20000]\tlr: 2.703e-06, eta: 0:10:40, time: 2.960, data_time: 2.560, memory: 3323, decode.loss_focal: 0.0300, decode.loss_lovasz: 0.1821, decode.acc_seg: 94.1038, loss: 0.2121\n","2022-06-01 05:13:29,368 - mmseg - INFO - Iter [19200/20000]\tlr: 2.403e-06, eta: 0:09:28, time: 0.409, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0273, decode.loss_lovasz: 0.1826, decode.acc_seg: 94.2877, loss: 0.2099\n","2022-06-01 05:14:10,369 - mmseg - INFO - Iter [19300/20000]\tlr: 2.103e-06, eta: 0:08:16, time: 0.410, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0280, decode.loss_lovasz: 0.1844, decode.acc_seg: 94.1999, loss: 0.2125\n","2022-06-01 05:14:51,183 - mmseg - INFO - Iter [19400/20000]\tlr: 1.803e-06, eta: 0:07:04, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0286, decode.loss_lovasz: 0.1890, decode.acc_seg: 93.9782, loss: 0.2176\n","2022-06-01 05:15:31,981 - mmseg - INFO - Iter [19500/20000]\tlr: 1.503e-06, eta: 0:05:52, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0291, decode.loss_lovasz: 0.1973, decode.acc_seg: 93.7351, loss: 0.2263\n","2022-06-01 05:16:14,867 - mmseg - INFO - Iter [19600/20000]\tlr: 1.203e-06, eta: 0:04:41, time: 0.429, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0270, decode.loss_lovasz: 0.1807, decode.acc_seg: 94.2834, loss: 0.2077\n","2022-06-01 05:16:55,684 - mmseg - INFO - Iter [19700/20000]\tlr: 9.030e-07, eta: 0:03:30, time: 0.408, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0298, decode.loss_lovasz: 0.1963, decode.acc_seg: 93.9249, loss: 0.2261\n","2022-06-01 05:17:36,355 - mmseg - INFO - Iter [19800/20000]\tlr: 6.030e-07, eta: 0:02:20, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0264, decode.loss_lovasz: 0.1792, decode.acc_seg: 94.3639, loss: 0.2056\n","2022-06-01 05:18:17,065 - mmseg - INFO - Iter [19900/20000]\tlr: 3.030e-07, eta: 0:01:09, time: 0.407, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0279, decode.loss_lovasz: 0.1861, decode.acc_seg: 93.9552, loss: 0.2140\n","2022-06-01 05:18:57,887 - mmseg - INFO - Saving checkpoint at 20000 iterations\n","2022-06-01 05:19:14,440 - mmseg - INFO - Iter [20000/20000]\tlr: 3.000e-09, eta: 0:00:00, time: 0.574, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0286, decode.loss_lovasz: 0.1822, decode.acc_seg: 94.0667, loss: 0.2108\n"]},{"name":"stdout","output_type":"stream","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 255s, ETA:     0s"]},{"name":"stderr","output_type":"stream","text":["2022-06-01 05:23:29,929 - mmseg - INFO - per class results:\n","2022-06-01 05:23:29,931 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  92.1 | 96.06 |\n","|    road    | 66.39 |  79.1 |\n","+------------+-------+-------+\n","2022-06-01 05:23:29,934 - mmseg - INFO - Summary:\n","2022-06-01 05:23:29,936 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.17 | 79.24 | 87.58 |\n","+-------+-------+-------+\n","2022-06-01 05:23:29,940 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9317, mIoU: 0.7924, mAcc: 0.8758, IoU.background: 0.9210, IoU.road: 0.6639, Acc.background: 0.9606, Acc.road: 0.7910\n"]}],"source":["from mmseg.datasets import build_dataset\n","from mmseg.models import build_segmentor\n","from mmseg.apis import train_segmentor\n","\n","# Build the dataset\n","datasets = [build_dataset(cfg.data.train)]\n","\n","# Build the detector\n","model = build_segmentor(\n","    cfg.model, train_cfg=cfg.get('train_cfg'), test_cfg=cfg.get('test_cfg'))\n","\n","# Add an attribute for visualization convenience\n","model.CLASSES = datasets[0].CLASSES\n","\n","# Create work_dir\n","mmcv.mkdir_or_exist(osp.abspath(cfg.work_dir))\n","train_segmentor(model, datasets, cfg, distributed=False, validate=True,\n","                meta=dict(CLASSES=classes, PALETTE=palette))"]},{"cell_type":"markdown","metadata":{"id":"Pre69QNK_dwU"},"source":["### 모델 결과 시각화"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"18zk_30Go2cMI6eY1QTYePo7U73eQBy1x"},"executionInfo":{"elapsed":60682,"status":"ok","timestamp":1654061071918,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"v2VyaZksCGEP","outputId":"63febc16-df7c-4206-acf4-82b9aa6bfdde"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["img_result = ['BLD00002_PS3_K3A_NIA0276.png',\n","              'BLD00010_PS3_K3A_NIA0276.png',\n","              'BLD00047_PS3_K3A_NIA0276.png',\n","              'BLD12071_PS3_K3A_NIA0391.png',\n","              'BLD11907_PS3_K3A_NIA0391.png',\n","              'BLD11611_PS3_K3A_NIA0390.png',\n","              'BLD11474_PS3_K3A_NIA0390.png',\n","              'BLD10413_PS3_K3A_NIA0388.png',\n","              'BLD10150_PS3_K3A_NIA0388.png',\n","              'BLD00836_PS3_K3A_NIA0277.png']\n","\n","checkpoint_file = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2/iter_20000.pth'  #학습된 모델\n","\n","\n","# checkpoint 저장된 model 파일을 이용하여 모델을 생성, 이때 Config는 위에서 update된 config 사용. \n","model_ckpt = init_segmentor(cfg, checkpoint_file, device='cuda:0')  #cuda gpu 사용\n","\n","for ir in range(len(img_result)):\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+img_result[ir])\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1crK6HnmMBP44tgWP1hemXiuWWO5fEdhn"},"id":"MGL7wC0QE_Lp","outputId":"7797178d-81aa-4915-b992-bdbc22925378"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["import os\n","file_list = os.listdir('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val')\n","test_png = []\n","for i in file_list:\n","  if '.png' in i:\n","    test_png.append(i)\n","\n","for j in test_png:\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+j)\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"FMx1JaY4wUB0","colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1ljE-EFcwWKNGBu2SHGUMH2VqoaCaWTgV"},"executionInfo":{"status":"ok","timestamp":1654062326846,"user_tz":-540,"elapsed":294637,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"outputId":"89aca269-90ae-4ad5-ce94-3d25181ccf85"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["import os\n","file_list = os.listdir('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val')\n","test_png = []\n","for i in file_list:\n","  if '.png' in i:\n","    test_png.append(i)\n","\n","checkpoint_file = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2/iter_20000.pth'  #학습된 모델\n","\n","model_ckpt = init_segmentor(cfg, checkpoint_file, device='cuda:0')  #cuda gpu 사용\n","img2 = np.zeros((1024,1024,3),np.uint8)\n","\n","for j in test_png:\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+j)\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img2, result, palette)\n","  model_ckpt.show_result(img2, result, out_file= f'/content/drive/MyDrive/SIA/inference_image_road_test/{j}')"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"machine_shape":"hm","name":"Segformer_road_512x512_iter_20k_loss_ lovasz_focal.ipynb의 사본","provenance":[{"file_id":"1-tUNSqxwGyamS6a3CkRHoXF5GMszfber","timestamp":1652320453219}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}