{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":54014,"status":"ok","timestamp":1653938157982,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"nllMQ6RCsenv","outputId":"6179d27e-e952-40dd-9f8c-0ee710bc3e32"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12297,"status":"ok","timestamp":1653938170272,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"PPb5e_glt9i6","outputId":"798009f7-7705-4073-fec6-084165e44f57"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Looking in links: https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","Collecting mmcv-full\n","  Downloading https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/mmcv_full-1.5.2-cp37-cp37m-manylinux1_x86_64.whl (46.4 MB)\n","\u001b[K     |████████████████████████████████| 46.4 MB 238 kB/s \n","\u001b[?25hCollecting addict\n","  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (1.21.6)\n","Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (7.1.2)\n","Collecting yapf\n","  Downloading yapf-0.32.0-py2.py3-none-any.whl (190 kB)\n","\u001b[K     |████████████████████████████████| 190 kB 1.5 MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (21.3)\n","Requirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (4.1.2.30)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (3.13)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->mmcv-full) (3.0.9)\n","Installing collected packages: yapf, addict, mmcv-full\n","Successfully installed addict-2.4.0 mmcv-full-1.5.2 yapf-0.32.0\n","Cloning into 'mmsegmentation'...\n","remote: Enumerating objects: 7190, done.\u001b[K\n","remote: Counting objects: 100% (195/195), done.\u001b[K\n","remote: Compressing objects: 100% (155/155), done.\u001b[K\n","remote: Total 7190 (delta 52), reused 155 (delta 40), pack-reused 6995\u001b[K\n","Receiving objects: 100% (7190/7190), 13.87 MiB | 25.54 MiB/s, done.\n","Resolving deltas: 100% (5224/5224), done.\n"]}],"source":["!pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","!git clone https://github.com/open-mmlab/mmsegmentation.git"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2940,"status":"ok","timestamp":1653938173205,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"zU2hdo-iuDM_","outputId":"2f9ff69c-5aad-474a-96fe-aefc2ebda309"},"outputs":[{"output_type":"stream","name":"stdout","text":["Setup complete. Using torch 1.11.0+cu113 (Tesla P100-PCIE-16GB)\n"]}],"source":["import torch\n","\n","print(f\"Setup complete. Using torch {torch.__version__} ({torch.cuda.get_device_properties(0).name if torch.cuda.is_available() else 'CPU'})\")"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1653938173205,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"5Y38Lq6KuG75","outputId":"93613930-72e0-4b95-d0e5-ef10347a681e"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/mmsegmentation\n"]}],"source":["%cd mmsegmentation"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"scnWNR9VuKnB","executionInfo":{"status":"ok","timestamp":1653938175630,"user_tz":-540,"elapsed":2430,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["from mmseg.apis import inference_segmentor, init_segmentor, show_result_pyplot\n","import mmcv"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"nZ7kLaEfuMhh","executionInfo":{"status":"ok","timestamp":1653938175630,"user_tz":-540,"elapsed":5,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["import os.path as osp\n","import numpy as np\n","from PIL import Image\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":29361,"status":"ok","timestamp":1653938204987,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"O5uVMzGxuRlJ","outputId":"c360b5f6-5959-4843-f1bd-ff8c85f049c1"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-05-30 19:16:15--  https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","Resolving download.openmmlab.com (download.openmmlab.com)... 47.88.36.72\n","Connecting to download.openmmlab.com (download.openmmlab.com)|47.88.36.72|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 328290585 (313M) [application/octet-stream]\n","Saving to: ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’\n","\n","//content/mmsegment 100%[===================>] 313.08M  10.8MB/s    in 26s     \n","\n","2022-05-30 19:16:42 (11.8 MB/s) - ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’ saved [328290585/328290585]\n","\n"]}],"source":["!mkdir checkpoints\n","!wget -O //content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"km0JLIuRumCX","executionInfo":{"status":"ok","timestamp":1653938204989,"user_tz":-540,"elapsed":35,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["from mmseg.datasets.builder import DATASETS\n","from mmseg.datasets.custom import CustomDataset\n","\n","classes = ('background', 'road')\n","palette = [[0, 0, 0], [255, 255, 0]]\n","\n","@DATASETS.register_module()\n","class SIADataset(CustomDataset):\n","  CLASSES = classes\n","  PALETTE = palette\n","  def __init__(self, split, **kwargs):\n","    super().__init__(img_suffix='.png', seg_map_suffix='.png', \n","                     split=split, **kwargs)\n","    assert osp.exists(self.img_dir) and self.split is not None"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":35,"status":"ok","timestamp":1653938204990,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"Qx5ugOgwuxGW","outputId":"50001379-6acb-493b-9b97-fe2c7f788d85"},"outputs":[{"output_type":"stream","name":"stdout","text":["norm_cfg = dict(type='SyncBN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=19,\n","        norm_cfg=dict(type='SyncBN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=dict(\n","            type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0)),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'CityscapesDataset'\n","data_root = 'data/cityscapes/'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (1024, 1024)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","    dict(type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', prob=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(2048, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/train',\n","        ann_dir='gtFine/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","            dict(\n","                type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', prob=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ]),\n","    val=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]),\n","    test=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]))\n","log_config = dict(\n","    interval=50, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = None\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=160000)\n","checkpoint_config = dict(by_epoch=False, interval=16000)\n","evaluation = dict(interval=16000, metric='mIoU', pre_eval=True)\n","\n"]}],"source":["# config 파일을 설정하고, 다운로드 받은 pretrained 모델을 checkpoint로 설정. \n","config_file = '/content/mmsegmentation/configs/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes.py'\n","checkpoint_file = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","from mmcv import Config\n","\n","cfg = Config.fromfile(config_file)\n","print(cfg.pretty_text)"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"caVFRT7QvWE8","executionInfo":{"status":"ok","timestamp":1653938204991,"user_tz":-540,"elapsed":32,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.norm_cfg = dict(type='BN', requires_grad=True)\n","#cfg.model.backbone.norm_cfg = cfg.norm_cfg\n","cfg.model.decode_head.norm_cfg = cfg.norm_cfg\n","\n","cfg.model.decode_head.num_classes = 2\n","\n","cfg.device='cuda'\n","\n","cfg.model.decode_head.loss_decode = [dict(type='CrossEntropyLoss', loss_weight = 1.0),\n","                                    dict(type='DiceLoss', loss_weight = 1.0)]"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"X9IpatmxvYMt","executionInfo":{"status":"ok","timestamp":1653938204992,"user_tz":-540,"elapsed":33,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","cfg.crop_size = (512, 512)\n","cfg.train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=cfg.crop_size, cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(type='Normalize', **cfg.img_norm_cfg),\n","    dict(type='Pad', size=cfg.crop_size, pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg']),\n","]\n","\n","cfg.val_pipeline = [\n","                    dict(type='LoadImageFromFile'),\n","                    dict(\n","                        type='MultiScaleFlipAug',\n","                        img_scale=(1024, 1024),\n","                        flip=False,\n","                        transforms=[\n","                                    dict(type='Resize', keep_ratio=True),\n","                                    dict(type='RandomFlip'),\n","                                    dict(\n","                                        type='Normalize',\n","                                        mean=[123.675, 116.28, 103.53],\n","                                        std=[58.395, 57.12, 57.375],\n","                                        to_rgb=True),\n","                                    dict(type='ImageToTensor', keys=['img']),\n","                                    dict(type='Collect', keys=['img'])\n","                                    ]),\n","                    \n","]\n","\n","cfg.test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            #dict(type='ResizeToMultiple', size_divisor=32),\n","            dict(type='RandomFlip'),\n","            dict(type='Normalize', **cfg.img_norm_cfg),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img']),\n","        ])\n","]"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"_4PNB6hGvds4","executionInfo":{"status":"ok","timestamp":1653938204993,"user_tz":-540,"elapsed":33,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.dataset_type = 'SIADataset'\n","cfg.data_root = '/content/drive/MyDrive/SIA'\n","\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.train.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","\n","cfg.data.val.type = 'SIADataset'\n","cfg.data.val.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.val.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.val.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.val.pipeline = cfg.test_pipeline\n","cfg.data.val.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","\n","cfg.data.test.type = 'SIADataset'\n","cfg.data.test.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.test.img_dir = 'Data_set/road_dataset/img_dir/val'\n","cfg.data.test.ann_dir = 'Data_set/road_dataset/ann_01_dir/val'\n","cfg.data.test.pipeline = cfg.test_pipeline\n","cfg.data.test.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt'"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"jXNN3BblvrfK","executionInfo":{"status":"ok","timestamp":1653938204994,"user_tz":-540,"elapsed":33,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"colab":{"base_uri":"https://localhost:8080/","height":54},"outputId":"8b5d0178-9304-4831-dbd8-c7d849343389"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["\"\\ncfg.data.train.type = 'SIADataset'\\ncfg.data.train.data_root = '/content/drive/MyDrive/SIA'\\ncfg.data.train.img_dir = 'images/up025'\\ncfg.data.train.ann_dir = 'labels'\\ncfg.data.train.pipeline = cfg.train_pipeline\\ncfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\\n\""],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":13}],"source":["'''\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'images/up025'\n","cfg.data.train.ann_dir = 'labels'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\n","'''"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"l1Gc8ttSvw8e","executionInfo":{"status":"ok","timestamp":1653938204995,"user_tz":-540,"elapsed":25,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","# Set up working dir to save files and logs.\n","cfg.work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24,"status":"ok","timestamp":1653938204995,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"vvSIfRurv0sm","outputId":"d64014b8-8877-4d57-d73c-3d4c362cc4af"},"outputs":[{"output_type":"stream","name":"stdout","text":["Config:\n","norm_cfg = dict(type='BN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=2,\n","        norm_cfg=dict(type='BN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=[\n","            dict(type='CrossEntropyLoss', loss_weight=1.0),\n","            dict(type='DiceLoss', loss_weight=1.0)\n","        ]),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'SIADataset'\n","data_root = '/content/drive/MyDrive/SIA'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (512, 512)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","            dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', flip_ratio=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","    ),\n","    val=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","    ),\n","    test=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/val',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt')\n",")\n","log_config = dict(\n","    interval=100, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=20000)\n","checkpoint_config = dict(by_epoch=False, interval=1000)\n","evaluation = dict(interval=1000, metric='mIoU', pre_eval=True)\n","device = 'cuda'\n","val_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'\n","seed = 0\n","gpu_ids = range(0, 1)\n","\n"]}],"source":["cfg.runner.max_iteTrs = 200\n","cfg.log_config.interval = 100\n","cfg.evaluation.interval = 1000  # 모델 학습시 평가를 몇 번째 iteration마다 할 것인지 지정\n","cfg.checkpoint_config.interval = 1000  # 모델 학습시 학습한 모델을 몇 번째 iteration마다 저장할 것인지 지정\n","\n","cfg.runner = dict(type='IterBasedRunner', max_iters=20000)  # Iteration으로 동작, Epoch로 동작하게 변경할 수도 있음\n","# cfg.runner = dict(type='EpochBasedRunner', max_epochs=4000)  # Epoch로 변경\n","cfg.workflow = [('train', 1)]\n","\n","# Set seed to facitate reproducing the result\n","cfg.seed = 0\n","#set_random_seed(0, deterministic=False)\n","cfg.gpu_ids = range(1)\n","\n","# Let's have a look at the final config used for training\n","print(f'Config:\\n{cfg.pretty_text}')"]},{"cell_type":"markdown","source":["### 모델 학습"],"metadata":{"id":"xP_db_FP_lnS"}},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8IlH2WxNwFFW","outputId":"af72188f-2b0d-4afe-f124-d5629657415e","executionInfo":{"status":"ok","timestamp":1653951800938,"user_tz":-540,"elapsed":13595963,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["2022-05-30 19:16:46,420 - mmseg - INFO - Loaded 542 images\n","/content/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:236: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.\n","  'Default ``avg_non_ignore`` is False, if you would like to '\n","2022-05-30 19:17:00,924 - mmseg - INFO - Loaded 66 images\n","2022-05-30 19:17:00,928 - mmseg - INFO - load checkpoint from local path: /content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","2022-05-30 19:17:01,506 - mmseg - WARNING - The model and loaded state dict do not match exactly\n","\n","size mismatch for decode_head.conv_seg.weight: copying a param with shape torch.Size([19, 256, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 256, 1, 1]).\n","size mismatch for decode_head.conv_seg.bias: copying a param with shape torch.Size([19]) from checkpoint, the shape in current model is torch.Size([2]).\n","2022-05-30 19:17:01,515 - mmseg - INFO - Start running, host: root@425a9f6b9bcf, work_dir: /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2\n","2022-05-30 19:17:01,517 - mmseg - INFO - Hooks will be executed in the following order:\n","before_run:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_epoch:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_iter:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n"," -------------------- \n","after_train_iter:\n","(ABOVE_NORMAL) OptimizerHook                      \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_train_epoch:\n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_epoch:\n","(LOW         ) IterTimerHook                      \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_epoch:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_run:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","2022-05-30 19:17:01,519 - mmseg - INFO - workflow: [('train', 1)], max: 20000 iters\n","2022-05-30 19:17:01,524 - mmseg - INFO - Checkpoints will be saved to /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2 by HardDiskBackend.\n","2022-05-30 19:18:13,301 - mmseg - INFO - Iter [100/20000]\tlr: 3.940e-06, eta: 3:56:49, time: 0.714, data_time: 0.318, memory: 3323, decode.loss_ce: 0.8487, decode.loss_dice: 0.4639, decode.acc_seg: 33.1690, loss: 1.3126\n","2022-05-30 19:19:20,786 - mmseg - INFO - Iter [200/20000]\tlr: 7.881e-06, eta: 3:49:09, time: 0.675, data_time: 0.286, memory: 3323, decode.loss_ce: 0.5718, decode.loss_dice: 0.3224, decode.acc_seg: 73.3670, loss: 0.8942\n","2022-05-30 19:20:29,923 - mmseg - INFO - Iter [300/20000]\tlr: 1.178e-05, eta: 3:47:40, time: 0.691, data_time: 0.303, memory: 3323, decode.loss_ce: 0.4021, decode.loss_dice: 0.2495, decode.acc_seg: 85.1615, loss: 0.6516\n","2022-05-30 19:21:34,853 - mmseg - INFO - Iter [400/20000]\tlr: 1.564e-05, eta: 3:42:54, time: 0.649, data_time: 0.260, memory: 3323, decode.loss_ce: 0.3343, decode.loss_dice: 0.2049, decode.acc_seg: 86.6405, loss: 0.5392\n","2022-05-30 19:22:40,566 - mmseg - INFO - Iter [500/20000]\tlr: 1.946e-05, eta: 3:40:07, time: 0.657, data_time: 0.270, memory: 3323, decode.loss_ce: 0.2983, decode.loss_dice: 0.1822, decode.acc_seg: 88.0067, loss: 0.4805\n","2022-05-30 19:23:34,240 - mmseg - INFO - Iter [600/20000]\tlr: 2.324e-05, eta: 3:31:25, time: 0.537, data_time: 0.143, memory: 3323, decode.loss_ce: 0.2875, decode.loss_dice: 0.1746, decode.acc_seg: 88.5313, loss: 0.4621\n","2022-05-30 19:24:14,446 - mmseg - INFO - Iter [700/20000]\tlr: 2.698e-05, eta: 3:18:45, time: 0.402, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2891, decode.loss_dice: 0.1756, decode.acc_seg: 88.3144, loss: 0.4648\n","2022-05-30 19:24:54,469 - mmseg - INFO - Iter [800/20000]\tlr: 3.068e-05, eta: 3:09:01, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2580, decode.loss_dice: 0.1616, decode.acc_seg: 89.8068, loss: 0.4196\n","2022-05-30 19:25:34,491 - mmseg - INFO - Iter [900/20000]\tlr: 3.434e-05, eta: 3:01:18, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2814, decode.loss_dice: 0.1736, decode.acc_seg: 88.7795, loss: 0.4551\n","2022-05-30 19:26:14,755 - mmseg - INFO - Saving checkpoint at 1000 iterations\n","2022-05-30 19:26:30,337 - mmseg - INFO - Iter [1000/20000]\tlr: 3.796e-05, eta: 3:00:00, time: 0.558, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2564, decode.loss_dice: 0.1598, decode.acc_seg: 89.5575, loss: 0.4162\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.2 task/s, elapsed: 270s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 19:31:00,466 - mmseg - INFO - per class results:\n","2022-05-30 19:31:00,468 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 89.95 | 97.97 |\n","|    road    | 51.58 | 56.66 |\n","+------------+-------+-------+\n","2022-05-30 19:31:00,470 - mmseg - INFO - Summary:\n","2022-05-30 19:31:00,473 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 90.92 | 70.76 | 77.32 |\n","+-------+-------+-------+\n","2022-05-30 19:31:00,478 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9092, mIoU: 0.7076, mAcc: 0.7732, IoU.background: 0.8995, IoU.road: 0.5158, Acc.background: 0.9797, Acc.road: 0.5666\n","2022-05-30 19:31:43,277 - mmseg - INFO - Iter [1100/20000]\tlr: 4.154e-05, eta: 4:12:23, time: 3.129, data_time: 2.732, memory: 3323, decode.loss_ce: 0.2654, decode.loss_dice: 0.1639, decode.acc_seg: 89.2981, loss: 0.4293\n","2022-05-30 19:32:23,891 - mmseg - INFO - Iter [1200/20000]\tlr: 4.508e-05, eta: 4:00:44, time: 0.406, data_time: 0.010, memory: 3323, decode.loss_ce: 0.2666, decode.loss_dice: 0.1614, decode.acc_seg: 89.7072, loss: 0.4281\n","2022-05-30 19:33:04,392 - mmseg - INFO - Iter [1300/20000]\tlr: 4.859e-05, eta: 3:50:44, time: 0.405, data_time: 0.010, memory: 3323, decode.loss_ce: 0.2474, decode.loss_dice: 0.1496, decode.acc_seg: 90.1857, loss: 0.3970\n","2022-05-30 19:33:44,695 - mmseg - INFO - Iter [1400/20000]\tlr: 5.205e-05, eta: 3:42:02, time: 0.403, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2609, decode.loss_dice: 0.1547, decode.acc_seg: 89.5127, loss: 0.4156\n","2022-05-30 19:34:24,861 - mmseg - INFO - Iter [1500/20000]\tlr: 5.547e-05, eta: 3:34:23, time: 0.402, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2421, decode.loss_dice: 0.1483, decode.acc_seg: 90.1621, loss: 0.3904\n","2022-05-30 19:35:05,043 - mmseg - INFO - Iter [1600/20000]\tlr: 5.520e-05, eta: 3:27:35, time: 0.402, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2434, decode.loss_dice: 0.1516, decode.acc_seg: 90.1849, loss: 0.3950\n","2022-05-30 19:35:47,328 - mmseg - INFO - Iter [1700/20000]\tlr: 5.490e-05, eta: 3:21:54, time: 0.423, data_time: 0.028, memory: 3323, decode.loss_ce: 0.2255, decode.loss_dice: 0.1422, decode.acc_seg: 90.8872, loss: 0.3677\n","2022-05-30 19:36:27,391 - mmseg - INFO - Iter [1800/20000]\tlr: 5.460e-05, eta: 3:16:24, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2243, decode.loss_dice: 0.1397, decode.acc_seg: 90.9711, loss: 0.3639\n","2022-05-30 19:37:07,518 - mmseg - INFO - Iter [1900/20000]\tlr: 5.430e-05, eta: 3:11:24, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2479, decode.loss_dice: 0.1426, decode.acc_seg: 89.8977, loss: 0.3905\n","2022-05-30 19:37:47,591 - mmseg - INFO - Saving checkpoint at 2000 iterations\n","2022-05-30 19:38:05,676 - mmseg - INFO - Iter [2000/20000]\tlr: 5.400e-05, eta: 3:09:33, time: 0.582, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2201, decode.loss_dice: 0.1297, decode.acc_seg: 91.1480, loss: 0.3498\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 19:42:18,673 - mmseg - INFO - per class results:\n","2022-05-30 19:42:18,676 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 90.85 | 96.13 |\n","|    road    | 60.41 | 71.78 |\n","+------------+-------+-------+\n","2022-05-30 19:42:18,678 - mmseg - INFO - Summary:\n","2022-05-30 19:42:18,680 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 91.97 | 75.63 | 83.95 |\n","+-------+-------+-------+\n","2022-05-30 19:42:18,682 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9197, mIoU: 0.7563, mAcc: 0.8395, IoU.background: 0.9085, IoU.road: 0.6041, Acc.background: 0.9613, Acc.road: 0.7178\n","2022-05-30 19:42:59,197 - mmseg - INFO - Iter [2100/20000]\tlr: 5.370e-05, eta: 3:41:13, time: 2.935, data_time: 2.541, memory: 3323, decode.loss_ce: 0.2373, decode.loss_dice: 0.1412, decode.acc_seg: 90.2787, loss: 0.3786\n","2022-05-30 19:43:41,524 - mmseg - INFO - Iter [2200/20000]\tlr: 5.340e-05, eta: 3:35:42, time: 0.423, data_time: 0.028, memory: 3323, decode.loss_ce: 0.2493, decode.loss_dice: 0.1487, decode.acc_seg: 90.0211, loss: 0.3980\n","2022-05-30 19:44:21,541 - mmseg - INFO - Iter [2300/20000]\tlr: 5.310e-05, eta: 3:30:17, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2258, decode.loss_dice: 0.1359, decode.acc_seg: 91.1501, loss: 0.3616\n","2022-05-30 19:45:01,583 - mmseg - INFO - Iter [2400/20000]\tlr: 5.280e-05, eta: 3:25:17, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2087, decode.loss_dice: 0.1271, decode.acc_seg: 91.5921, loss: 0.3358\n","2022-05-30 19:45:41,482 - mmseg - INFO - Iter [2500/20000]\tlr: 5.250e-05, eta: 3:20:36, time: 0.399, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2138, decode.loss_dice: 0.1268, decode.acc_seg: 91.5471, loss: 0.3407\n","2022-05-30 19:46:21,502 - mmseg - INFO - Iter [2600/20000]\tlr: 5.220e-05, eta: 3:16:15, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2084, decode.loss_dice: 0.1245, decode.acc_seg: 91.5755, loss: 0.3329\n","2022-05-30 19:47:01,712 - mmseg - INFO - Iter [2700/20000]\tlr: 5.190e-05, eta: 3:12:11, time: 0.402, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2371, decode.loss_dice: 0.1359, decode.acc_seg: 90.5151, loss: 0.3730\n","2022-05-30 19:47:44,159 - mmseg - INFO - Iter [2800/20000]\tlr: 5.160e-05, eta: 3:08:36, time: 0.424, data_time: 0.028, memory: 3323, decode.loss_ce: 0.2092, decode.loss_dice: 0.1207, decode.acc_seg: 91.4881, loss: 0.3299\n","2022-05-30 19:48:24,436 - mmseg - INFO - Iter [2900/20000]\tlr: 5.130e-05, eta: 3:05:00, time: 0.403, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2086, decode.loss_dice: 0.1301, decode.acc_seg: 91.5443, loss: 0.3386\n","2022-05-30 19:49:04,693 - mmseg - INFO - Saving checkpoint at 3000 iterations\n","2022-05-30 19:49:20,364 - mmseg - INFO - Iter [3000/20000]\tlr: 5.100e-05, eta: 3:03:04, time: 0.559, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2190, decode.loss_dice: 0.1327, decode.acc_seg: 91.1222, loss: 0.3516\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 19:53:33,264 - mmseg - INFO - per class results:\n","2022-05-30 19:53:33,266 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.25 | 97.37 |\n","|    road    |  59.8 | 67.45 |\n","+------------+-------+-------+\n","2022-05-30 19:53:33,268 - mmseg - INFO - Summary:\n","2022-05-30 19:53:33,270 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.26 | 75.53 | 82.41 |\n","+-------+-------+-------+\n","2022-05-30 19:53:33,273 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9226, mIoU: 0.7553, mAcc: 0.8241, IoU.background: 0.9125, IoU.road: 0.5980, Acc.background: 0.9737, Acc.road: 0.6745\n","2022-05-30 19:54:13,560 - mmseg - INFO - Iter [3100/20000]\tlr: 5.070e-05, eta: 3:22:45, time: 2.932, data_time: 2.536, memory: 3323, decode.loss_ce: 0.2037, decode.loss_dice: 0.1230, decode.acc_seg: 91.8628, loss: 0.3266\n","2022-05-30 19:54:53,539 - mmseg - INFO - Iter [3200/20000]\tlr: 5.040e-05, eta: 3:18:45, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2215, decode.loss_dice: 0.1233, decode.acc_seg: 90.8934, loss: 0.3449\n","2022-05-30 19:55:35,583 - mmseg - INFO - Iter [3300/20000]\tlr: 5.010e-05, eta: 3:15:08, time: 0.420, data_time: 0.028, memory: 3323, decode.loss_ce: 0.2068, decode.loss_dice: 0.1195, decode.acc_seg: 91.4411, loss: 0.3262\n","2022-05-30 19:56:15,654 - mmseg - INFO - Iter [3400/20000]\tlr: 4.980e-05, eta: 3:11:31, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2130, decode.loss_dice: 0.1351, decode.acc_seg: 91.4416, loss: 0.3481\n","2022-05-30 19:56:55,766 - mmseg - INFO - Iter [3500/20000]\tlr: 4.950e-05, eta: 3:08:05, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2225, decode.loss_dice: 0.1231, decode.acc_seg: 91.0797, loss: 0.3456\n","2022-05-30 19:57:35,812 - mmseg - INFO - Iter [3600/20000]\tlr: 4.920e-05, eta: 3:04:47, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2218, decode.loss_dice: 0.1316, decode.acc_seg: 91.0185, loss: 0.3533\n","2022-05-30 19:58:15,866 - mmseg - INFO - Iter [3700/20000]\tlr: 4.890e-05, eta: 3:01:38, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2009, decode.loss_dice: 0.1208, decode.acc_seg: 91.7114, loss: 0.3218\n","2022-05-30 19:58:58,148 - mmseg - INFO - Iter [3800/20000]\tlr: 4.860e-05, eta: 2:58:47, time: 0.423, data_time: 0.028, memory: 3323, decode.loss_ce: 0.1997, decode.loss_dice: 0.1229, decode.acc_seg: 91.8006, loss: 0.3226\n","2022-05-30 19:59:38,531 - mmseg - INFO - Iter [3900/20000]\tlr: 4.830e-05, eta: 2:55:54, time: 0.404, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2178, decode.loss_dice: 0.1287, decode.acc_seg: 91.1233, loss: 0.3465\n","2022-05-30 20:00:18,737 - mmseg - INFO - Saving checkpoint at 4000 iterations\n","2022-05-30 20:00:32,496 - mmseg - INFO - Iter [4000/20000]\tlr: 4.800e-05, eta: 2:54:02, time: 0.540, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2021, decode.loss_dice: 0.1140, decode.acc_seg: 91.7521, loss: 0.3161\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 20:04:45,227 - mmseg - INFO - per class results:\n","2022-05-30 20:04:45,229 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.55 | 96.74 |\n","|    road    | 62.52 | 72.42 |\n","+------------+-------+-------+\n","2022-05-30 20:04:45,231 - mmseg - INFO - Summary:\n","2022-05-30 20:04:45,233 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.59 | 77.03 | 84.58 |\n","+-------+-------+-------+\n","2022-05-30 20:04:45,235 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9259, mIoU: 0.7703, mAcc: 0.8458, IoU.background: 0.9155, IoU.road: 0.6252, Acc.background: 0.9674, Acc.road: 0.7242\n","2022-05-30 20:05:24,472 - mmseg - INFO - Iter [4100/20000]\tlr: 4.770e-05, eta: 3:07:36, time: 2.920, data_time: 2.534, memory: 3323, decode.loss_ce: 0.1926, decode.loss_dice: 0.1110, decode.acc_seg: 92.2631, loss: 0.3036\n","2022-05-30 20:06:03,499 - mmseg - INFO - Iter [4200/20000]\tlr: 4.740e-05, eta: 3:04:25, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_ce: 0.2025, decode.loss_dice: 0.1324, decode.acc_seg: 91.6751, loss: 0.3349\n","2022-05-30 20:06:42,461 - mmseg - INFO - Iter [4300/20000]\tlr: 4.710e-05, eta: 3:01:22, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_ce: 0.2014, decode.loss_dice: 0.1223, decode.acc_seg: 91.8124, loss: 0.3237\n","2022-05-30 20:07:23,278 - mmseg - INFO - Iter [4400/20000]\tlr: 4.680e-05, eta: 2:58:32, time: 0.408, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1780, decode.loss_dice: 0.1137, decode.acc_seg: 92.9189, loss: 0.2916\n","2022-05-30 20:08:02,331 - mmseg - INFO - Iter [4500/20000]\tlr: 4.650e-05, eta: 2:55:41, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_ce: 0.2014, decode.loss_dice: 0.1253, decode.acc_seg: 92.0436, loss: 0.3267\n","2022-05-30 20:08:41,247 - mmseg - INFO - Iter [4600/20000]\tlr: 4.620e-05, eta: 2:52:55, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1960, decode.loss_dice: 0.1130, decode.acc_seg: 91.9482, loss: 0.3090\n","2022-05-30 20:09:20,132 - mmseg - INFO - Iter [4700/20000]\tlr: 4.590e-05, eta: 2:50:15, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_ce: 0.2049, decode.loss_dice: 0.1233, decode.acc_seg: 91.5788, loss: 0.3282\n","2022-05-30 20:09:58,998 - mmseg - INFO - Iter [4800/20000]\tlr: 4.560e-05, eta: 2:47:40, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_ce: 0.2017, decode.loss_dice: 0.1177, decode.acc_seg: 91.7555, loss: 0.3194\n","2022-05-30 20:10:40,081 - mmseg - INFO - Iter [4900/20000]\tlr: 4.530e-05, eta: 2:45:17, time: 0.411, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1813, decode.loss_dice: 0.1117, decode.acc_seg: 92.4985, loss: 0.2929\n","2022-05-30 20:11:19,078 - mmseg - INFO - Saving checkpoint at 5000 iterations\n","2022-05-30 20:11:39,720 - mmseg - INFO - Iter [5000/20000]\tlr: 4.500e-05, eta: 2:43:53, time: 0.596, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1876, decode.loss_dice: 0.1177, decode.acc_seg: 92.4725, loss: 0.3053\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 20:15:52,305 - mmseg - INFO - per class results:\n","2022-05-30 20:15:52,306 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.31 | 97.39 |\n","|    road    | 60.01 | 67.61 |\n","+------------+-------+-------+\n","2022-05-30 20:15:52,309 - mmseg - INFO - Summary:\n","2022-05-30 20:15:52,310 - mmseg - INFO - \n","+-------+-------+------+\n","|  aAcc |  mIoU | mAcc |\n","+-------+-------+------+\n","| 92.31 | 75.66 | 82.5 |\n","+-------+-------+------+\n","2022-05-30 20:15:52,313 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9231, mIoU: 0.7566, mAcc: 0.8250, IoU.background: 0.9131, IoU.road: 0.6001, Acc.background: 0.9739, Acc.road: 0.6761\n","2022-05-30 20:16:31,275 - mmseg - INFO - Iter [5100/20000]\tlr: 4.470e-05, eta: 2:53:48, time: 2.916, data_time: 2.532, memory: 3323, decode.loss_ce: 0.1953, decode.loss_dice: 0.1177, decode.acc_seg: 92.0648, loss: 0.3129\n","2022-05-30 20:17:10,090 - mmseg - INFO - Iter [5200/20000]\tlr: 4.440e-05, eta: 2:51:09, time: 0.388, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1873, decode.loss_dice: 0.1169, decode.acc_seg: 92.3991, loss: 0.3042\n","2022-05-30 20:17:49,165 - mmseg - INFO - Iter [5300/20000]\tlr: 4.410e-05, eta: 2:48:35, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1902, decode.loss_dice: 0.1092, decode.acc_seg: 92.2159, loss: 0.2995\n","2022-05-30 20:18:28,974 - mmseg - INFO - Iter [5400/20000]\tlr: 4.380e-05, eta: 2:46:08, time: 0.398, data_time: 0.007, memory: 3323, decode.loss_ce: 0.2027, decode.loss_dice: 0.1216, decode.acc_seg: 91.4901, loss: 0.3243\n","2022-05-30 20:19:10,645 - mmseg - INFO - Iter [5500/20000]\tlr: 4.350e-05, eta: 2:43:50, time: 0.417, data_time: 0.028, memory: 3323, decode.loss_ce: 0.2097, decode.loss_dice: 0.1190, decode.acc_seg: 91.6161, loss: 0.3287\n","2022-05-30 20:19:49,963 - mmseg - INFO - Iter [5600/20000]\tlr: 4.320e-05, eta: 2:41:29, time: 0.393, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1859, decode.loss_dice: 0.1135, decode.acc_seg: 92.4270, loss: 0.2994\n","2022-05-30 20:20:29,155 - mmseg - INFO - Iter [5700/20000]\tlr: 4.290e-05, eta: 2:39:11, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1943, decode.loss_dice: 0.1117, decode.acc_seg: 92.1752, loss: 0.3060\n","2022-05-30 20:21:08,288 - mmseg - INFO - Iter [5800/20000]\tlr: 4.260e-05, eta: 2:36:56, time: 0.391, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1794, decode.loss_dice: 0.1058, decode.acc_seg: 92.6335, loss: 0.2853\n","2022-05-30 20:21:47,564 - mmseg - INFO - Iter [5900/20000]\tlr: 4.230e-05, eta: 2:34:45, time: 0.393, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1896, decode.loss_dice: 0.1126, decode.acc_seg: 92.1942, loss: 0.3022\n","2022-05-30 20:22:28,938 - mmseg - INFO - Saving checkpoint at 6000 iterations\n","2022-05-30 20:22:43,422 - mmseg - INFO - Iter [6000/20000]\tlr: 4.200e-05, eta: 2:33:16, time: 0.559, data_time: 0.028, memory: 3323, decode.loss_ce: 0.1844, decode.loss_dice: 0.1079, decode.acc_seg: 92.4002, loss: 0.2922\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 20:26:56,180 - mmseg - INFO - per class results:\n","2022-05-30 20:26:56,182 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.82 | 97.69 |\n","|    road    | 61.98 | 68.93 |\n","+------------+-------+-------+\n","2022-05-30 20:26:56,185 - mmseg - INFO - Summary:\n","2022-05-30 20:26:56,187 - mmseg - INFO - \n","+-------+------+-------+\n","|  aAcc | mIoU |  mAcc |\n","+-------+------+-------+\n","| 92.78 | 76.9 | 83.31 |\n","+-------+------+-------+\n","2022-05-30 20:26:56,189 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9278, mIoU: 0.7690, mAcc: 0.8331, IoU.background: 0.9182, IoU.road: 0.6198, Acc.background: 0.9769, Acc.road: 0.6893\n","2022-05-30 20:27:35,894 - mmseg - INFO - Iter [6100/20000]\tlr: 4.170e-05, eta: 2:40:47, time: 2.925, data_time: 2.534, memory: 3323, decode.loss_ce: 0.1856, decode.loss_dice: 0.1048, decode.acc_seg: 92.3798, loss: 0.2904\n","2022-05-30 20:28:15,473 - mmseg - INFO - Iter [6200/20000]\tlr: 4.140e-05, eta: 2:38:32, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1863, decode.loss_dice: 0.1093, decode.acc_seg: 92.3638, loss: 0.2956\n","2022-05-30 20:28:55,171 - mmseg - INFO - Iter [6300/20000]\tlr: 4.110e-05, eta: 2:36:19, time: 0.397, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1903, decode.loss_dice: 0.1140, decode.acc_seg: 92.1951, loss: 0.3043\n","2022-05-30 20:29:34,806 - mmseg - INFO - Iter [6400/20000]\tlr: 4.080e-05, eta: 2:34:09, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1954, decode.loss_dice: 0.1243, decode.acc_seg: 92.1398, loss: 0.3197\n","2022-05-30 20:30:14,888 - mmseg - INFO - Iter [6500/20000]\tlr: 4.050e-05, eta: 2:32:03, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1875, decode.loss_dice: 0.1097, decode.acc_seg: 92.1911, loss: 0.2972\n","2022-05-30 20:30:56,801 - mmseg - INFO - Iter [6600/20000]\tlr: 4.020e-05, eta: 2:30:04, time: 0.419, data_time: 0.028, memory: 3323, decode.loss_ce: 0.1841, decode.loss_dice: 0.1055, decode.acc_seg: 92.5965, loss: 0.2895\n","2022-05-30 20:31:36,391 - mmseg - INFO - Iter [6700/20000]\tlr: 3.990e-05, eta: 2:28:02, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1918, decode.loss_dice: 0.1139, decode.acc_seg: 91.9297, loss: 0.3057\n","2022-05-30 20:32:15,992 - mmseg - INFO - Iter [6800/20000]\tlr: 3.960e-05, eta: 2:26:02, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1744, decode.loss_dice: 0.1081, decode.acc_seg: 92.9003, loss: 0.2825\n","2022-05-30 20:32:55,628 - mmseg - INFO - Iter [6900/20000]\tlr: 3.930e-05, eta: 2:24:05, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1702, decode.loss_dice: 0.1049, decode.acc_seg: 92.9510, loss: 0.2751\n","2022-05-30 20:33:35,003 - mmseg - INFO - Saving checkpoint at 7000 iterations\n","2022-05-30 20:33:51,794 - mmseg - INFO - Iter [7000/20000]\tlr: 3.900e-05, eta: 2:22:41, time: 0.562, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1836, decode.loss_dice: 0.1041, decode.acc_seg: 92.4243, loss: 0.2877\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 20:38:04,350 - mmseg - INFO - per class results:\n","2022-05-30 20:38:04,352 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.54 | 96.13 |\n","|    road    | 63.64 |  75.6 |\n","+------------+-------+-------+\n","2022-05-30 20:38:04,354 - mmseg - INFO - Summary:\n","2022-05-30 20:38:04,356 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.63 | 77.59 | 85.87 |\n","+-------+-------+-------+\n","2022-05-30 20:38:04,358 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9263, mIoU: 0.7759, mAcc: 0.8587, IoU.background: 0.9154, IoU.road: 0.6364, Acc.background: 0.9613, Acc.road: 0.7560\n","2022-05-30 20:38:45,647 - mmseg - INFO - Iter [7100/20000]\tlr: 3.870e-05, eta: 2:28:29, time: 2.939, data_time: 2.553, memory: 3323, decode.loss_ce: 0.1821, decode.loss_dice: 0.1123, decode.acc_seg: 92.5123, loss: 0.2945\n","2022-05-30 20:39:24,661 - mmseg - INFO - Iter [7200/20000]\tlr: 3.840e-05, eta: 2:26:27, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1730, decode.loss_dice: 0.1001, decode.acc_seg: 93.0332, loss: 0.2731\n","2022-05-30 20:40:03,893 - mmseg - INFO - Iter [7300/20000]\tlr: 3.810e-05, eta: 2:24:27, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1773, decode.loss_dice: 0.1148, decode.acc_seg: 92.6783, loss: 0.2921\n","2022-05-30 20:40:43,113 - mmseg - INFO - Iter [7400/20000]\tlr: 3.780e-05, eta: 2:22:29, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1845, decode.loss_dice: 0.1093, decode.acc_seg: 92.4826, loss: 0.2938\n","2022-05-30 20:41:22,357 - mmseg - INFO - Iter [7500/20000]\tlr: 3.750e-05, eta: 2:20:33, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1933, decode.loss_dice: 0.1096, decode.acc_seg: 91.9840, loss: 0.3028\n","2022-05-30 20:42:03,910 - mmseg - INFO - Iter [7600/20000]\tlr: 3.720e-05, eta: 2:18:44, time: 0.416, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1644, decode.loss_dice: 0.0961, decode.acc_seg: 93.3189, loss: 0.2605\n","2022-05-30 20:42:43,506 - mmseg - INFO - Iter [7700/20000]\tlr: 3.690e-05, eta: 2:16:53, time: 0.396, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1696, decode.loss_dice: 0.1038, decode.acc_seg: 93.0954, loss: 0.2734\n","2022-05-30 20:43:22,873 - mmseg - INFO - Iter [7800/20000]\tlr: 3.660e-05, eta: 2:15:03, time: 0.394, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1799, decode.loss_dice: 0.1017, decode.acc_seg: 92.6659, loss: 0.2816\n","2022-05-30 20:44:02,986 - mmseg - INFO - Iter [7900/20000]\tlr: 3.630e-05, eta: 2:13:16, time: 0.401, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1900, decode.loss_dice: 0.1075, decode.acc_seg: 92.1717, loss: 0.2975\n","2022-05-30 20:44:42,370 - mmseg - INFO - Saving checkpoint at 8000 iterations\n","2022-05-30 20:44:58,898 - mmseg - INFO - Iter [8000/20000]\tlr: 3.600e-05, eta: 2:11:55, time: 0.559, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1810, decode.loss_dice: 0.1067, decode.acc_seg: 92.6065, loss: 0.2878\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 20:49:11,645 - mmseg - INFO - per class results:\n","2022-05-30 20:49:11,648 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.78 | 96.93 |\n","|    road    | 63.27 | 72.69 |\n","+------------+-------+-------+\n","2022-05-30 20:49:11,650 - mmseg - INFO - Summary:\n","2022-05-30 20:49:11,651 - mmseg - INFO - \n","+------+-------+-------+\n","| aAcc |  mIoU |  mAcc |\n","+------+-------+-------+\n","| 92.8 | 77.52 | 84.81 |\n","+------+-------+-------+\n","2022-05-30 20:49:11,653 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9280, mIoU: 0.7752, mAcc: 0.8481, IoU.background: 0.9178, IoU.road: 0.6327, Acc.background: 0.9693, Acc.road: 0.7269\n","2022-05-30 20:49:50,770 - mmseg - INFO - Iter [8100/20000]\tlr: 3.570e-05, eta: 2:16:21, time: 2.919, data_time: 2.534, memory: 3323, decode.loss_ce: 0.1790, decode.loss_dice: 0.1016, decode.acc_seg: 92.4819, loss: 0.2807\n","2022-05-30 20:50:31,828 - mmseg - INFO - Iter [8200/20000]\tlr: 3.540e-05, eta: 2:14:32, time: 0.411, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1799, decode.loss_dice: 0.1004, decode.acc_seg: 92.7120, loss: 0.2803\n","2022-05-30 20:51:11,129 - mmseg - INFO - Iter [8300/20000]\tlr: 3.510e-05, eta: 2:12:43, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1865, decode.loss_dice: 0.1101, decode.acc_seg: 92.3902, loss: 0.2966\n","2022-05-30 20:51:50,241 - mmseg - INFO - Iter [8400/20000]\tlr: 3.480e-05, eta: 2:10:55, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1899, decode.loss_dice: 0.1143, decode.acc_seg: 92.2016, loss: 0.3042\n","2022-05-30 20:52:29,453 - mmseg - INFO - Iter [8500/20000]\tlr: 3.450e-05, eta: 2:09:08, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1652, decode.loss_dice: 0.1085, decode.acc_seg: 93.2849, loss: 0.2738\n","2022-05-30 20:53:08,883 - mmseg - INFO - Iter [8600/20000]\tlr: 3.420e-05, eta: 2:07:24, time: 0.394, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1654, decode.loss_dice: 0.0969, decode.acc_seg: 93.1822, loss: 0.2623\n","2022-05-30 20:53:50,293 - mmseg - INFO - Iter [8700/20000]\tlr: 3.390e-05, eta: 2:05:44, time: 0.414, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1750, decode.loss_dice: 0.1003, decode.acc_seg: 92.7164, loss: 0.2753\n","2022-05-30 20:54:29,775 - mmseg - INFO - Iter [8800/20000]\tlr: 3.360e-05, eta: 2:04:02, time: 0.395, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1761, decode.loss_dice: 0.0987, decode.acc_seg: 92.6847, loss: 0.2748\n","2022-05-30 20:55:09,105 - mmseg - INFO - Iter [8900/20000]\tlr: 3.330e-05, eta: 2:02:22, time: 0.393, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1661, decode.loss_dice: 0.1029, decode.acc_seg: 93.2571, loss: 0.2690\n","2022-05-30 20:55:48,479 - mmseg - INFO - Saving checkpoint at 9000 iterations\n","2022-05-30 20:56:16,668 - mmseg - INFO - Iter [9000/20000]\tlr: 3.300e-05, eta: 2:01:17, time: 0.676, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1760, decode.loss_dice: 0.1070, decode.acc_seg: 92.7614, loss: 0.2830\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:00:29,287 - mmseg - INFO - per class results:\n","2022-05-30 21:00:29,289 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.65 | 98.25 |\n","|    road    | 59.92 | 65.02 |\n","+------------+-------+-------+\n","2022-05-30 21:00:29,291 - mmseg - INFO - Summary:\n","2022-05-30 21:00:29,293 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.58 | 75.79 | 81.63 |\n","+-------+-------+-------+\n","2022-05-30 21:00:29,296 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9258, mIoU: 0.7579, mAcc: 0.8163, IoU.background: 0.9165, IoU.road: 0.5992, Acc.background: 0.9825, Acc.road: 0.6502\n","2022-05-30 21:01:09,087 - mmseg - INFO - Iter [9100/20000]\tlr: 3.270e-05, eta: 2:04:42, time: 2.924, data_time: 2.533, memory: 3323, decode.loss_ce: 0.1670, decode.loss_dice: 0.0940, decode.acc_seg: 93.0153, loss: 0.2610\n","2022-05-30 21:01:48,605 - mmseg - INFO - Iter [9200/20000]\tlr: 3.240e-05, eta: 2:02:59, time: 0.395, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1715, decode.loss_dice: 0.1027, decode.acc_seg: 92.9486, loss: 0.2742\n","2022-05-30 21:02:30,131 - mmseg - INFO - Iter [9300/20000]\tlr: 3.210e-05, eta: 2:01:20, time: 0.415, data_time: 0.028, memory: 3323, decode.loss_ce: 0.1658, decode.loss_dice: 0.0996, decode.acc_seg: 93.0363, loss: 0.2654\n","2022-05-30 21:03:09,403 - mmseg - INFO - Iter [9400/20000]\tlr: 3.180e-05, eta: 1:59:40, time: 0.393, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1639, decode.loss_dice: 0.0967, decode.acc_seg: 93.1299, loss: 0.2607\n","2022-05-30 21:03:48,894 - mmseg - INFO - Iter [9500/20000]\tlr: 3.150e-05, eta: 1:58:01, time: 0.395, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1818, decode.loss_dice: 0.0956, decode.acc_seg: 92.5145, loss: 0.2775\n","2022-05-30 21:04:28,617 - mmseg - INFO - Iter [9600/20000]\tlr: 3.120e-05, eta: 1:56:23, time: 0.397, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1709, decode.loss_dice: 0.1033, decode.acc_seg: 92.9101, loss: 0.2742\n","2022-05-30 21:05:08,355 - mmseg - INFO - Iter [9700/20000]\tlr: 3.090e-05, eta: 1:54:47, time: 0.397, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1748, decode.loss_dice: 0.0987, decode.acc_seg: 92.6477, loss: 0.2735\n","2022-05-30 21:05:49,964 - mmseg - INFO - Iter [9800/20000]\tlr: 3.060e-05, eta: 1:53:14, time: 0.416, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1759, decode.loss_dice: 0.1025, decode.acc_seg: 92.6108, loss: 0.2784\n","2022-05-30 21:06:29,698 - mmseg - INFO - Iter [9900/20000]\tlr: 3.030e-05, eta: 1:51:40, time: 0.397, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1646, decode.loss_dice: 0.0962, decode.acc_seg: 93.2072, loss: 0.2608\n","2022-05-30 21:07:09,375 - mmseg - INFO - Saving checkpoint at 10000 iterations\n","2022-05-30 21:07:24,775 - mmseg - INFO - Iter [10000/20000]\tlr: 3.000e-05, eta: 1:50:22, time: 0.551, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1711, decode.loss_dice: 0.0992, decode.acc_seg: 92.9632, loss: 0.2703\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:11:37,455 - mmseg - INFO - per class results:\n","2022-05-30 21:11:37,457 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  92.0 | 96.85 |\n","|    road    | 64.51 | 74.37 |\n","+------------+-------+-------+\n","2022-05-30 21:11:37,458 - mmseg - INFO - Summary:\n","2022-05-30 21:11:37,460 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.02 | 78.25 | 85.61 |\n","+-------+-------+-------+\n","2022-05-30 21:11:37,463 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9302, mIoU: 0.7825, mAcc: 0.8561, IoU.background: 0.9200, IoU.road: 0.6451, Acc.background: 0.9685, Acc.road: 0.7437\n","2022-05-30 21:12:17,032 - mmseg - INFO - Iter [10100/20000]\tlr: 2.970e-05, eta: 1:52:58, time: 2.923, data_time: 2.534, memory: 3323, decode.loss_ce: 0.1597, decode.loss_dice: 0.1061, decode.acc_seg: 93.4724, loss: 0.2658\n","2022-05-30 21:12:56,511 - mmseg - INFO - Iter [10200/20000]\tlr: 2.940e-05, eta: 1:51:21, time: 0.395, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1695, decode.loss_dice: 0.1130, decode.acc_seg: 92.9932, loss: 0.2825\n","2022-05-30 21:13:38,015 - mmseg - INFO - Iter [10300/20000]\tlr: 2.910e-05, eta: 1:49:48, time: 0.415, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1535, decode.loss_dice: 0.0889, decode.acc_seg: 93.6514, loss: 0.2424\n","2022-05-30 21:14:17,035 - mmseg - INFO - Iter [10400/20000]\tlr: 2.880e-05, eta: 1:48:13, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1580, decode.loss_dice: 0.0918, decode.acc_seg: 93.3502, loss: 0.2498\n","2022-05-30 21:14:56,270 - mmseg - INFO - Iter [10500/20000]\tlr: 2.850e-05, eta: 1:46:40, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1612, decode.loss_dice: 0.0990, decode.acc_seg: 93.2842, loss: 0.2602\n","2022-05-30 21:15:35,379 - mmseg - INFO - Iter [10600/20000]\tlr: 2.820e-05, eta: 1:45:08, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1710, decode.loss_dice: 0.1014, decode.acc_seg: 92.8521, loss: 0.2724\n","2022-05-30 21:16:14,592 - mmseg - INFO - Iter [10700/20000]\tlr: 2.790e-05, eta: 1:43:36, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1801, decode.loss_dice: 0.1090, decode.acc_seg: 92.5720, loss: 0.2891\n","2022-05-30 21:16:53,563 - mmseg - INFO - Iter [10800/20000]\tlr: 2.760e-05, eta: 1:42:06, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1660, decode.loss_dice: 0.0973, decode.acc_seg: 93.1674, loss: 0.2633\n","2022-05-30 21:17:34,589 - mmseg - INFO - Iter [10900/20000]\tlr: 2.730e-05, eta: 1:40:38, time: 0.410, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1563, decode.loss_dice: 0.0896, decode.acc_seg: 93.4819, loss: 0.2459\n","2022-05-30 21:18:13,766 - mmseg - INFO - Saving checkpoint at 11000 iterations\n","2022-05-30 21:18:31,955 - mmseg - INFO - Iter [11000/20000]\tlr: 2.700e-05, eta: 1:39:24, time: 0.574, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1605, decode.loss_dice: 0.0958, decode.acc_seg: 93.3499, loss: 0.2562\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:22:44,523 - mmseg - INFO - per class results:\n","2022-05-30 21:22:44,525 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.01 | 96.81 |\n","|    road    | 64.63 | 74.66 |\n","+------------+-------+-------+\n","2022-05-30 21:22:44,527 - mmseg - INFO - Summary:\n","2022-05-30 21:22:44,531 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.03 | 78.32 | 85.73 |\n","+-------+-------+-------+\n","2022-05-30 21:22:44,535 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9303, mIoU: 0.7832, mAcc: 0.8573, IoU.background: 0.9201, IoU.road: 0.6463, Acc.background: 0.9681, Acc.road: 0.7466\n","2022-05-30 21:23:23,807 - mmseg - INFO - Iter [11100/20000]\tlr: 2.670e-05, eta: 1:41:19, time: 2.919, data_time: 2.532, memory: 3323, decode.loss_ce: 0.1522, decode.loss_dice: 0.1019, decode.acc_seg: 93.7919, loss: 0.2541\n","2022-05-30 21:24:03,080 - mmseg - INFO - Iter [11200/20000]\tlr: 2.640e-05, eta: 1:39:47, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1773, decode.loss_dice: 0.1005, decode.acc_seg: 92.4990, loss: 0.2778\n","2022-05-30 21:24:42,356 - mmseg - INFO - Iter [11300/20000]\tlr: 2.610e-05, eta: 1:38:17, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1662, decode.loss_dice: 0.0887, decode.acc_seg: 92.9982, loss: 0.2549\n","2022-05-30 21:25:23,575 - mmseg - INFO - Iter [11400/20000]\tlr: 2.580e-05, eta: 1:36:49, time: 0.412, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1640, decode.loss_dice: 0.0967, decode.acc_seg: 93.2362, loss: 0.2607\n","2022-05-30 21:26:02,800 - mmseg - INFO - Iter [11500/20000]\tlr: 2.550e-05, eta: 1:35:21, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1605, decode.loss_dice: 0.1004, decode.acc_seg: 93.2513, loss: 0.2609\n","2022-05-30 21:26:42,061 - mmseg - INFO - Iter [11600/20000]\tlr: 2.520e-05, eta: 1:33:53, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1539, decode.loss_dice: 0.0933, decode.acc_seg: 93.7570, loss: 0.2472\n","2022-05-30 21:27:21,234 - mmseg - INFO - Iter [11700/20000]\tlr: 2.490e-05, eta: 1:32:26, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1671, decode.loss_dice: 0.0967, decode.acc_seg: 93.0461, loss: 0.2637\n","2022-05-30 21:28:00,402 - mmseg - INFO - Iter [11800/20000]\tlr: 2.460e-05, eta: 1:31:00, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_ce: 0.1518, decode.loss_dice: 0.0871, decode.acc_seg: 93.7000, loss: 0.2389\n","2022-05-30 21:28:39,783 - mmseg - INFO - Iter [11900/20000]\tlr: 2.430e-05, eta: 1:29:35, time: 0.394, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1609, decode.loss_dice: 0.0976, decode.acc_seg: 93.2515, loss: 0.2584\n","2022-05-30 21:29:21,372 - mmseg - INFO - Saving checkpoint at 12000 iterations\n","2022-05-30 21:29:36,699 - mmseg - INFO - Iter [12000/20000]\tlr: 2.400e-05, eta: 1:28:23, time: 0.569, data_time: 0.027, memory: 3323, decode.loss_ce: 0.1604, decode.loss_dice: 0.0967, decode.acc_seg: 93.4079, loss: 0.2571\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:33:49,305 - mmseg - INFO - per class results:\n","2022-05-30 21:33:49,307 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.12 |  97.3 |\n","|    road    | 64.26 | 72.69 |\n","+------------+-------+-------+\n","2022-05-30 21:33:49,309 - mmseg - INFO - Summary:\n","2022-05-30 21:33:49,312 - mmseg - INFO - \n","+------+-------+-------+\n","| aAcc |  mIoU |  mAcc |\n","+------+-------+-------+\n","| 93.1 | 78.19 | 84.99 |\n","+------+-------+-------+\n","2022-05-30 21:33:49,315 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9310, mIoU: 0.7819, mAcc: 0.8499, IoU.background: 0.9212, IoU.road: 0.6426, Acc.background: 0.9730, Acc.road: 0.7269\n","2022-05-30 21:34:29,234 - mmseg - INFO - Iter [12100/20000]\tlr: 2.370e-05, eta: 1:29:44, time: 2.925, data_time: 2.533, memory: 3323, decode.loss_ce: 0.1601, decode.loss_dice: 0.0918, decode.acc_seg: 93.4097, loss: 0.2519\n","2022-05-30 21:35:09,206 - mmseg - INFO - Iter [12200/20000]\tlr: 2.340e-05, eta: 1:28:18, time: 0.400, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1661, decode.loss_dice: 0.0991, decode.acc_seg: 93.1015, loss: 0.2652\n","2022-05-30 21:35:49,033 - mmseg - INFO - Iter [12300/20000]\tlr: 2.310e-05, eta: 1:26:52, time: 0.398, data_time: 0.007, memory: 3323, decode.loss_ce: 0.1450, decode.loss_dice: 0.0826, decode.acc_seg: 94.0091, loss: 0.2277\n","2022-05-30 21:36:28,703 - mmseg - INFO - Iter [12400/20000]\tlr: 2.280e-05, eta: 1:25:27, time: 0.397, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1597, decode.loss_dice: 0.0953, decode.acc_seg: 93.4260, loss: 0.2550\n","2022-05-30 21:37:10,704 - mmseg - INFO - Iter [12500/20000]\tlr: 2.250e-05, eta: 1:24:05, time: 0.420, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1489, decode.loss_dice: 0.0896, decode.acc_seg: 93.8259, loss: 0.2385\n","2022-05-30 21:37:51,139 - mmseg - INFO - Iter [12600/20000]\tlr: 2.220e-05, eta: 1:22:42, time: 0.404, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1502, decode.loss_dice: 0.0847, decode.acc_seg: 93.8079, loss: 0.2349\n","2022-05-30 21:38:31,069 - mmseg - INFO - Iter [12700/20000]\tlr: 2.190e-05, eta: 1:21:19, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1551, decode.loss_dice: 0.0903, decode.acc_seg: 93.4987, loss: 0.2454\n","2022-05-30 21:39:11,067 - mmseg - INFO - Iter [12800/20000]\tlr: 2.160e-05, eta: 1:19:57, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1565, decode.loss_dice: 0.0906, decode.acc_seg: 93.5405, loss: 0.2471\n","2022-05-30 21:39:51,048 - mmseg - INFO - Iter [12900/20000]\tlr: 2.130e-05, eta: 1:18:36, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1512, decode.loss_dice: 0.0919, decode.acc_seg: 93.6212, loss: 0.2431\n","2022-05-30 21:40:31,197 - mmseg - INFO - Saving checkpoint at 13000 iterations\n","2022-05-30 21:40:45,858 - mmseg - INFO - Iter [13000/20000]\tlr: 2.100e-05, eta: 1:17:23, time: 0.548, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1643, decode.loss_dice: 0.0905, decode.acc_seg: 93.1248, loss: 0.2548\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:44:58,823 - mmseg - INFO - per class results:\n","2022-05-30 21:44:58,825 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.04 | 96.42 |\n","|    road    | 65.47 | 76.86 |\n","+------------+-------+-------+\n","2022-05-30 21:44:58,828 - mmseg - INFO - Summary:\n","2022-05-30 21:44:58,831 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.08 | 78.75 | 86.64 |\n","+-------+-------+-------+\n","2022-05-30 21:44:58,832 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9308, mIoU: 0.7875, mAcc: 0.8664, IoU.background: 0.9204, IoU.road: 0.6547, Acc.background: 0.9642, Acc.road: 0.7686\n","2022-05-30 21:45:41,003 - mmseg - INFO - Iter [13100/20000]\tlr: 2.070e-05, eta: 1:18:17, time: 2.951, data_time: 2.558, memory: 3324, decode.loss_ce: 0.1586, decode.loss_dice: 0.0878, decode.acc_seg: 93.3051, loss: 0.2464\n","2022-05-30 21:46:21,029 - mmseg - INFO - Iter [13200/20000]\tlr: 2.040e-05, eta: 1:16:55, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1565, decode.loss_dice: 0.1033, decode.acc_seg: 93.2952, loss: 0.2598\n","2022-05-30 21:47:00,682 - mmseg - INFO - Iter [13300/20000]\tlr: 2.010e-05, eta: 1:15:33, time: 0.397, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1510, decode.loss_dice: 0.0928, decode.acc_seg: 93.6681, loss: 0.2438\n","2022-05-30 21:47:40,263 - mmseg - INFO - Iter [13400/20000]\tlr: 1.980e-05, eta: 1:14:11, time: 0.396, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1558, decode.loss_dice: 0.0978, decode.acc_seg: 93.5653, loss: 0.2535\n","2022-05-30 21:48:19,884 - mmseg - INFO - Iter [13500/20000]\tlr: 1.950e-05, eta: 1:12:50, time: 0.396, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1448, decode.loss_dice: 0.0850, decode.acc_seg: 93.9801, loss: 0.2298\n","2022-05-30 21:49:01,661 - mmseg - INFO - Iter [13600/20000]\tlr: 1.920e-05, eta: 1:11:31, time: 0.418, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1348, decode.loss_dice: 0.0786, decode.acc_seg: 94.3670, loss: 0.2134\n","2022-05-30 21:49:41,319 - mmseg - INFO - Iter [13700/20000]\tlr: 1.890e-05, eta: 1:10:11, time: 0.397, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1485, decode.loss_dice: 0.0862, decode.acc_seg: 93.8046, loss: 0.2347\n","2022-05-30 21:50:20,844 - mmseg - INFO - Iter [13800/20000]\tlr: 1.860e-05, eta: 1:08:52, time: 0.395, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1489, decode.loss_dice: 0.0814, decode.acc_seg: 93.7892, loss: 0.2304\n","2022-05-30 21:51:00,293 - mmseg - INFO - Iter [13900/20000]\tlr: 1.830e-05, eta: 1:07:34, time: 0.394, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1501, decode.loss_dice: 0.0859, decode.acc_seg: 93.6377, loss: 0.2360\n","2022-05-30 21:51:39,736 - mmseg - INFO - Saving checkpoint at 14000 iterations\n","2022-05-30 21:51:54,480 - mmseg - INFO - Iter [14000/20000]\tlr: 1.800e-05, eta: 1:06:22, time: 0.542, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1630, decode.loss_dice: 0.0977, decode.acc_seg: 93.1096, loss: 0.2607\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 21:56:07,331 - mmseg - INFO - per class results:\n","2022-05-30 21:56:07,333 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.11 | 97.45 |\n","|    road    |  63.9 | 71.83 |\n","+------------+-------+-------+\n","2022-05-30 21:56:07,335 - mmseg - INFO - Summary:\n","2022-05-30 21:56:07,338 - mmseg - INFO - \n","+-------+------+-------+\n","|  aAcc | mIoU |  mAcc |\n","+-------+------+-------+\n","| 93.07 | 78.0 | 84.64 |\n","+-------+------+-------+\n","2022-05-30 21:56:07,342 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9307, mIoU: 0.7800, mAcc: 0.8464, IoU.background: 0.9211, IoU.road: 0.6390, Acc.background: 0.9745, Acc.road: 0.7183\n","2022-05-30 21:56:48,843 - mmseg - INFO - Iter [14100/20000]\tlr: 1.770e-05, eta: 1:06:51, time: 2.944, data_time: 2.556, memory: 3324, decode.loss_ce: 0.1475, decode.loss_dice: 0.0866, decode.acc_seg: 93.8448, loss: 0.2341\n","2022-05-30 21:57:28,304 - mmseg - INFO - Iter [14200/20000]\tlr: 1.740e-05, eta: 1:05:31, time: 0.395, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1471, decode.loss_dice: 0.0918, decode.acc_seg: 93.7931, loss: 0.2388\n","2022-05-30 21:58:07,771 - mmseg - INFO - Iter [14300/20000]\tlr: 1.710e-05, eta: 1:04:12, time: 0.395, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1545, decode.loss_dice: 0.0987, decode.acc_seg: 93.4934, loss: 0.2531\n","2022-05-30 21:58:47,177 - mmseg - INFO - Iter [14400/20000]\tlr: 1.680e-05, eta: 1:02:54, time: 0.394, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1375, decode.loss_dice: 0.0829, decode.acc_seg: 94.4134, loss: 0.2204\n","2022-05-30 21:59:26,620 - mmseg - INFO - Iter [14500/20000]\tlr: 1.650e-05, eta: 1:01:36, time: 0.394, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1417, decode.loss_dice: 0.0816, decode.acc_seg: 94.0296, loss: 0.2233\n","2022-05-30 22:00:06,215 - mmseg - INFO - Iter [14600/20000]\tlr: 1.620e-05, eta: 1:00:18, time: 0.396, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1586, decode.loss_dice: 0.0922, decode.acc_seg: 93.2919, loss: 0.2508\n","2022-05-30 22:00:47,705 - mmseg - INFO - Iter [14700/20000]\tlr: 1.590e-05, eta: 0:59:02, time: 0.415, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1445, decode.loss_dice: 0.0889, decode.acc_seg: 93.8842, loss: 0.2334\n","2022-05-30 22:01:27,235 - mmseg - INFO - Iter [14800/20000]\tlr: 1.560e-05, eta: 0:57:46, time: 0.395, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1424, decode.loss_dice: 0.0865, decode.acc_seg: 94.0451, loss: 0.2288\n","2022-05-30 22:02:06,752 - mmseg - INFO - Iter [14900/20000]\tlr: 1.530e-05, eta: 0:56:30, time: 0.395, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1454, decode.loss_dice: 0.0876, decode.acc_seg: 93.8073, loss: 0.2330\n","2022-05-30 22:02:46,232 - mmseg - INFO - Saving checkpoint at 15000 iterations\n","2022-05-30 22:03:01,507 - mmseg - INFO - Iter [15000/20000]\tlr: 1.500e-05, eta: 0:55:19, time: 0.548, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1405, decode.loss_dice: 0.0878, decode.acc_seg: 94.1030, loss: 0.2283\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 22:07:14,331 - mmseg - INFO - per class results:\n","2022-05-30 22:07:14,333 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.97 | 96.77 |\n","|    road    | 64.54 | 74.68 |\n","+------------+-------+-------+\n","2022-05-30 22:07:14,335 - mmseg - INFO - Summary:\n","2022-05-30 22:07:14,337 - mmseg - INFO - \n","+------+-------+-------+\n","| aAcc |  mIoU |  mAcc |\n","+------+-------+-------+\n","| 93.0 | 78.26 | 85.72 |\n","+------+-------+-------+\n","2022-05-30 22:07:14,340 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9300, mIoU: 0.7826, mAcc: 0.8572, IoU.background: 0.9197, IoU.road: 0.6454, Acc.background: 0.9677, Acc.road: 0.7468\n","2022-05-30 22:07:54,299 - mmseg - INFO - Iter [15100/20000]\tlr: 1.470e-05, eta: 0:55:26, time: 2.928, data_time: 2.535, memory: 3324, decode.loss_ce: 0.1516, decode.loss_dice: 0.0900, decode.acc_seg: 93.5567, loss: 0.2415\n","2022-05-30 22:08:36,400 - mmseg - INFO - Iter [15200/20000]\tlr: 1.440e-05, eta: 0:54:10, time: 0.421, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1537, decode.loss_dice: 0.0847, decode.acc_seg: 93.6190, loss: 0.2384\n","2022-05-30 22:09:16,461 - mmseg - INFO - Iter [15300/20000]\tlr: 1.410e-05, eta: 0:52:54, time: 0.401, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1399, decode.loss_dice: 0.0797, decode.acc_seg: 94.1763, loss: 0.2196\n","2022-05-30 22:09:56,523 - mmseg - INFO - Iter [15400/20000]\tlr: 1.380e-05, eta: 0:51:38, time: 0.401, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1330, decode.loss_dice: 0.0735, decode.acc_seg: 94.3878, loss: 0.2065\n","2022-05-30 22:10:36,365 - mmseg - INFO - Iter [15500/20000]\tlr: 1.350e-05, eta: 0:50:23, time: 0.398, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1473, decode.loss_dice: 0.0936, decode.acc_seg: 93.7729, loss: 0.2409\n","2022-05-30 22:11:16,241 - mmseg - INFO - Iter [15600/20000]\tlr: 1.320e-05, eta: 0:49:08, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1524, decode.loss_dice: 0.0905, decode.acc_seg: 93.6343, loss: 0.2430\n","2022-05-30 22:11:56,126 - mmseg - INFO - Iter [15700/20000]\tlr: 1.290e-05, eta: 0:47:54, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1480, decode.loss_dice: 0.0909, decode.acc_seg: 93.8503, loss: 0.2390\n","2022-05-30 22:12:38,169 - mmseg - INFO - Iter [15800/20000]\tlr: 1.260e-05, eta: 0:46:40, time: 0.420, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1482, decode.loss_dice: 0.0856, decode.acc_seg: 93.8538, loss: 0.2338\n","2022-05-30 22:13:18,134 - mmseg - INFO - Iter [15900/20000]\tlr: 1.230e-05, eta: 0:45:27, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1428, decode.loss_dice: 0.0880, decode.acc_seg: 94.1052, loss: 0.2308\n","2022-05-30 22:13:58,149 - mmseg - INFO - Saving checkpoint at 16000 iterations\n","2022-05-30 22:14:16,779 - mmseg - INFO - Iter [16000/20000]\tlr: 1.200e-05, eta: 0:44:18, time: 0.586, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1493, decode.loss_dice: 0.0802, decode.acc_seg: 93.7118, loss: 0.2296\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 254s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 22:18:30,753 - mmseg - INFO - per class results:\n","2022-05-30 22:18:30,755 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.84 | 95.65 |\n","|    road    |  65.9 | 79.83 |\n","+------------+-------+-------+\n","2022-05-30 22:18:30,756 - mmseg - INFO - Summary:\n","2022-05-30 22:18:30,758 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.95 | 78.87 | 87.74 |\n","+-------+-------+-------+\n","2022-05-30 22:18:30,760 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9295, mIoU: 0.7887, mAcc: 0.8774, IoU.background: 0.9184, IoU.road: 0.6590, Acc.background: 0.9565, Acc.road: 0.7983\n","2022-05-30 22:19:10,824 - mmseg - INFO - Iter [16100/20000]\tlr: 1.170e-05, eta: 0:44:07, time: 2.940, data_time: 2.547, memory: 3324, decode.loss_ce: 0.1343, decode.loss_dice: 0.0869, decode.acc_seg: 94.3621, loss: 0.2212\n","2022-05-30 22:19:50,913 - mmseg - INFO - Iter [16200/20000]\tlr: 1.140e-05, eta: 0:42:52, time: 0.401, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1531, decode.loss_dice: 0.0901, decode.acc_seg: 93.6872, loss: 0.2432\n","2022-05-30 22:20:32,983 - mmseg - INFO - Iter [16300/20000]\tlr: 1.110e-05, eta: 0:41:39, time: 0.421, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1528, decode.loss_dice: 0.0850, decode.acc_seg: 93.4909, loss: 0.2377\n","2022-05-30 22:21:12,902 - mmseg - INFO - Iter [16400/20000]\tlr: 1.080e-05, eta: 0:40:25, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1404, decode.loss_dice: 0.0896, decode.acc_seg: 94.0805, loss: 0.2300\n","2022-05-30 22:21:52,502 - mmseg - INFO - Iter [16500/20000]\tlr: 1.050e-05, eta: 0:39:12, time: 0.396, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1424, decode.loss_dice: 0.0869, decode.acc_seg: 93.9836, loss: 0.2293\n","2022-05-30 22:22:32,093 - mmseg - INFO - Iter [16600/20000]\tlr: 1.020e-05, eta: 0:37:59, time: 0.396, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1465, decode.loss_dice: 0.0857, decode.acc_seg: 93.8848, loss: 0.2322\n","2022-05-30 22:23:11,473 - mmseg - INFO - Iter [16700/20000]\tlr: 9.903e-06, eta: 0:36:47, time: 0.394, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1462, decode.loss_dice: 0.0888, decode.acc_seg: 93.8129, loss: 0.2350\n","2022-05-30 22:23:51,060 - mmseg - INFO - Iter [16800/20000]\tlr: 9.603e-06, eta: 0:35:35, time: 0.396, data_time: 0.006, memory: 3324, decode.loss_ce: 0.1375, decode.loss_dice: 0.0783, decode.acc_seg: 94.2661, loss: 0.2157\n","2022-05-30 22:24:32,703 - mmseg - INFO - Iter [16900/20000]\tlr: 9.303e-06, eta: 0:34:23, time: 0.416, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1449, decode.loss_dice: 0.0883, decode.acc_seg: 93.9554, loss: 0.2331\n","2022-05-30 22:25:12,198 - mmseg - INFO - Saving checkpoint at 17000 iterations\n","2022-05-30 22:25:28,315 - mmseg - INFO - Iter [17000/20000]\tlr: 9.003e-06, eta: 0:33:15, time: 0.556, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1387, decode.loss_dice: 0.0791, decode.acc_seg: 94.2126, loss: 0.2179\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 22:29:41,330 - mmseg - INFO - per class results:\n","2022-05-30 22:29:41,333 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.12 | 96.92 |\n","|    road    | 64.96 |  74.7 |\n","+------------+-------+-------+\n","2022-05-30 22:29:41,334 - mmseg - INFO - Summary:\n","2022-05-30 22:29:41,337 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.12 | 78.54 | 85.81 |\n","+-------+-------+-------+\n","2022-05-30 22:29:41,339 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9312, mIoU: 0.7854, mAcc: 0.8581, IoU.background: 0.9212, IoU.road: 0.6496, Acc.background: 0.9692, Acc.road: 0.7470\n","2022-05-30 22:30:21,436 - mmseg - INFO - Iter [17100/20000]\tlr: 8.703e-06, eta: 0:32:47, time: 2.931, data_time: 2.537, memory: 3324, decode.loss_ce: 0.1413, decode.loss_dice: 0.0801, decode.acc_seg: 94.1056, loss: 0.2215\n","2022-05-30 22:31:01,328 - mmseg - INFO - Iter [17200/20000]\tlr: 8.403e-06, eta: 0:31:34, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1434, decode.loss_dice: 0.0830, decode.acc_seg: 94.0362, loss: 0.2264\n","2022-05-30 22:31:41,421 - mmseg - INFO - Iter [17300/20000]\tlr: 8.103e-06, eta: 0:30:22, time: 0.401, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1365, decode.loss_dice: 0.0842, decode.acc_seg: 94.3229, loss: 0.2207\n","2022-05-30 22:32:23,525 - mmseg - INFO - Iter [17400/20000]\tlr: 7.803e-06, eta: 0:29:11, time: 0.421, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1565, decode.loss_dice: 0.0985, decode.acc_seg: 93.4918, loss: 0.2550\n","2022-05-30 22:33:03,797 - mmseg - INFO - Iter [17500/20000]\tlr: 7.503e-06, eta: 0:28:00, time: 0.403, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1354, decode.loss_dice: 0.0760, decode.acc_seg: 94.3498, loss: 0.2115\n","2022-05-30 22:33:44,169 - mmseg - INFO - Iter [17600/20000]\tlr: 7.203e-06, eta: 0:26:49, time: 0.404, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1445, decode.loss_dice: 0.0876, decode.acc_seg: 93.8612, loss: 0.2320\n","2022-05-30 22:34:24,489 - mmseg - INFO - Iter [17700/20000]\tlr: 6.903e-06, eta: 0:25:38, time: 0.403, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1377, decode.loss_dice: 0.0799, decode.acc_seg: 94.2287, loss: 0.2176\n","2022-05-30 22:35:04,836 - mmseg - INFO - Iter [17800/20000]\tlr: 6.603e-06, eta: 0:24:28, time: 0.403, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1425, decode.loss_dice: 0.0844, decode.acc_seg: 94.0970, loss: 0.2270\n","2022-05-30 22:35:47,518 - mmseg - INFO - Iter [17900/20000]\tlr: 6.303e-06, eta: 0:23:19, time: 0.427, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1332, decode.loss_dice: 0.0781, decode.acc_seg: 94.4415, loss: 0.2113\n","2022-05-30 22:36:27,836 - mmseg - INFO - Saving checkpoint at 18000 iterations\n","2022-05-30 22:36:43,529 - mmseg - INFO - Iter [18000/20000]\tlr: 6.003e-06, eta: 0:22:11, time: 0.560, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1362, decode.loss_dice: 0.0756, decode.acc_seg: 94.3023, loss: 0.2118\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 22:40:56,507 - mmseg - INFO - per class results:\n","2022-05-30 22:40:56,509 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.07 | 96.42 |\n","|    road    | 65.63 | 77.06 |\n","+------------+-------+-------+\n","2022-05-30 22:40:56,514 - mmseg - INFO - Summary:\n","2022-05-30 22:40:56,517 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.11 | 78.85 | 86.74 |\n","+-------+-------+-------+\n","2022-05-30 22:40:56,519 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9311, mIoU: 0.7885, mAcc: 0.8674, IoU.background: 0.9207, IoU.road: 0.6563, Acc.background: 0.9642, Acc.road: 0.7706\n","2022-05-30 22:41:36,509 - mmseg - INFO - Iter [18100/20000]\tlr: 5.703e-06, eta: 0:21:28, time: 2.930, data_time: 2.537, memory: 3324, decode.loss_ce: 0.1434, decode.loss_dice: 0.0915, decode.acc_seg: 94.0291, loss: 0.2349\n","2022-05-30 22:42:16,532 - mmseg - INFO - Iter [18200/20000]\tlr: 5.403e-06, eta: 0:20:17, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1430, decode.loss_dice: 0.0840, decode.acc_seg: 93.9784, loss: 0.2270\n","2022-05-30 22:42:56,561 - mmseg - INFO - Iter [18300/20000]\tlr: 5.103e-06, eta: 0:19:07, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1364, decode.loss_dice: 0.0814, decode.acc_seg: 94.2799, loss: 0.2178\n","2022-05-30 22:43:36,546 - mmseg - INFO - Iter [18400/20000]\tlr: 4.803e-06, eta: 0:17:57, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1320, decode.loss_dice: 0.0882, decode.acc_seg: 94.3910, loss: 0.2202\n","2022-05-30 22:44:18,628 - mmseg - INFO - Iter [18500/20000]\tlr: 4.503e-06, eta: 0:16:48, time: 0.421, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1437, decode.loss_dice: 0.0889, decode.acc_seg: 94.0651, loss: 0.2326\n","2022-05-30 22:44:58,642 - mmseg - INFO - Iter [18600/20000]\tlr: 4.203e-06, eta: 0:15:39, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1423, decode.loss_dice: 0.0955, decode.acc_seg: 93.9726, loss: 0.2378\n","2022-05-30 22:45:38,588 - mmseg - INFO - Iter [18700/20000]\tlr: 3.903e-06, eta: 0:14:30, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1408, decode.loss_dice: 0.0789, decode.acc_seg: 94.1054, loss: 0.2197\n","2022-05-30 22:46:18,624 - mmseg - INFO - Iter [18800/20000]\tlr: 3.603e-06, eta: 0:13:21, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1417, decode.loss_dice: 0.0899, decode.acc_seg: 94.0182, loss: 0.2316\n","2022-05-30 22:46:58,709 - mmseg - INFO - Iter [18900/20000]\tlr: 3.303e-06, eta: 0:12:13, time: 0.401, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1456, decode.loss_dice: 0.0843, decode.acc_seg: 93.8036, loss: 0.2299\n","2022-05-30 22:47:40,729 - mmseg - INFO - Saving checkpoint at 19000 iterations\n","2022-05-30 22:47:56,201 - mmseg - INFO - Iter [19000/20000]\tlr: 3.003e-06, eta: 0:11:06, time: 0.575, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1415, decode.loss_dice: 0.0792, decode.acc_seg: 94.0450, loss: 0.2207\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 22:52:09,267 - mmseg - INFO - per class results:\n","2022-05-30 22:52:09,269 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.09 | 96.53 |\n","|    road    | 65.53 | 76.59 |\n","+------------+-------+-------+\n","2022-05-30 22:52:09,271 - mmseg - INFO - Summary:\n","2022-05-30 22:52:09,273 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.12 | 78.81 | 86.56 |\n","+-------+-------+-------+\n","2022-05-30 22:52:09,278 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9312, mIoU: 0.7881, mAcc: 0.8656, IoU.background: 0.9209, IoU.road: 0.6553, Acc.background: 0.9653, Acc.road: 0.7659\n","2022-05-30 22:52:49,244 - mmseg - INFO - Iter [19100/20000]\tlr: 2.703e-06, eta: 0:10:10, time: 2.930, data_time: 2.538, memory: 3324, decode.loss_ce: 0.1439, decode.loss_dice: 0.0837, decode.acc_seg: 94.0362, loss: 0.2275\n","2022-05-30 22:53:29,220 - mmseg - INFO - Iter [19200/20000]\tlr: 2.403e-06, eta: 0:09:01, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1433, decode.loss_dice: 0.0832, decode.acc_seg: 93.9315, loss: 0.2264\n","2022-05-30 22:54:09,100 - mmseg - INFO - Iter [19300/20000]\tlr: 2.103e-06, eta: 0:07:52, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1312, decode.loss_dice: 0.0774, decode.acc_seg: 94.4931, loss: 0.2086\n","2022-05-30 22:54:49,081 - mmseg - INFO - Iter [19400/20000]\tlr: 1.803e-06, eta: 0:06:44, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1341, decode.loss_dice: 0.0773, decode.acc_seg: 94.4471, loss: 0.2114\n","2022-05-30 22:55:29,283 - mmseg - INFO - Iter [19500/20000]\tlr: 1.503e-06, eta: 0:05:36, time: 0.402, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1373, decode.loss_dice: 0.0791, decode.acc_seg: 94.2770, loss: 0.2163\n","2022-05-30 22:56:11,357 - mmseg - INFO - Iter [19600/20000]\tlr: 1.203e-06, eta: 0:04:28, time: 0.421, data_time: 0.028, memory: 3324, decode.loss_ce: 0.1349, decode.loss_dice: 0.0802, decode.acc_seg: 94.3224, loss: 0.2151\n","2022-05-30 22:56:51,266 - mmseg - INFO - Iter [19700/20000]\tlr: 9.030e-07, eta: 0:03:20, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1549, decode.loss_dice: 0.0881, decode.acc_seg: 93.3918, loss: 0.2429\n","2022-05-30 22:57:31,304 - mmseg - INFO - Iter [19800/20000]\tlr: 6.030e-07, eta: 0:02:13, time: 0.400, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1489, decode.loss_dice: 0.0850, decode.acc_seg: 93.8577, loss: 0.2339\n","2022-05-30 22:58:11,189 - mmseg - INFO - Iter [19900/20000]\tlr: 3.030e-07, eta: 0:01:06, time: 0.399, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1354, decode.loss_dice: 0.0807, decode.acc_seg: 94.2880, loss: 0.2162\n","2022-05-30 22:58:51,137 - mmseg - INFO - Saving checkpoint at 20000 iterations\n","2022-05-30 22:59:06,614 - mmseg - INFO - Iter [20000/20000]\tlr: 3.000e-09, eta: 0:00:00, time: 0.554, data_time: 0.007, memory: 3324, decode.loss_ce: 0.1371, decode.loss_dice: 0.0805, decode.acc_seg: 94.2290, loss: 0.2176\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.3 task/s, elapsed: 253s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 23:03:19,512 - mmseg - INFO - per class results:\n","2022-05-30 23:03:19,514 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.16 | 97.01 |\n","|    road    | 64.99 | 74.45 |\n","+------------+-------+-------+\n","2022-05-30 23:03:19,515 - mmseg - INFO - Summary:\n","2022-05-30 23:03:19,517 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.16 | 78.58 | 85.73 |\n","+-------+-------+-------+\n","2022-05-30 23:03:19,519 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9316, mIoU: 0.7858, mAcc: 0.8573, IoU.background: 0.9216, IoU.road: 0.6499, Acc.background: 0.9701, Acc.road: 0.7445\n"]}],"source":["from mmseg.datasets import build_dataset\n","from mmseg.models import build_segmentor\n","from mmseg.apis import train_segmentor\n","\n","# Build the dataset\n","datasets = [build_dataset(cfg.data.train)]\n","\n","# Build the detector\n","model = build_segmentor(\n","    cfg.model, train_cfg=cfg.get('train_cfg'), test_cfg=cfg.get('test_cfg'))\n","\n","# Add an attribute for visualization convenience\n","model.CLASSES = datasets[0].CLASSES\n","\n","# Create work_dir\n","mmcv.mkdir_or_exist(osp.abspath(cfg.work_dir))\n","train_segmentor(model, datasets, cfg, distributed=False, validate=True,\n","                meta=dict(CLASSES=classes, PALETTE=palette))"]},{"cell_type":"markdown","source":["### 모델 결과 시각화"],"metadata":{"id":"Pre69QNK_dwU"}},{"cell_type":"code","source":["img_result = ['BLD00002_PS3_K3A_NIA0276.png',\n","              'BLD00010_PS3_K3A_NIA0276.png',\n","              'BLD00047_PS3_K3A_NIA0276.png',\n","              'BLD12071_PS3_K3A_NIA0391.png',\n","              'BLD11907_PS3_K3A_NIA0391.png',\n","              'BLD11611_PS3_K3A_NIA0390.png',\n","              'BLD11474_PS3_K3A_NIA0390.png',\n","              'BLD10413_PS3_K3A_NIA0388.png',\n","              'BLD10150_PS3_K3A_NIA0388.png',\n","              'BLD00836_PS3_K3A_NIA0277.png']\n","\n","checkpoint_file = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2/iter_20000.pth'  #학습된 모델\n","\n","\n","# checkpoint 저장된 model 파일을 이용하여 모델을 생성, 이때 Config는 위에서 update된 config 사용. \n","model_ckpt = init_segmentor(cfg, checkpoint_file, device='cuda:0')  #cuda gpu 사용\n","\n","for ir in range(len(img_result)):\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+img_result[ir])\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)\n"],"metadata":{"id":"v2VyaZksCGEP","colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1ztZM9aKhxLtc2lbS02EUw3vfPdUS2nQj"},"executionInfo":{"status":"ok","timestamp":1653951856029,"user_tz":-540,"elapsed":55095,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"outputId":"0701220f-b937-4586-fe9d-fa2060c1dd5a"},"execution_count":17,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]},{"cell_type":"code","source":["import os\n","file_list = os.listdir('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val')\n","test_png = []\n","for i in file_list:\n","  if '.png' in i:\n","    test_png.append(i)\n","\n","for j in test_png:\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+j)\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)"],"metadata":{"id":"MGL7wC0QE_Lp","colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1P2LyQLl97D0xn_OGMvFQaEm4uA55CNJB"},"executionInfo":{"status":"ok","timestamp":1653952461523,"user_tz":-540,"elapsed":605523,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"outputId":"3832070f-b088-4610-ad46-ca7e5deab2b3"},"execution_count":18,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"machine_shape":"hm","name":"Segformer_road_512x512_iter_20k_loss_ce.ipynb의 사본","provenance":[{"file_id":"1-tUNSqxwGyamS6a3CkRHoXF5GMszfber","timestamp":1652320453219}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}