{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":164251,"status":"ok","timestamp":1653914802622,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"nllMQ6RCsenv","outputId":"f3ed4888-77af-49d0-c883-33a041075eee"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11926,"status":"ok","timestamp":1653914814535,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"PPb5e_glt9i6","outputId":"a9a1c261-2ffb-430c-f638-113e95f573b2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Looking in links: https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","Collecting mmcv-full\n","  Downloading https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/mmcv_full-1.5.2-cp37-cp37m-manylinux1_x86_64.whl (46.4 MB)\n","\u001b[K     |████████████████████████████████| 46.4 MB 8.4 MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (21.3)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (3.13)\n","Collecting yapf\n","  Downloading yapf-0.32.0-py2.py3-none-any.whl (190 kB)\n","\u001b[K     |████████████████████████████████| 190 kB 5.1 MB/s \n","\u001b[?25hRequirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (4.1.2.30)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (1.21.6)\n","Collecting addict\n","  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n","Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (7.1.2)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->mmcv-full) (3.0.9)\n","Installing collected packages: yapf, addict, mmcv-full\n","Successfully installed addict-2.4.0 mmcv-full-1.5.2 yapf-0.32.0\n","Cloning into 'mmsegmentation'...\n","remote: Enumerating objects: 7190, done.\u001b[K\n","remote: Counting objects: 100% (195/195), done.\u001b[K\n","remote: Compressing objects: 100% (158/158), done.\u001b[K\n","remote: Total 7190 (delta 51), reused 163 (delta 37), pack-reused 6995\u001b[K\n","Receiving objects: 100% (7190/7190), 13.87 MiB | 45.81 MiB/s, done.\n","Resolving deltas: 100% (5223/5223), done.\n"]}],"source":["!pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.0/index.html\n","!git clone https://github.com/open-mmlab/mmsegmentation.git"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5575,"status":"ok","timestamp":1653914820104,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"zU2hdo-iuDM_","outputId":"0f746fa2-0872-4616-d392-019014dddebb"},"outputs":[{"output_type":"stream","name":"stdout","text":["Setup complete. Using torch 1.11.0+cu113 (Tesla T4)\n"]}],"source":["import torch\n","\n","print(f\"Setup complete. Using torch {torch.__version__} ({torch.cuda.get_device_properties(0).name if torch.cuda.is_available() else 'CPU'})\")"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1653914820105,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"5Y38Lq6KuG75","outputId":"a40b8720-63bb-4bae-fc96-50e425a11ec6"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/mmsegmentation\n"]}],"source":["%cd mmsegmentation"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"scnWNR9VuKnB","executionInfo":{"status":"ok","timestamp":1653914820105,"user_tz":-540,"elapsed":19,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["from mmseg.apis import inference_segmentor, init_segmentor, show_result_pyplot\n","import mmcv"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"nZ7kLaEfuMhh","executionInfo":{"status":"ok","timestamp":1653914820106,"user_tz":-540,"elapsed":19,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["import os.path as osp\n","import numpy as np\n","from PIL import Image\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":41981,"status":"ok","timestamp":1653914862068,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"O5uVMzGxuRlJ","outputId":"d8c0ef95-ae07-442e-a40f-ce21923a27fa"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-05-30 12:46:52--  https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","Resolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28\n","Connecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 328290585 (313M) [application/octet-stream]\n","Saving to: ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’\n","\n","//content/mmsegment 100%[===================>] 313.08M  8.46MB/s    in 39s     \n","\n","2022-05-30 12:47:31 (8.12 MB/s) - ‘//content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth’ saved [328290585/328290585]\n","\n"]}],"source":["!mkdir checkpoints\n","!wget -O //content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth https://download.openmmlab.com/mmsegmentation/v0.5/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"km0JLIuRumCX","executionInfo":{"status":"ok","timestamp":1653914862069,"user_tz":-540,"elapsed":13,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["from mmseg.datasets.builder import DATASETS\n","from mmseg.datasets.custom import CustomDataset\n","\n","classes = ('background', 'road')\n","palette = [[0, 0, 0], [255, 255, 0]]\n","\n","@DATASETS.register_module()\n","class SIADataset(CustomDataset):\n","  CLASSES = classes\n","  PALETTE = palette\n","  def __init__(self, split, **kwargs):\n","    super().__init__(img_suffix='.png', seg_map_suffix='.png', \n","                     split=split, **kwargs)\n","    assert osp.exists(self.img_dir) and self.split is not None"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":470,"status":"ok","timestamp":1653914862527,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"Qx5ugOgwuxGW","outputId":"13ec13d7-7a72-4d0d-ea28-ca553f0c988c"},"outputs":[{"output_type":"stream","name":"stdout","text":["norm_cfg = dict(type='SyncBN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=19,\n","        norm_cfg=dict(type='SyncBN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=dict(\n","            type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0)),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'CityscapesDataset'\n","data_root = 'data/cityscapes/'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (1024, 1024)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","    dict(type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', prob=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(2048, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/train',\n","        ann_dir='gtFine/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(2048, 1024), ratio_range=(0.5, 2.0)),\n","            dict(\n","                type='RandomCrop', crop_size=(1024, 1024), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', prob=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(1024, 1024), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ]),\n","    val=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]),\n","    test=dict(\n","        type='CityscapesDataset',\n","        data_root='data/cityscapes/',\n","        img_dir='leftImg8bit/val',\n","        ann_dir='gtFine/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(2048, 1024),\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ]))\n","log_config = dict(\n","    interval=50, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = None\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=160000)\n","checkpoint_config = dict(by_epoch=False, interval=16000)\n","evaluation = dict(interval=16000, metric='mIoU', pre_eval=True)\n","\n"]}],"source":["# config 파일을 설정하고, 다운로드 받은 pretrained 모델을 checkpoint로 설정. \n","config_file = '/content/mmsegmentation/configs/segformer/segformer_mit-b5_8x1_1024x1024_160k_cityscapes.py'\n","checkpoint_file = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","from mmcv import Config\n","\n","cfg = Config.fromfile(config_file)\n","print(cfg.pretty_text)"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"caVFRT7QvWE8","executionInfo":{"status":"ok","timestamp":1653914862528,"user_tz":-540,"elapsed":19,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.norm_cfg = dict(type='BN', requires_grad=True)\n","#cfg.model.backbone.norm_cfg = cfg.norm_cfg\n","cfg.model.decode_head.norm_cfg = cfg.norm_cfg\n","\n","cfg.model.decode_head.num_classes = 2\n","\n","cfg.device='cuda'\n","\n","cfg.model.decode_head.loss_decode = dict(type='FocalLoss', loss_weight = 1.0)"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"X9IpatmxvYMt","executionInfo":{"status":"ok","timestamp":1653914862529,"user_tz":-540,"elapsed":19,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","cfg.crop_size = (512, 512)\n","cfg.train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=cfg.crop_size, cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(type='Normalize', **cfg.img_norm_cfg),\n","    dict(type='Pad', size=cfg.crop_size, pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg']),\n","]\n","\n","cfg.val_pipeline = [\n","                    dict(type='LoadImageFromFile'),\n","                    dict(\n","                        type='MultiScaleFlipAug',\n","                        img_scale=(1024, 1024),\n","                        flip=False,\n","                        transforms=[\n","                                    dict(type='Resize', keep_ratio=True),\n","                                    dict(type='RandomFlip'),\n","                                    dict(\n","                                        type='Normalize',\n","                                        mean=[123.675, 116.28, 103.53],\n","                                        std=[58.395, 57.12, 57.375],\n","                                        to_rgb=True),\n","                                    dict(type='ImageToTensor', keys=['img']),\n","                                    dict(type='Collect', keys=['img'])\n","                                    ]),\n","                    \n","]\n","\n","cfg.test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            #dict(type='ResizeToMultiple', size_divisor=32),\n","            dict(type='RandomFlip'),\n","            dict(type='Normalize', **cfg.img_norm_cfg),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img']),\n","        ])\n","]"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"_4PNB6hGvds4","executionInfo":{"status":"ok","timestamp":1653914862530,"user_tz":-540,"elapsed":20,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.dataset_type = 'SIADataset'\n","cfg.data_root = '/content/drive/MyDrive/SIA'\n","\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.train.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","\n","cfg.data.val.type = 'SIADataset'\n","cfg.data.val.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.val.img_dir = 'Data_set/road_dataset/img_dir/train'\n","cfg.data.val.ann_dir = 'Data_set/road_dataset/ann_01_dir/train'\n","cfg.data.val.pipeline = cfg.test_pipeline\n","cfg.data.val.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","\n","cfg.data.test.type = 'SIADataset'\n","cfg.data.test.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.test.img_dir = 'Data_set/road_dataset/img_dir/val'\n","cfg.data.test.ann_dir = 'Data_set/road_dataset/ann_01_dir/val'\n","cfg.data.test.pipeline = cfg.test_pipeline\n","cfg.data.test.split = '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt'"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"jXNN3BblvrfK","executionInfo":{"status":"ok","timestamp":1653914862531,"user_tz":-540,"elapsed":21,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"colab":{"base_uri":"https://localhost:8080/","height":54},"outputId":"8306d8ab-b292-47f2-b808-6da9466b84d5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["\"\\ncfg.data.train.type = 'SIADataset'\\ncfg.data.train.data_root = '/content/drive/MyDrive/SIA'\\ncfg.data.train.img_dir = 'images/up025'\\ncfg.data.train.ann_dir = 'labels'\\ncfg.data.train.pipeline = cfg.train_pipeline\\ncfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\\n\""],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":13}],"source":["'''\n","cfg.data.train.type = 'SIADataset'\n","cfg.data.train.data_root = '/content/drive/MyDrive/SIA'\n","cfg.data.train.img_dir = 'images/up025'\n","cfg.data.train.ann_dir = 'labels'\n","cfg.data.train.pipeline = cfg.train_pipeline\n","cfg.data.train.split = '/content/drive/MyDrive/SIA/splits/road/train_road.txt'\n","'''"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"l1Gc8ttSvw8e","executionInfo":{"status":"ok","timestamp":1653914862532,"user_tz":-540,"elapsed":19,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[],"source":["cfg.load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","\n","# Set up working dir to save files and logs.\n","cfg.work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1653914862533,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"},"user_tz":-540},"id":"vvSIfRurv0sm","outputId":"e49f9e0b-3173-4a5b-e749-c55b631df3bf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Config:\n","norm_cfg = dict(type='BN', requires_grad=True)\n","model = dict(\n","    type='EncoderDecoder',\n","    pretrained=None,\n","    backbone=dict(\n","        type='MixVisionTransformer',\n","        in_channels=3,\n","        embed_dims=64,\n","        num_stages=4,\n","        num_layers=[3, 6, 40, 3],\n","        num_heads=[1, 2, 5, 8],\n","        patch_sizes=[7, 3, 3, 3],\n","        sr_ratios=[8, 4, 2, 1],\n","        out_indices=(0, 1, 2, 3),\n","        mlp_ratio=4,\n","        qkv_bias=True,\n","        drop_rate=0.0,\n","        attn_drop_rate=0.0,\n","        drop_path_rate=0.1,\n","        init_cfg=dict(type='Pretrained', checkpoint='pretrain/mit_b5.pth')),\n","    decode_head=dict(\n","        type='SegformerHead',\n","        in_channels=[64, 128, 320, 512],\n","        in_index=[0, 1, 2, 3],\n","        channels=256,\n","        dropout_ratio=0.1,\n","        num_classes=2,\n","        norm_cfg=dict(type='BN', requires_grad=True),\n","        align_corners=False,\n","        loss_decode=dict(type='FocalLoss', loss_weight=1.0)),\n","    train_cfg=dict(),\n","    test_cfg=dict(mode='slide', crop_size=(1024, 1024), stride=(768, 768)))\n","dataset_type = 'SIADataset'\n","data_root = '/content/drive/MyDrive/SIA'\n","img_norm_cfg = dict(\n","    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)\n","crop_size = (512, 512)\n","train_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(type='LoadAnnotations'),\n","    dict(type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","    dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","    dict(type='RandomFlip', flip_ratio=0.5),\n","    dict(type='PhotoMetricDistortion'),\n","    dict(\n","        type='Normalize',\n","        mean=[123.675, 116.28, 103.53],\n","        std=[58.395, 57.12, 57.375],\n","        to_rgb=True),\n","    dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","    dict(type='DefaultFormatBundle'),\n","    dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","]\n","test_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","data = dict(\n","    samples_per_gpu=1,\n","    workers_per_gpu=1,\n","    train=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(type='LoadAnnotations'),\n","            dict(\n","                type='Resize', img_scale=(1024, 1024), ratio_range=(0.5, 1.5)),\n","            dict(type='RandomCrop', crop_size=(512, 512), cat_max_ratio=0.75),\n","            dict(type='RandomFlip', flip_ratio=0.5),\n","            dict(type='PhotoMetricDistortion'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='Pad', size=(512, 512), pad_val=0, seg_pad_val=255),\n","            dict(type='DefaultFormatBundle'),\n","            dict(type='Collect', keys=['img', 'gt_semantic_seg'])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_train_road.txt'\n","    ),\n","    val=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/train',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/train',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/train/up_val_road.txt'\n","    ),\n","    test=dict(\n","        type='SIADataset',\n","        data_root='/content/drive/MyDrive/SIA',\n","        img_dir='Data_set/road_dataset/img_dir/val',\n","        ann_dir='Data_set/road_dataset/ann_01_dir/val',\n","        pipeline=[\n","            dict(type='LoadImageFromFile'),\n","            dict(\n","                type='MultiScaleFlipAug',\n","                img_scale=(1024, 1024),\n","                img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],\n","                flip=False,\n","                transforms=[\n","                    dict(type='Resize', keep_ratio=True),\n","                    dict(type='RandomFlip'),\n","                    dict(\n","                        type='Normalize',\n","                        mean=[123.675, 116.28, 103.53],\n","                        std=[58.395, 57.12, 57.375],\n","                        to_rgb=True),\n","                    dict(type='ImageToTensor', keys=['img']),\n","                    dict(type='Collect', keys=['img'])\n","                ])\n","        ],\n","        split=\n","        '/content/drive/MyDrive/SIA/Data_set/road_dataset/mask_dir/val/up.txt')\n",")\n","log_config = dict(\n","    interval=100, hooks=[dict(type='TextLoggerHook', by_epoch=False)])\n","dist_params = dict(backend='nccl')\n","log_level = 'INFO'\n","load_from = '/content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth'\n","resume_from = None\n","workflow = [('train', 1)]\n","cudnn_benchmark = True\n","optimizer = dict(\n","    type='AdamW',\n","    lr=6e-05,\n","    betas=(0.9, 0.999),\n","    weight_decay=0.01,\n","    paramwise_cfg=dict(\n","        custom_keys=dict(\n","            pos_block=dict(decay_mult=0.0),\n","            norm=dict(decay_mult=0.0),\n","            head=dict(lr_mult=10.0))))\n","optimizer_config = dict()\n","lr_config = dict(\n","    policy='poly',\n","    warmup='linear',\n","    warmup_iters=1500,\n","    warmup_ratio=1e-06,\n","    power=1.0,\n","    min_lr=0.0,\n","    by_epoch=False)\n","runner = dict(type='IterBasedRunner', max_iters=20000)\n","checkpoint_config = dict(by_epoch=False, interval=1000)\n","evaluation = dict(interval=1000, metric='mIoU', pre_eval=True)\n","device = 'cuda'\n","val_pipeline = [\n","    dict(type='LoadImageFromFile'),\n","    dict(\n","        type='MultiScaleFlipAug',\n","        img_scale=(1024, 1024),\n","        flip=False,\n","        transforms=[\n","            dict(type='Resize', keep_ratio=True),\n","            dict(type='RandomFlip'),\n","            dict(\n","                type='Normalize',\n","                mean=[123.675, 116.28, 103.53],\n","                std=[58.395, 57.12, 57.375],\n","                to_rgb=True),\n","            dict(type='ImageToTensor', keys=['img']),\n","            dict(type='Collect', keys=['img'])\n","        ])\n","]\n","work_dir = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2'\n","seed = 0\n","gpu_ids = range(0, 1)\n","\n"]}],"source":["cfg.runner.max_iteTrs = 200\n","cfg.log_config.interval = 100\n","cfg.evaluation.interval = 1000  # 모델 학습시 평가를 몇 번째 iteration마다 할 것인지 지정\n","cfg.checkpoint_config.interval = 1000  # 모델 학습시 학습한 모델을 몇 번째 iteration마다 저장할 것인지 지정\n","\n","cfg.runner = dict(type='IterBasedRunner', max_iters=20000)  # Iteration으로 동작, Epoch로 동작하게 변경할 수도 있음\n","# cfg.runner = dict(type='EpochBasedRunner', max_epochs=4000)  # Epoch로 변경\n","cfg.workflow = [('train', 1)]\n","\n","# Set seed to facitate reproducing the result\n","cfg.seed = 0\n","#set_random_seed(0, deterministic=False)\n","cfg.gpu_ids = range(1)\n","\n","# Let's have a look at the final config used for training\n","print(f'Config:\\n{cfg.pretty_text}')"]},{"cell_type":"markdown","source":["### 모델 학습"],"metadata":{"id":"xP_db_FP_lnS"}},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8IlH2WxNwFFW","outputId":"fb093d07-3e28-456c-b6d7-2a3a866590f3","executionInfo":{"status":"ok","timestamp":1653932201064,"user_tz":-540,"elapsed":17338546,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["2022-05-30 12:47:34,496 - mmseg - INFO - Loaded 542 images\n","2022-05-30 12:47:48,189 - mmseg - INFO - Loaded 66 images\n","2022-05-30 12:47:48,193 - mmseg - INFO - load checkpoint from local path: /content/mmsegmentation/checkpoints/segformer_mit-b5_8x1_1024x1024_160k_cityscapes_20211206_072934-87a052ec.pth\n","2022-05-30 12:47:48,636 - mmseg - WARNING - The model and loaded state dict do not match exactly\n","\n","size mismatch for decode_head.conv_seg.weight: copying a param with shape torch.Size([19, 256, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 256, 1, 1]).\n","size mismatch for decode_head.conv_seg.bias: copying a param with shape torch.Size([19]) from checkpoint, the shape in current model is torch.Size([2]).\n","2022-05-30 12:47:48,642 - mmseg - INFO - Start running, host: root@97916f42166d, work_dir: /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2\n","2022-05-30 12:47:48,643 - mmseg - INFO - Hooks will be executed in the following order:\n","before_run:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_epoch:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_train_iter:\n","(VERY_HIGH   ) PolyLrUpdaterHook                  \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n"," -------------------- \n","after_train_iter:\n","(ABOVE_NORMAL) OptimizerHook                      \n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) IterTimerHook                      \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_train_epoch:\n","(NORMAL      ) CheckpointHook                     \n","(LOW         ) EvalHook                           \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_epoch:\n","(LOW         ) IterTimerHook                      \n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","before_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_iter:\n","(LOW         ) IterTimerHook                      \n"," -------------------- \n","after_val_epoch:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","after_run:\n","(VERY_LOW    ) TextLoggerHook                     \n"," -------------------- \n","2022-05-30 12:47:48,645 - mmseg - INFO - workflow: [('train', 1)], max: 20000 iters\n","2022-05-30 12:47:48,647 - mmseg - INFO - Checkpoints will be saved to /content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2 by HardDiskBackend.\n","2022-05-30 12:48:37,502 - mmseg - INFO - Iter [100/20000]\tlr: 3.940e-06, eta: 2:40:41, time: 0.484, data_time: 0.100, memory: 3323, decode.loss_focal: 0.0999, decode.acc_seg: 51.0428, loss: 0.0999\n","2022-05-30 12:49:18,758 - mmseg - INFO - Iter [200/20000]\tlr: 7.881e-06, eta: 2:28:00, time: 0.413, data_time: 0.025, memory: 3323, decode.loss_focal: 0.0679, decode.acc_seg: 77.4243, loss: 0.0679\n","2022-05-30 12:50:00,178 - mmseg - INFO - Iter [300/20000]\tlr: 1.178e-05, eta: 2:23:30, time: 0.414, data_time: 0.019, memory: 3323, decode.loss_focal: 0.0510, decode.acc_seg: 84.9451, loss: 0.0510\n","2022-05-30 12:50:42,410 - mmseg - INFO - Iter [400/20000]\tlr: 1.564e-05, eta: 2:21:34, time: 0.422, data_time: 0.032, memory: 3323, decode.loss_focal: 0.0431, decode.acc_seg: 87.2330, loss: 0.0431\n","2022-05-30 12:51:23,944 - mmseg - INFO - Iter [500/20000]\tlr: 1.946e-05, eta: 2:19:40, time: 0.415, data_time: 0.025, memory: 3323, decode.loss_focal: 0.0394, decode.acc_seg: 88.3550, loss: 0.0394\n","2022-05-30 12:52:06,310 - mmseg - INFO - Iter [600/20000]\tlr: 2.324e-05, eta: 2:18:37, time: 0.424, data_time: 0.035, memory: 3323, decode.loss_focal: 0.0367, decode.acc_seg: 89.0259, loss: 0.0367\n","2022-05-30 12:52:45,775 - mmseg - INFO - Iter [700/20000]\tlr: 2.698e-05, eta: 2:16:20, time: 0.395, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0381, decode.acc_seg: 88.6252, loss: 0.0381\n","2022-05-30 12:53:25,225 - mmseg - INFO - Iter [800/20000]\tlr: 3.068e-05, eta: 2:14:27, time: 0.394, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0347, decode.acc_seg: 89.5644, loss: 0.0347\n","2022-05-30 12:54:04,735 - mmseg - INFO - Iter [900/20000]\tlr: 3.434e-05, eta: 2:12:52, time: 0.395, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0399, decode.acc_seg: 87.9581, loss: 0.0399\n","2022-05-30 12:54:44,101 - mmseg - INFO - Saving checkpoint at 1000 iterations\n","2022-05-30 12:54:50,654 - mmseg - INFO - Iter [1000/20000]\tlr: 3.796e-05, eta: 2:13:30, time: 0.459, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0375, decode.acc_seg: 88.7179, loss: 0.0375\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 462s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 13:02:32,777 - mmseg - INFO - per class results:\n","2022-05-30 13:02:32,780 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 90.38 | 96.02 |\n","|    road    | 58.38 | 69.67 |\n","+------------+-------+-------+\n","2022-05-30 13:02:32,781 - mmseg - INFO - Summary:\n","2022-05-30 13:02:32,785 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 91.52 | 74.38 | 82.84 |\n","+-------+-------+-------+\n","2022-05-30 13:02:32,787 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9152, mIoU: 0.7438, mAcc: 0.8284, IoU.background: 0.9038, IoU.road: 0.5838, Acc.background: 0.9602, Acc.road: 0.6967\n","2022-05-30 13:03:14,642 - mmseg - INFO - Iter [1100/20000]\tlr: 4.154e-05, eta: 4:25:03, time: 5.040, data_time: 4.651, memory: 3323, decode.loss_focal: 0.0332, decode.acc_seg: 89.6763, loss: 0.0332\n","2022-05-30 13:03:54,003 - mmseg - INFO - Iter [1200/20000]\tlr: 4.508e-05, eta: 4:11:57, time: 0.394, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0339, decode.acc_seg: 90.0182, loss: 0.0339\n","2022-05-30 13:04:33,390 - mmseg - INFO - Iter [1300/20000]\tlr: 4.859e-05, eta: 4:00:46, time: 0.394, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0341, decode.acc_seg: 89.7807, loss: 0.0341\n","2022-05-30 13:05:13,183 - mmseg - INFO - Iter [1400/20000]\tlr: 5.205e-05, eta: 3:51:11, time: 0.398, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0321, decode.acc_seg: 90.3874, loss: 0.0321\n","2022-05-30 13:05:53,019 - mmseg - INFO - Iter [1500/20000]\tlr: 5.547e-05, eta: 3:42:48, time: 0.398, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0342, decode.acc_seg: 89.8035, loss: 0.0342\n","2022-05-30 13:06:32,813 - mmseg - INFO - Iter [1600/20000]\tlr: 5.520e-05, eta: 3:35:23, time: 0.398, data_time: 0.010, memory: 3323, decode.loss_focal: 0.0331, decode.acc_seg: 90.0838, loss: 0.0331\n","2022-05-30 13:07:14,684 - mmseg - INFO - Iter [1700/20000]\tlr: 5.490e-05, eta: 3:29:07, time: 0.419, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0303, decode.acc_seg: 90.8896, loss: 0.0303\n","2022-05-30 13:07:54,916 - mmseg - INFO - Iter [1800/20000]\tlr: 5.460e-05, eta: 3:23:12, time: 0.402, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0335, decode.acc_seg: 90.1953, loss: 0.0335\n","2022-05-30 13:08:34,751 - mmseg - INFO - Iter [1900/20000]\tlr: 5.430e-05, eta: 3:17:46, time: 0.398, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0295, decode.acc_seg: 91.0649, loss: 0.0295\n","2022-05-30 13:09:13,963 - mmseg - INFO - Saving checkpoint at 2000 iterations\n","2022-05-30 13:09:21,002 - mmseg - INFO - Iter [2000/20000]\tlr: 5.400e-05, eta: 3:13:47, time: 0.462, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0322, decode.acc_seg: 90.1139, loss: 0.0322\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 450s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 13:16:51,630 - mmseg - INFO - per class results:\n","2022-05-30 13:16:51,631 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 90.46 | 95.91 |\n","|    road    |  59.0 | 70.72 |\n","+------------+-------+-------+\n","2022-05-30 13:16:51,633 - mmseg - INFO - Summary:\n","2022-05-30 13:16:51,634 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 91.61 | 74.73 | 83.31 |\n","+-------+-------+-------+\n","2022-05-30 13:16:51,640 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9161, mIoU: 0.7473, mAcc: 0.8331, IoU.background: 0.9046, IoU.road: 0.5900, Acc.background: 0.9591, Acc.road: 0.7072\n","2022-05-30 13:17:31,031 - mmseg - INFO - Iter [2100/20000]\tlr: 5.370e-05, eta: 4:13:09, time: 4.900, data_time: 4.516, memory: 3323, decode.loss_focal: 0.0310, decode.acc_seg: 90.5423, loss: 0.0310\n","2022-05-30 13:18:12,433 - mmseg - INFO - Iter [2200/20000]\tlr: 5.340e-05, eta: 4:05:52, time: 0.414, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0314, decode.acc_seg: 90.6358, loss: 0.0314\n","2022-05-30 13:18:51,711 - mmseg - INFO - Iter [2300/20000]\tlr: 5.310e-05, eta: 3:58:54, time: 0.393, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0310, decode.acc_seg: 90.6538, loss: 0.0310\n","2022-05-30 13:19:30,934 - mmseg - INFO - Iter [2400/20000]\tlr: 5.280e-05, eta: 3:52:26, time: 0.392, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0288, decode.acc_seg: 91.2933, loss: 0.0288\n","2022-05-30 13:20:10,137 - mmseg - INFO - Iter [2500/20000]\tlr: 5.250e-05, eta: 3:46:27, time: 0.392, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0282, decode.acc_seg: 91.3270, loss: 0.0282\n","2022-05-30 13:20:48,986 - mmseg - INFO - Iter [2600/20000]\tlr: 5.220e-05, eta: 3:40:50, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0291, decode.acc_seg: 91.0186, loss: 0.0291\n","2022-05-30 13:21:27,891 - mmseg - INFO - Iter [2700/20000]\tlr: 5.190e-05, eta: 3:35:35, time: 0.389, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0344, decode.acc_seg: 89.3675, loss: 0.0344\n","2022-05-30 13:22:08,900 - mmseg - INFO - Iter [2800/20000]\tlr: 5.160e-05, eta: 3:30:53, time: 0.410, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0302, decode.acc_seg: 90.8247, loss: 0.0302\n","2022-05-30 13:22:47,906 - mmseg - INFO - Iter [2900/20000]\tlr: 5.130e-05, eta: 3:26:15, time: 0.390, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0249, decode.acc_seg: 92.5167, loss: 0.0249\n","2022-05-30 13:23:26,880 - mmseg - INFO - Saving checkpoint at 3000 iterations\n","2022-05-30 13:23:32,143 - mmseg - INFO - Iter [3000/20000]\tlr: 5.100e-05, eta: 3:22:24, time: 0.442, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0289, decode.acc_seg: 91.1045, loss: 0.0289\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 13:31:03,324 - mmseg - INFO - per class results:\n","2022-05-30 13:31:03,326 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 90.75 | 95.19 |\n","|    road    | 61.76 | 76.18 |\n","+------------+-------+-------+\n","2022-05-30 13:31:03,328 - mmseg - INFO - Summary:\n","2022-05-30 13:31:03,329 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 91.95 | 76.25 | 85.69 |\n","+-------+-------+-------+\n","2022-05-30 13:31:03,332 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9195, mIoU: 0.7625, mAcc: 0.8569, IoU.background: 0.9075, IoU.road: 0.6176, Acc.background: 0.9519, Acc.road: 0.7618\n","2022-05-30 13:31:42,473 - mmseg - INFO - Iter [3100/20000]\tlr: 5.070e-05, eta: 3:59:16, time: 4.903, data_time: 4.521, memory: 3323, decode.loss_focal: 0.0302, decode.acc_seg: 90.5807, loss: 0.0302\n","2022-05-30 13:32:21,309 - mmseg - INFO - Iter [3200/20000]\tlr: 5.040e-05, eta: 3:53:49, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0279, decode.acc_seg: 91.3716, loss: 0.0279\n","2022-05-30 13:33:02,643 - mmseg - INFO - Iter [3300/20000]\tlr: 5.010e-05, eta: 3:48:52, time: 0.413, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0289, decode.acc_seg: 90.9900, loss: 0.0289\n","2022-05-30 13:33:41,496 - mmseg - INFO - Iter [3400/20000]\tlr: 4.980e-05, eta: 3:43:58, time: 0.389, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0255, decode.acc_seg: 92.1049, loss: 0.0255\n","2022-05-30 13:34:20,430 - mmseg - INFO - Iter [3500/20000]\tlr: 4.950e-05, eta: 3:39:19, time: 0.389, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0290, decode.acc_seg: 91.0320, loss: 0.0290\n","2022-05-30 13:34:59,424 - mmseg - INFO - Iter [3600/20000]\tlr: 4.920e-05, eta: 3:34:53, time: 0.390, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0252, decode.acc_seg: 92.3428, loss: 0.0252\n","2022-05-30 13:35:38,217 - mmseg - INFO - Iter [3700/20000]\tlr: 4.890e-05, eta: 3:30:39, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0297, decode.acc_seg: 90.8954, loss: 0.0297\n","2022-05-30 13:36:19,503 - mmseg - INFO - Iter [3800/20000]\tlr: 4.860e-05, eta: 3:26:47, time: 0.413, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0281, decode.acc_seg: 91.4193, loss: 0.0281\n","2022-05-30 13:36:58,661 - mmseg - INFO - Iter [3900/20000]\tlr: 4.830e-05, eta: 3:22:56, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0269, decode.acc_seg: 91.7275, loss: 0.0269\n","2022-05-30 13:37:37,444 - mmseg - INFO - Saving checkpoint at 4000 iterations\n","2022-05-30 13:37:58,495 - mmseg - INFO - Iter [4000/20000]\tlr: 4.800e-05, eta: 3:20:37, time: 0.598, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0268, decode.acc_seg: 91.7962, loss: 0.0268\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 13:45:30,206 - mmseg - INFO - per class results:\n","2022-05-30 13:45:30,208 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.3 | 97.28 |\n","|    road    | 60.22 | 68.18 |\n","+------------+-------+-------+\n","2022-05-30 13:45:30,209 - mmseg - INFO - Summary:\n","2022-05-30 13:45:30,211 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.31 | 75.76 | 82.73 |\n","+-------+-------+-------+\n","2022-05-30 13:45:30,212 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9231, mIoU: 0.7576, mAcc: 0.8273, IoU.background: 0.9130, IoU.road: 0.6022, Acc.background: 0.9728, Acc.road: 0.6818\n","2022-05-30 13:46:09,393 - mmseg - INFO - Iter [4100/20000]\tlr: 4.770e-05, eta: 3:46:14, time: 4.909, data_time: 4.526, memory: 3323, decode.loss_focal: 0.0245, decode.acc_seg: 92.4586, loss: 0.0245\n","2022-05-30 13:46:48,150 - mmseg - INFO - Iter [4200/20000]\tlr: 4.740e-05, eta: 3:41:53, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0267, decode.acc_seg: 91.7053, loss: 0.0267\n","2022-05-30 13:47:26,978 - mmseg - INFO - Iter [4300/20000]\tlr: 4.710e-05, eta: 3:37:43, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0262, decode.acc_seg: 91.8286, loss: 0.0262\n","2022-05-30 13:48:07,993 - mmseg - INFO - Iter [4400/20000]\tlr: 4.680e-05, eta: 3:33:50, time: 0.410, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0279, decode.acc_seg: 91.2168, loss: 0.0279\n","2022-05-30 13:48:46,809 - mmseg - INFO - Iter [4500/20000]\tlr: 4.650e-05, eta: 3:29:58, time: 0.388, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0263, decode.acc_seg: 91.9785, loss: 0.0263\n","2022-05-30 13:49:25,732 - mmseg - INFO - Iter [4600/20000]\tlr: 4.620e-05, eta: 3:26:15, time: 0.389, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0266, decode.acc_seg: 91.8329, loss: 0.0266\n","2022-05-30 13:50:04,876 - mmseg - INFO - Iter [4700/20000]\tlr: 4.590e-05, eta: 3:22:41, time: 0.391, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0288, decode.acc_seg: 91.1555, loss: 0.0288\n","2022-05-30 13:50:44,081 - mmseg - INFO - Iter [4800/20000]\tlr: 4.560e-05, eta: 3:19:14, time: 0.392, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0251, decode.acc_seg: 92.1671, loss: 0.0251\n","2022-05-30 13:51:25,438 - mmseg - INFO - Iter [4900/20000]\tlr: 4.530e-05, eta: 3:16:00, time: 0.414, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0287, decode.acc_seg: 91.2740, loss: 0.0287\n","2022-05-30 13:52:04,665 - mmseg - INFO - Saving checkpoint at 5000 iterations\n","2022-05-30 13:52:35,803 - mmseg - INFO - Iter [5000/20000]\tlr: 4.500e-05, eta: 3:14:20, time: 0.704, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0256, decode.acc_seg: 92.0319, loss: 0.0256\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 14:00:07,324 - mmseg - INFO - per class results:\n","2022-05-30 14:00:07,326 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.74 | 96.79 |\n","|    road    | 63.36 | 73.24 |\n","+------------+-------+-------+\n","2022-05-30 14:00:07,327 - mmseg - INFO - Summary:\n","2022-05-30 14:00:07,328 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.77 | 77.55 | 85.02 |\n","+-------+-------+-------+\n","2022-05-30 14:00:07,330 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9277, mIoU: 0.7755, mAcc: 0.8502, IoU.background: 0.9174, IoU.road: 0.6336, Acc.background: 0.9679, Acc.road: 0.7324\n","2022-05-30 14:00:46,721 - mmseg - INFO - Iter [5100/20000]\tlr: 4.470e-05, eta: 3:33:09, time: 4.909, data_time: 4.525, memory: 3323, decode.loss_focal: 0.0277, decode.acc_seg: 91.2347, loss: 0.0277\n","2022-05-30 14:01:25,644 - mmseg - INFO - Iter [5200/20000]\tlr: 4.440e-05, eta: 3:29:30, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0252, decode.acc_seg: 92.2631, loss: 0.0252\n","2022-05-30 14:02:04,385 - mmseg - INFO - Iter [5300/20000]\tlr: 4.410e-05, eta: 3:25:57, time: 0.387, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0251, decode.acc_seg: 92.1310, loss: 0.0251\n","2022-05-30 14:02:43,396 - mmseg - INFO - Iter [5400/20000]\tlr: 4.380e-05, eta: 3:22:31, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0258, decode.acc_seg: 91.9890, loss: 0.0258\n","2022-05-30 14:03:24,544 - mmseg - INFO - Iter [5500/20000]\tlr: 4.350e-05, eta: 3:19:17, time: 0.411, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0243, decode.acc_seg: 92.4461, loss: 0.0243\n","2022-05-30 14:04:03,896 - mmseg - INFO - Iter [5600/20000]\tlr: 4.320e-05, eta: 3:16:03, time: 0.394, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0245, decode.acc_seg: 92.3032, loss: 0.0245\n","2022-05-30 14:04:42,729 - mmseg - INFO - Iter [5700/20000]\tlr: 4.290e-05, eta: 3:12:54, time: 0.388, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0241, decode.acc_seg: 92.3845, loss: 0.0241\n","2022-05-30 14:05:21,604 - mmseg - INFO - Iter [5800/20000]\tlr: 4.260e-05, eta: 3:09:50, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0270, decode.acc_seg: 91.6588, loss: 0.0270\n","2022-05-30 14:06:00,462 - mmseg - INFO - Iter [5900/20000]\tlr: 4.230e-05, eta: 3:06:51, time: 0.389, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0245, decode.acc_seg: 92.2090, loss: 0.0245\n","2022-05-30 14:06:41,328 - mmseg - INFO - Saving checkpoint at 6000 iterations\n","2022-05-30 14:07:01,598 - mmseg - INFO - Iter [6000/20000]\tlr: 4.200e-05, eta: 3:04:49, time: 0.611, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0271, decode.acc_seg: 91.4732, loss: 0.0271\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 14:14:32,842 - mmseg - INFO - per class results:\n","2022-05-30 14:14:32,843 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.54 | 96.42 |\n","|    road    | 63.12 | 74.11 |\n","+------------+-------+-------+\n","2022-05-30 14:14:32,846 - mmseg - INFO - Summary:\n","2022-05-30 14:14:32,848 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.61 | 77.33 | 85.26 |\n","+-------+-------+-------+\n","2022-05-30 14:14:32,850 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9261, mIoU: 0.7733, mAcc: 0.8526, IoU.background: 0.9154, IoU.road: 0.6312, Acc.background: 0.9642, Acc.road: 0.7411\n","2022-05-30 14:15:13,675 - mmseg - INFO - Iter [6100/20000]\tlr: 4.170e-05, eta: 3:19:10, time: 4.921, data_time: 4.522, memory: 3323, decode.loss_focal: 0.0240, decode.acc_seg: 92.3828, loss: 0.0240\n","2022-05-30 14:15:54,105 - mmseg - INFO - Iter [6200/20000]\tlr: 4.140e-05, eta: 3:16:03, time: 0.404, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0244, decode.acc_seg: 92.1669, loss: 0.0244\n","2022-05-30 14:16:34,457 - mmseg - INFO - Iter [6300/20000]\tlr: 4.110e-05, eta: 3:13:00, time: 0.404, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0227, decode.acc_seg: 92.9254, loss: 0.0227\n","2022-05-30 14:17:14,651 - mmseg - INFO - Iter [6400/20000]\tlr: 4.080e-05, eta: 3:10:01, time: 0.402, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0249, decode.acc_seg: 92.2917, loss: 0.0249\n","2022-05-30 14:17:54,747 - mmseg - INFO - Iter [6500/20000]\tlr: 4.050e-05, eta: 3:07:07, time: 0.401, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0253, decode.acc_seg: 91.9845, loss: 0.0253\n","2022-05-30 14:18:36,782 - mmseg - INFO - Iter [6600/20000]\tlr: 4.020e-05, eta: 3:04:20, time: 0.420, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0231, decode.acc_seg: 92.8657, loss: 0.0231\n","2022-05-30 14:19:16,237 - mmseg - INFO - Iter [6700/20000]\tlr: 3.990e-05, eta: 3:01:32, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0252, decode.acc_seg: 92.1878, loss: 0.0252\n","2022-05-30 14:19:55,558 - mmseg - INFO - Iter [6800/20000]\tlr: 3.960e-05, eta: 2:58:47, time: 0.393, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0241, decode.acc_seg: 92.2558, loss: 0.0241\n","2022-05-30 14:20:34,823 - mmseg - INFO - Iter [6900/20000]\tlr: 3.930e-05, eta: 2:56:06, time: 0.393, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0254, decode.acc_seg: 91.9563, loss: 0.0254\n","2022-05-30 14:21:14,097 - mmseg - INFO - Saving checkpoint at 7000 iterations\n","2022-05-30 14:21:34,986 - mmseg - INFO - Iter [7000/20000]\tlr: 3.900e-05, eta: 2:54:08, time: 0.602, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0235, decode.acc_seg: 92.5419, loss: 0.0235\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 14:29:06,656 - mmseg - INFO - per class results:\n","2022-05-30 14:29:06,658 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.7 |  96.8 |\n","|    road    | 63.13 | 72.93 |\n","+------------+-------+-------+\n","2022-05-30 14:29:06,660 - mmseg - INFO - Summary:\n","2022-05-30 14:29:06,662 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.73 | 77.41 | 84.87 |\n","+-------+-------+-------+\n","2022-05-30 14:29:06,664 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9273, mIoU: 0.7741, mAcc: 0.8487, IoU.background: 0.9170, IoU.road: 0.6313, Acc.background: 0.9680, Acc.road: 0.7293\n","2022-05-30 14:29:48,381 - mmseg - INFO - Iter [7100/20000]\tlr: 3.870e-05, eta: 3:05:18, time: 4.934, data_time: 4.547, memory: 3323, decode.loss_focal: 0.0226, decode.acc_seg: 92.9615, loss: 0.0226\n","2022-05-30 14:30:27,338 - mmseg - INFO - Iter [7200/20000]\tlr: 3.840e-05, eta: 3:02:27, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0251, decode.acc_seg: 92.2824, loss: 0.0251\n","2022-05-30 14:31:06,250 - mmseg - INFO - Iter [7300/20000]\tlr: 3.810e-05, eta: 2:59:41, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0242, decode.acc_seg: 92.2151, loss: 0.0242\n","2022-05-30 14:31:45,155 - mmseg - INFO - Iter [7400/20000]\tlr: 3.780e-05, eta: 2:56:58, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0257, decode.acc_seg: 92.0748, loss: 0.0257\n","2022-05-30 14:32:24,198 - mmseg - INFO - Iter [7500/20000]\tlr: 3.750e-05, eta: 2:54:18, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0239, decode.acc_seg: 92.7060, loss: 0.0239\n","2022-05-30 14:33:05,756 - mmseg - INFO - Iter [7600/20000]\tlr: 3.720e-05, eta: 2:51:46, time: 0.416, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0234, decode.acc_seg: 92.5349, loss: 0.0234\n","2022-05-30 14:33:45,467 - mmseg - INFO - Iter [7700/20000]\tlr: 3.690e-05, eta: 2:49:13, time: 0.397, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0225, decode.acc_seg: 92.9410, loss: 0.0225\n","2022-05-30 14:34:24,877 - mmseg - INFO - Iter [7800/20000]\tlr: 3.660e-05, eta: 2:46:43, time: 0.394, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0227, decode.acc_seg: 92.9489, loss: 0.0227\n","2022-05-30 14:35:04,489 - mmseg - INFO - Iter [7900/20000]\tlr: 3.630e-05, eta: 2:44:16, time: 0.396, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0240, decode.acc_seg: 92.4317, loss: 0.0240\n","2022-05-30 14:35:44,026 - mmseg - INFO - Saving checkpoint at 8000 iterations\n","2022-05-30 14:36:06,188 - mmseg - INFO - Iter [8000/20000]\tlr: 3.600e-05, eta: 2:42:25, time: 0.617, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0217, decode.acc_seg: 93.2016, loss: 0.0217\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 452s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 14:43:38,072 - mmseg - INFO - per class results:\n","2022-05-30 14:43:38,075 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.77 | 96.87 |\n","|    road    | 63.36 | 73.01 |\n","+------------+-------+-------+\n","2022-05-30 14:43:38,078 - mmseg - INFO - Summary:\n","2022-05-30 14:43:38,080 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.79 | 77.57 | 84.94 |\n","+-------+-------+-------+\n","2022-05-30 14:43:38,083 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9279, mIoU: 0.7757, mAcc: 0.8494, IoU.background: 0.9177, IoU.road: 0.6336, Acc.background: 0.9687, Acc.road: 0.7301\n","2022-05-30 14:44:17,572 - mmseg - INFO - Iter [8100/20000]\tlr: 3.570e-05, eta: 2:51:06, time: 4.914, data_time: 4.528, memory: 3323, decode.loss_focal: 0.0244, decode.acc_seg: 92.1194, loss: 0.0244\n","2022-05-30 14:44:59,110 - mmseg - INFO - Iter [8200/20000]\tlr: 3.540e-05, eta: 2:48:36, time: 0.415, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0246, decode.acc_seg: 92.0842, loss: 0.0246\n","2022-05-30 14:45:38,721 - mmseg - INFO - Iter [8300/20000]\tlr: 3.510e-05, eta: 2:46:05, time: 0.396, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0219, decode.acc_seg: 93.0784, loss: 0.0219\n","2022-05-30 14:46:18,254 - mmseg - INFO - Iter [8400/20000]\tlr: 3.480e-05, eta: 2:43:37, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0224, decode.acc_seg: 92.8692, loss: 0.0224\n","2022-05-30 14:46:57,537 - mmseg - INFO - Iter [8500/20000]\tlr: 3.450e-05, eta: 2:41:11, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0223, decode.acc_seg: 93.1117, loss: 0.0223\n","2022-05-30 14:47:36,670 - mmseg - INFO - Iter [8600/20000]\tlr: 3.420e-05, eta: 2:38:47, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0229, decode.acc_seg: 92.6817, loss: 0.0229\n","2022-05-30 14:48:17,908 - mmseg - INFO - Iter [8700/20000]\tlr: 3.390e-05, eta: 2:36:29, time: 0.412, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0226, decode.acc_seg: 92.8693, loss: 0.0226\n","2022-05-30 14:48:57,084 - mmseg - INFO - Iter [8800/20000]\tlr: 3.360e-05, eta: 2:34:10, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0219, decode.acc_seg: 93.0482, loss: 0.0219\n","2022-05-30 14:49:36,140 - mmseg - INFO - Iter [8900/20000]\tlr: 3.330e-05, eta: 2:31:53, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0231, decode.acc_seg: 92.7543, loss: 0.0231\n","2022-05-30 14:50:15,305 - mmseg - INFO - Saving checkpoint at 9000 iterations\n","2022-05-30 14:50:27,742 - mmseg - INFO - Iter [9000/20000]\tlr: 3.300e-05, eta: 2:29:53, time: 0.516, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0235, decode.acc_seg: 92.6637, loss: 0.0235\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 449s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 14:57:56,911 - mmseg - INFO - per class results:\n","2022-05-30 14:57:56,913 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.64 | 96.31 |\n","|    road    | 63.77 | 75.19 |\n","+------------+-------+-------+\n","2022-05-30 14:57:56,914 - mmseg - INFO - Summary:\n","2022-05-30 14:57:56,915 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.71 | 77.71 | 85.75 |\n","+-------+-------+-------+\n","2022-05-30 14:57:56,918 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9271, mIoU: 0.7771, mAcc: 0.8575, IoU.background: 0.9164, IoU.road: 0.6377, Acc.background: 0.9631, Acc.road: 0.7519\n","2022-05-30 14:58:36,417 - mmseg - INFO - Iter [9100/20000]\tlr: 3.270e-05, eta: 2:36:39, time: 4.887, data_time: 4.501, memory: 3323, decode.loss_focal: 0.0237, decode.acc_seg: 92.6519, loss: 0.0237\n","2022-05-30 14:59:15,528 - mmseg - INFO - Iter [9200/20000]\tlr: 3.240e-05, eta: 2:34:17, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0218, decode.acc_seg: 93.0584, loss: 0.0218\n","2022-05-30 14:59:56,740 - mmseg - INFO - Iter [9300/20000]\tlr: 3.210e-05, eta: 2:32:01, time: 0.412, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0226, decode.acc_seg: 92.8499, loss: 0.0226\n","2022-05-30 15:00:35,813 - mmseg - INFO - Iter [9400/20000]\tlr: 3.180e-05, eta: 2:29:43, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0222, decode.acc_seg: 93.0938, loss: 0.0222\n","2022-05-30 15:01:14,889 - mmseg - INFO - Iter [9500/20000]\tlr: 3.150e-05, eta: 2:27:28, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0206, decode.acc_seg: 93.3927, loss: 0.0206\n","2022-05-30 15:01:54,013 - mmseg - INFO - Iter [9600/20000]\tlr: 3.120e-05, eta: 2:25:15, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0224, decode.acc_seg: 92.9262, loss: 0.0224\n","2022-05-30 15:02:33,185 - mmseg - INFO - Iter [9700/20000]\tlr: 3.090e-05, eta: 2:23:04, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0219, decode.acc_seg: 92.9279, loss: 0.0219\n","2022-05-30 15:03:14,532 - mmseg - INFO - Iter [9800/20000]\tlr: 3.060e-05, eta: 2:20:57, time: 0.413, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0201, decode.acc_seg: 93.5250, loss: 0.0201\n","2022-05-30 15:03:54,050 - mmseg - INFO - Iter [9900/20000]\tlr: 3.030e-05, eta: 2:18:49, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0236, decode.acc_seg: 92.4984, loss: 0.0236\n","2022-05-30 15:04:33,489 - mmseg - INFO - Saving checkpoint at 10000 iterations\n","2022-05-30 15:04:53,823 - mmseg - INFO - Iter [10000/20000]\tlr: 3.000e-05, eta: 2:17:04, time: 0.598, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0219, decode.acc_seg: 93.0017, loss: 0.0219\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 448s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 15:12:21,702 - mmseg - INFO - per class results:\n","2022-05-30 15:12:21,704 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.89 | 97.47 |\n","|    road    | 62.78 | 70.49 |\n","+------------+-------+-------+\n","2022-05-30 15:12:21,706 - mmseg - INFO - Summary:\n","2022-05-30 15:12:21,708 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.87 | 77.34 | 83.98 |\n","+-------+-------+-------+\n","2022-05-30 15:12:21,711 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9287, mIoU: 0.7734, mAcc: 0.8398, IoU.background: 0.9189, IoU.road: 0.6278, Acc.background: 0.9747, Acc.road: 0.7049\n","2022-05-30 15:13:01,104 - mmseg - INFO - Iter [10100/20000]\tlr: 2.970e-05, eta: 2:22:19, time: 4.873, data_time: 4.488, memory: 3323, decode.loss_focal: 0.0217, decode.acc_seg: 93.0467, loss: 0.0217\n","2022-05-30 15:13:40,139 - mmseg - INFO - Iter [10200/20000]\tlr: 2.940e-05, eta: 2:20:07, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0199, decode.acc_seg: 93.6739, loss: 0.0199\n","2022-05-30 15:14:21,665 - mmseg - INFO - Iter [10300/20000]\tlr: 2.910e-05, eta: 2:18:00, time: 0.415, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0220, decode.acc_seg: 92.9388, loss: 0.0220\n","2022-05-30 15:15:01,121 - mmseg - INFO - Iter [10400/20000]\tlr: 2.880e-05, eta: 2:15:52, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0202, decode.acc_seg: 93.4576, loss: 0.0202\n","2022-05-30 15:15:40,601 - mmseg - INFO - Iter [10500/20000]\tlr: 2.850e-05, eta: 2:13:46, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0223, decode.acc_seg: 92.8402, loss: 0.0223\n","2022-05-30 15:16:20,046 - mmseg - INFO - Iter [10600/20000]\tlr: 2.820e-05, eta: 2:11:42, time: 0.394, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0228, decode.acc_seg: 92.7516, loss: 0.0228\n","2022-05-30 15:16:59,387 - mmseg - INFO - Iter [10700/20000]\tlr: 2.790e-05, eta: 2:09:39, time: 0.393, data_time: 0.010, memory: 3323, decode.loss_focal: 0.0221, decode.acc_seg: 92.9929, loss: 0.0221\n","2022-05-30 15:17:38,654 - mmseg - INFO - Iter [10800/20000]\tlr: 2.760e-05, eta: 2:07:37, time: 0.393, data_time: 0.010, memory: 3323, decode.loss_focal: 0.0226, decode.acc_seg: 92.7355, loss: 0.0226\n","2022-05-30 15:18:20,061 - mmseg - INFO - Iter [10900/20000]\tlr: 2.730e-05, eta: 2:05:39, time: 0.414, data_time: 0.030, memory: 3323, decode.loss_focal: 0.0215, decode.acc_seg: 93.0009, loss: 0.0215\n","2022-05-30 15:18:59,361 - mmseg - INFO - Saving checkpoint at 11000 iterations\n","2022-05-30 15:19:15,160 - mmseg - INFO - Iter [11000/20000]\tlr: 2.700e-05, eta: 2:03:54, time: 0.551, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0206, decode.acc_seg: 93.4595, loss: 0.0206\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 452s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 15:26:47,139 - mmseg - INFO - per class results:\n","2022-05-30 15:26:47,141 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background |  91.7 | 96.19 |\n","|    road    | 64.32 | 76.23 |\n","+------------+-------+-------+\n","2022-05-30 15:26:47,143 - mmseg - INFO - Summary:\n","2022-05-30 15:26:47,148 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.78 | 78.01 | 86.21 |\n","+-------+-------+-------+\n","2022-05-30 15:26:47,149 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9278, mIoU: 0.7801, mAcc: 0.8621, IoU.background: 0.9170, IoU.road: 0.6432, Acc.background: 0.9619, Acc.road: 0.7623\n","2022-05-30 15:27:26,729 - mmseg - INFO - Iter [11100/20000]\tlr: 2.670e-05, eta: 2:07:59, time: 4.916, data_time: 4.530, memory: 3323, decode.loss_focal: 0.0216, decode.acc_seg: 93.0237, loss: 0.0216\n","2022-05-30 15:28:05,717 - mmseg - INFO - Iter [11200/20000]\tlr: 2.640e-05, eta: 2:05:55, time: 0.390, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0209, decode.acc_seg: 93.1971, loss: 0.0209\n","2022-05-30 15:28:45,572 - mmseg - INFO - Iter [11300/20000]\tlr: 2.610e-05, eta: 2:03:54, time: 0.399, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0211, decode.acc_seg: 93.1708, loss: 0.0211\n","2022-05-30 15:29:27,119 - mmseg - INFO - Iter [11400/20000]\tlr: 2.580e-05, eta: 2:01:56, time: 0.415, data_time: 0.031, memory: 3323, decode.loss_focal: 0.0233, decode.acc_seg: 92.6517, loss: 0.0233\n","2022-05-30 15:30:06,648 - mmseg - INFO - Iter [11500/20000]\tlr: 2.550e-05, eta: 1:59:57, time: 0.395, data_time: 0.009, memory: 3323, decode.loss_focal: 0.0213, decode.acc_seg: 93.2081, loss: 0.0213\n","2022-05-30 15:30:45,712 - mmseg - INFO - Iter [11600/20000]\tlr: 2.520e-05, eta: 1:57:59, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0214, decode.acc_seg: 93.1996, loss: 0.0214\n","2022-05-30 15:31:24,812 - mmseg - INFO - Iter [11700/20000]\tlr: 2.490e-05, eta: 1:56:03, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0211, decode.acc_seg: 93.2703, loss: 0.0211\n","2022-05-30 15:32:03,916 - mmseg - INFO - Iter [11800/20000]\tlr: 2.460e-05, eta: 1:54:08, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.9283, loss: 0.0192\n","2022-05-30 15:32:42,981 - mmseg - INFO - Iter [11900/20000]\tlr: 2.430e-05, eta: 1:52:14, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0237, decode.acc_seg: 92.4506, loss: 0.0237\n","2022-05-30 15:33:24,052 - mmseg - INFO - Saving checkpoint at 12000 iterations\n","2022-05-30 15:33:46,796 - mmseg - INFO - Iter [12000/20000]\tlr: 2.400e-05, eta: 1:50:38, time: 0.638, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0204, decode.acc_seg: 93.4715, loss: 0.0204\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 15:41:18,179 - mmseg - INFO - per class results:\n","2022-05-30 15:41:18,181 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.85 | 97.06 |\n","|    road    | 63.35 | 72.39 |\n","+------------+-------+-------+\n","2022-05-30 15:41:18,183 - mmseg - INFO - Summary:\n","2022-05-30 15:41:18,184 - mmseg - INFO - \n","+-------+------+-------+\n","|  aAcc | mIoU |  mAcc |\n","+-------+------+-------+\n","| 92.85 | 77.6 | 84.73 |\n","+-------+------+-------+\n","2022-05-30 15:41:18,186 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9285, mIoU: 0.7760, mAcc: 0.8473, IoU.background: 0.9185, IoU.road: 0.6335, Acc.background: 0.9706, Acc.road: 0.7239\n","2022-05-30 15:41:57,382 - mmseg - INFO - Iter [12100/20000]\tlr: 2.370e-05, eta: 1:53:41, time: 4.906, data_time: 4.523, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.8843, loss: 0.0192\n","2022-05-30 15:42:36,339 - mmseg - INFO - Iter [12200/20000]\tlr: 2.340e-05, eta: 1:51:44, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0217, decode.acc_seg: 92.8787, loss: 0.0217\n","2022-05-30 15:43:15,241 - mmseg - INFO - Iter [12300/20000]\tlr: 2.310e-05, eta: 1:49:49, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0209, decode.acc_seg: 93.3023, loss: 0.0209\n","2022-05-30 15:43:54,329 - mmseg - INFO - Iter [12400/20000]\tlr: 2.280e-05, eta: 1:47:55, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0210, decode.acc_seg: 93.2505, loss: 0.0210\n","2022-05-30 15:44:35,576 - mmseg - INFO - Iter [12500/20000]\tlr: 2.250e-05, eta: 1:46:03, time: 0.412, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0211, decode.acc_seg: 93.2220, loss: 0.0211\n","2022-05-30 15:45:14,524 - mmseg - INFO - Iter [12600/20000]\tlr: 2.220e-05, eta: 1:44:12, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0205, decode.acc_seg: 93.3589, loss: 0.0205\n","2022-05-30 15:45:53,423 - mmseg - INFO - Iter [12700/20000]\tlr: 2.190e-05, eta: 1:42:21, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0196, decode.acc_seg: 93.7614, loss: 0.0196\n","2022-05-30 15:46:32,357 - mmseg - INFO - Iter [12800/20000]\tlr: 2.160e-05, eta: 1:40:31, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0213, decode.acc_seg: 93.0901, loss: 0.0213\n","2022-05-30 15:47:11,331 - mmseg - INFO - Iter [12900/20000]\tlr: 2.130e-05, eta: 1:38:43, time: 0.390, data_time: 0.005, memory: 3323, decode.loss_focal: 0.0213, decode.acc_seg: 93.2396, loss: 0.0213\n","2022-05-30 15:47:50,403 - mmseg - INFO - Saving checkpoint at 13000 iterations\n","2022-05-30 15:48:06,439 - mmseg - INFO - Iter [13000/20000]\tlr: 2.100e-05, eta: 1:37:04, time: 0.551, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.7387, loss: 0.0192\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 15:55:37,871 - mmseg - INFO - per class results:\n","2022-05-30 15:55:37,873 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.88 | 96.28 |\n","|    road    | 64.99 | 76.74 |\n","+------------+-------+-------+\n","2022-05-30 15:55:37,876 - mmseg - INFO - Summary:\n","2022-05-30 15:55:37,878 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 92.95 | 78.44 | 86.51 |\n","+-------+-------+-------+\n","2022-05-30 15:55:37,881 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9295, mIoU: 0.7844, mAcc: 0.8651, IoU.background: 0.9188, IoU.road: 0.6499, Acc.background: 0.9628, Acc.road: 0.7674\n","2022-05-30 15:56:19,471 - mmseg - INFO - Iter [13100/20000]\tlr: 2.070e-05, eta: 1:39:17, time: 4.930, data_time: 4.543, memory: 3323, decode.loss_focal: 0.0186, decode.acc_seg: 93.9775, loss: 0.0186\n","2022-05-30 15:56:58,632 - mmseg - INFO - Iter [13200/20000]\tlr: 2.040e-05, eta: 1:37:26, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0199, decode.acc_seg: 93.5339, loss: 0.0199\n","2022-05-30 15:57:37,818 - mmseg - INFO - Iter [13300/20000]\tlr: 2.010e-05, eta: 1:35:37, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0194, decode.acc_seg: 93.6993, loss: 0.0194\n","2022-05-30 15:58:16,988 - mmseg - INFO - Iter [13400/20000]\tlr: 1.980e-05, eta: 1:33:48, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0199, decode.acc_seg: 93.7311, loss: 0.0199\n","2022-05-30 15:58:56,238 - mmseg - INFO - Iter [13500/20000]\tlr: 1.950e-05, eta: 1:32:01, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0216, decode.acc_seg: 93.0156, loss: 0.0216\n","2022-05-30 15:59:37,574 - mmseg - INFO - Iter [13600/20000]\tlr: 1.920e-05, eta: 1:30:15, time: 0.413, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0198, decode.acc_seg: 93.6597, loss: 0.0198\n","2022-05-30 16:00:16,872 - mmseg - INFO - Iter [13700/20000]\tlr: 1.890e-05, eta: 1:28:30, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0226, decode.acc_seg: 92.6679, loss: 0.0226\n","2022-05-30 16:00:55,974 - mmseg - INFO - Iter [13800/20000]\tlr: 1.860e-05, eta: 1:26:45, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0191, decode.acc_seg: 93.8283, loss: 0.0191\n","2022-05-30 16:01:35,070 - mmseg - INFO - Iter [13900/20000]\tlr: 1.830e-05, eta: 1:25:02, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0202, decode.acc_seg: 93.4681, loss: 0.0202\n","2022-05-30 16:02:14,252 - mmseg - INFO - Saving checkpoint at 14000 iterations\n","2022-05-30 16:02:27,300 - mmseg - INFO - Iter [14000/20000]\tlr: 1.800e-05, eta: 1:23:24, time: 0.522, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0191, decode.acc_seg: 93.7735, loss: 0.0191\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 452s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 16:09:59,187 - mmseg - INFO - per class results:\n","2022-05-30 16:09:59,189 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 91.97 | 96.64 |\n","|    road    | 64.75 | 75.32 |\n","+------------+-------+-------+\n","2022-05-30 16:09:59,190 - mmseg - INFO - Summary:\n","2022-05-30 16:09:59,193 - mmseg - INFO - \n","+------+-------+-------+\n","| aAcc |  mIoU |  mAcc |\n","+------+-------+-------+\n","| 93.0 | 78.36 | 85.98 |\n","+------+-------+-------+\n","2022-05-30 16:09:59,195 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9300, mIoU: 0.7836, mAcc: 0.8598, IoU.background: 0.9197, IoU.road: 0.6475, Acc.background: 0.9664, Acc.road: 0.7532\n","2022-05-30 16:10:40,655 - mmseg - INFO - Iter [14100/20000]\tlr: 1.770e-05, eta: 1:24:53, time: 4.934, data_time: 4.547, memory: 3323, decode.loss_focal: 0.0199, decode.acc_seg: 93.5440, loss: 0.0199\n","2022-05-30 16:11:19,613 - mmseg - INFO - Iter [14200/20000]\tlr: 1.740e-05, eta: 1:23:07, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0200, decode.acc_seg: 93.6439, loss: 0.0200\n","2022-05-30 16:11:58,756 - mmseg - INFO - Iter [14300/20000]\tlr: 1.710e-05, eta: 1:21:22, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0191, decode.acc_seg: 93.8294, loss: 0.0191\n","2022-05-30 16:12:37,669 - mmseg - INFO - Iter [14400/20000]\tlr: 1.680e-05, eta: 1:19:38, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0194, decode.acc_seg: 93.7283, loss: 0.0194\n","2022-05-30 16:13:17,064 - mmseg - INFO - Iter [14500/20000]\tlr: 1.650e-05, eta: 1:17:56, time: 0.394, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0194, decode.acc_seg: 93.7459, loss: 0.0194\n","2022-05-30 16:13:56,283 - mmseg - INFO - Iter [14600/20000]\tlr: 1.620e-05, eta: 1:16:14, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0218, decode.acc_seg: 92.8076, loss: 0.0218\n","2022-05-30 16:14:37,667 - mmseg - INFO - Iter [14700/20000]\tlr: 1.590e-05, eta: 1:14:33, time: 0.414, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0207, decode.acc_seg: 93.2636, loss: 0.0207\n","2022-05-30 16:15:16,827 - mmseg - INFO - Iter [14800/20000]\tlr: 1.560e-05, eta: 1:12:53, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0189, decode.acc_seg: 93.8547, loss: 0.0189\n","2022-05-30 16:15:56,039 - mmseg - INFO - Iter [14900/20000]\tlr: 1.530e-05, eta: 1:11:14, time: 0.392, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0198, decode.acc_seg: 93.5303, loss: 0.0198\n","2022-05-30 16:16:35,130 - mmseg - INFO - Saving checkpoint at 15000 iterations\n","2022-05-30 16:16:57,901 - mmseg - INFO - Iter [15000/20000]\tlr: 1.500e-05, eta: 1:09:42, time: 0.619, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0189, decode.acc_seg: 93.9166, loss: 0.0189\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 16:24:29,571 - mmseg - INFO - per class results:\n","2022-05-30 16:24:29,573 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.06 | 97.44 |\n","|    road    | 63.67 |  71.6 |\n","+------------+-------+-------+\n","2022-05-30 16:24:29,574 - mmseg - INFO - Summary:\n","2022-05-30 16:24:29,577 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.03 | 77.86 | 84.52 |\n","+-------+-------+-------+\n","2022-05-30 16:24:29,579 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9303, mIoU: 0.7786, mAcc: 0.8452, IoU.background: 0.9206, IoU.road: 0.6367, Acc.background: 0.9744, Acc.road: 0.7160\n","2022-05-30 16:25:08,928 - mmseg - INFO - Iter [15100/20000]\tlr: 1.470e-05, eta: 1:10:31, time: 4.910, data_time: 4.524, memory: 3323, decode.loss_focal: 0.0195, decode.acc_seg: 93.5966, loss: 0.0195\n","2022-05-30 16:25:50,443 - mmseg - INFO - Iter [15200/20000]\tlr: 1.440e-05, eta: 1:08:50, time: 0.415, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.6888, loss: 0.0192\n","2022-05-30 16:26:29,814 - mmseg - INFO - Iter [15300/20000]\tlr: 1.410e-05, eta: 1:07:10, time: 0.394, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0208, decode.acc_seg: 93.2645, loss: 0.0208\n","2022-05-30 16:27:09,087 - mmseg - INFO - Iter [15400/20000]\tlr: 1.380e-05, eta: 1:05:30, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0189, decode.acc_seg: 93.9111, loss: 0.0189\n","2022-05-30 16:27:48,143 - mmseg - INFO - Iter [15500/20000]\tlr: 1.350e-05, eta: 1:03:51, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0189, decode.acc_seg: 93.8535, loss: 0.0189\n","2022-05-30 16:28:27,177 - mmseg - INFO - Iter [15600/20000]\tlr: 1.320e-05, eta: 1:02:13, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0186, decode.acc_seg: 94.1020, loss: 0.0186\n","2022-05-30 16:29:06,294 - mmseg - INFO - Iter [15700/20000]\tlr: 1.290e-05, eta: 1:00:36, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0186, decode.acc_seg: 93.9957, loss: 0.0186\n","2022-05-30 16:29:47,489 - mmseg - INFO - Iter [15800/20000]\tlr: 1.260e-05, eta: 0:59:00, time: 0.412, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0191, decode.acc_seg: 93.8969, loss: 0.0191\n","2022-05-30 16:30:26,575 - mmseg - INFO - Iter [15900/20000]\tlr: 1.230e-05, eta: 0:57:24, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0196, decode.acc_seg: 93.6043, loss: 0.0196\n","2022-05-30 16:31:05,755 - mmseg - INFO - Saving checkpoint at 16000 iterations\n","2022-05-30 16:31:27,095 - mmseg - INFO - Iter [16000/20000]\tlr: 1.200e-05, eta: 0:55:54, time: 0.605, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0188, decode.acc_seg: 93.8545, loss: 0.0188\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 16:38:57,895 - mmseg - INFO - per class results:\n","2022-05-30 16:38:57,897 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.07 | 97.05 |\n","|    road    | 64.49 | 73.74 |\n","+------------+-------+-------+\n","2022-05-30 16:38:57,898 - mmseg - INFO - Summary:\n","2022-05-30 16:38:57,901 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.07 | 78.28 | 85.39 |\n","+-------+-------+-------+\n","2022-05-30 16:38:57,904 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9307, mIoU: 0.7828, mAcc: 0.8539, IoU.background: 0.9207, IoU.road: 0.6449, Acc.background: 0.9705, Acc.road: 0.7374\n","2022-05-30 16:39:37,236 - mmseg - INFO - Iter [16100/20000]\tlr: 1.170e-05, eta: 0:56:09, time: 4.901, data_time: 4.516, memory: 3323, decode.loss_focal: 0.0194, decode.acc_seg: 93.7409, loss: 0.0194\n","2022-05-30 16:40:16,375 - mmseg - INFO - Iter [16200/20000]\tlr: 1.140e-05, eta: 0:54:31, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0188, decode.acc_seg: 93.8111, loss: 0.0188\n","2022-05-30 16:40:57,460 - mmseg - INFO - Iter [16300/20000]\tlr: 1.110e-05, eta: 0:52:55, time: 0.411, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0191, decode.acc_seg: 93.8390, loss: 0.0191\n","2022-05-30 16:41:36,662 - mmseg - INFO - Iter [16400/20000]\tlr: 1.080e-05, eta: 0:51:19, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0180, decode.acc_seg: 94.0855, loss: 0.0180\n","2022-05-30 16:42:15,955 - mmseg - INFO - Iter [16500/20000]\tlr: 1.050e-05, eta: 0:49:43, time: 0.393, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0174, decode.acc_seg: 94.3493, loss: 0.0174\n","2022-05-30 16:42:55,459 - mmseg - INFO - Iter [16600/20000]\tlr: 1.020e-05, eta: 0:48:09, time: 0.395, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.6993, loss: 0.0192\n","2022-05-30 16:43:34,614 - mmseg - INFO - Iter [16700/20000]\tlr: 9.903e-06, eta: 0:46:35, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0197, decode.acc_seg: 93.6002, loss: 0.0197\n","2022-05-30 16:44:13,806 - mmseg - INFO - Iter [16800/20000]\tlr: 9.603e-06, eta: 0:45:01, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0198, decode.acc_seg: 93.5520, loss: 0.0198\n","2022-05-30 16:44:55,023 - mmseg - INFO - Iter [16900/20000]\tlr: 9.303e-06, eta: 0:43:29, time: 0.412, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0196, decode.acc_seg: 93.6141, loss: 0.0196\n","2022-05-30 16:45:34,109 - mmseg - INFO - Saving checkpoint at 17000 iterations\n","2022-05-30 16:45:56,173 - mmseg - INFO - Iter [17000/20000]\tlr: 9.003e-06, eta: 0:42:01, time: 0.611, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0185, decode.acc_seg: 93.9467, loss: 0.0185\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 450s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 16:53:26,130 - mmseg - INFO - per class results:\n","2022-05-30 16:53:26,131 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.05 | 97.47 |\n","|    road    | 63.57 | 71.37 |\n","+------------+-------+-------+\n","2022-05-30 16:53:26,133 - mmseg - INFO - Summary:\n","2022-05-30 16:53:26,136 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.02 | 77.81 | 84.42 |\n","+-------+-------+-------+\n","2022-05-30 16:53:26,139 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9302, mIoU: 0.7781, mAcc: 0.8442, IoU.background: 0.9205, IoU.road: 0.6357, Acc.background: 0.9747, Acc.road: 0.7137\n","2022-05-30 16:54:05,368 - mmseg - INFO - Iter [17100/20000]\tlr: 8.703e-06, eta: 0:41:45, time: 4.892, data_time: 4.507, memory: 3323, decode.loss_focal: 0.0178, decode.acc_seg: 94.1862, loss: 0.0178\n","2022-05-30 16:54:44,613 - mmseg - INFO - Iter [17200/20000]\tlr: 8.403e-06, eta: 0:40:11, time: 0.392, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0195, decode.acc_seg: 93.6187, loss: 0.0195\n","2022-05-30 16:55:23,761 - mmseg - INFO - Iter [17300/20000]\tlr: 8.103e-06, eta: 0:38:38, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0179, decode.acc_seg: 94.3081, loss: 0.0179\n","2022-05-30 16:56:05,227 - mmseg - INFO - Iter [17400/20000]\tlr: 7.803e-06, eta: 0:37:05, time: 0.415, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0174, decode.acc_seg: 94.2589, loss: 0.0174\n","2022-05-30 16:56:45,255 - mmseg - INFO - Iter [17500/20000]\tlr: 7.503e-06, eta: 0:35:33, time: 0.400, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0176, decode.acc_seg: 94.3388, loss: 0.0176\n","2022-05-30 16:57:24,525 - mmseg - INFO - Iter [17600/20000]\tlr: 7.203e-06, eta: 0:34:02, time: 0.393, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0183, decode.acc_seg: 93.9927, loss: 0.0183\n","2022-05-30 16:58:03,660 - mmseg - INFO - Iter [17700/20000]\tlr: 6.903e-06, eta: 0:32:31, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0208, decode.acc_seg: 93.2507, loss: 0.0208\n","2022-05-30 16:58:42,871 - mmseg - INFO - Iter [17800/20000]\tlr: 6.603e-06, eta: 0:31:00, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0187, decode.acc_seg: 93.8932, loss: 0.0187\n","2022-05-30 16:59:24,198 - mmseg - INFO - Iter [17900/20000]\tlr: 6.303e-06, eta: 0:29:30, time: 0.413, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0192, decode.acc_seg: 93.6298, loss: 0.0192\n","2022-05-30 17:00:03,311 - mmseg - INFO - Saving checkpoint at 18000 iterations\n","2022-05-30 17:00:17,617 - mmseg - INFO - Iter [18000/20000]\tlr: 6.003e-06, eta: 0:28:03, time: 0.534, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0196, decode.acc_seg: 93.5921, loss: 0.0196\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 452s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 17:07:49,562 - mmseg - INFO - per class results:\n","2022-05-30 17:07:49,564 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.09 | 97.16 |\n","|    road    | 64.34 | 73.22 |\n","+------------+-------+-------+\n","2022-05-30 17:07:49,569 - mmseg - INFO - Summary:\n","2022-05-30 17:07:49,570 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.08 | 78.22 | 85.19 |\n","+-------+-------+-------+\n","2022-05-30 17:07:49,572 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9308, mIoU: 0.7822, mAcc: 0.8519, IoU.background: 0.9209, IoU.road: 0.6434, Acc.background: 0.9716, Acc.road: 0.7322\n","2022-05-30 17:08:28,801 - mmseg - INFO - Iter [18100/20000]\tlr: 5.703e-06, eta: 0:27:21, time: 4.912, data_time: 4.527, memory: 3323, decode.loss_focal: 0.0185, decode.acc_seg: 93.9569, loss: 0.0185\n","2022-05-30 17:09:07,717 - mmseg - INFO - Iter [18200/20000]\tlr: 5.403e-06, eta: 0:25:50, time: 0.389, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0178, decode.acc_seg: 94.2014, loss: 0.0178\n","2022-05-30 17:09:46,691 - mmseg - INFO - Iter [18300/20000]\tlr: 5.103e-06, eta: 0:24:20, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0185, decode.acc_seg: 94.0399, loss: 0.0185\n","2022-05-30 17:10:25,733 - mmseg - INFO - Iter [18400/20000]\tlr: 4.803e-06, eta: 0:22:50, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0163, decode.acc_seg: 94.7322, loss: 0.0163\n","2022-05-30 17:11:06,844 - mmseg - INFO - Iter [18500/20000]\tlr: 4.503e-06, eta: 0:21:20, time: 0.411, data_time: 0.026, memory: 3323, decode.loss_focal: 0.0176, decode.acc_seg: 94.2801, loss: 0.0176\n","2022-05-30 17:11:45,890 - mmseg - INFO - Iter [18600/20000]\tlr: 4.203e-06, eta: 0:19:52, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0183, decode.acc_seg: 93.9585, loss: 0.0183\n","2022-05-30 17:12:24,911 - mmseg - INFO - Iter [18700/20000]\tlr: 3.903e-06, eta: 0:18:23, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0172, decode.acc_seg: 94.2818, loss: 0.0172\n","2022-05-30 17:13:03,957 - mmseg - INFO - Iter [18800/20000]\tlr: 3.603e-06, eta: 0:16:55, time: 0.390, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0176, decode.acc_seg: 94.1175, loss: 0.0176\n","2022-05-30 17:13:43,009 - mmseg - INFO - Iter [18900/20000]\tlr: 3.303e-06, eta: 0:15:28, time: 0.391, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0175, decode.acc_seg: 94.3161, loss: 0.0175\n","2022-05-30 17:14:24,075 - mmseg - INFO - Saving checkpoint at 19000 iterations\n","2022-05-30 17:14:45,585 - mmseg - INFO - Iter [19000/20000]\tlr: 3.003e-06, eta: 0:14:02, time: 0.626, data_time: 0.027, memory: 3323, decode.loss_focal: 0.0213, decode.acc_seg: 92.9615, loss: 0.0213\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 450s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 17:22:15,471 - mmseg - INFO - per class results:\n","2022-05-30 17:22:15,473 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.13 | 97.01 |\n","|    road    | 64.85 | 74.26 |\n","+------------+-------+-------+\n","2022-05-30 17:22:15,474 - mmseg - INFO - Summary:\n","2022-05-30 17:22:15,480 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.13 | 78.49 | 85.64 |\n","+-------+-------+-------+\n","2022-05-30 17:22:15,481 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9313, mIoU: 0.7849, mAcc: 0.8564, IoU.background: 0.9213, IoU.road: 0.6485, Acc.background: 0.9701, Acc.road: 0.7426\n","2022-05-30 17:22:54,706 - mmseg - INFO - Iter [19100/20000]\tlr: 2.703e-06, eta: 0:12:57, time: 4.891, data_time: 4.507, memory: 3323, decode.loss_focal: 0.0177, decode.acc_seg: 94.1112, loss: 0.0177\n","2022-05-30 17:23:33,732 - mmseg - INFO - Iter [19200/20000]\tlr: 2.403e-06, eta: 0:11:29, time: 0.390, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0181, decode.acc_seg: 94.1330, loss: 0.0181\n","2022-05-30 17:24:12,871 - mmseg - INFO - Iter [19300/20000]\tlr: 2.103e-06, eta: 0:10:01, time: 0.391, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0196, decode.acc_seg: 93.4789, loss: 0.0196\n","2022-05-30 17:24:52,031 - mmseg - INFO - Iter [19400/20000]\tlr: 1.803e-06, eta: 0:08:34, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0177, decode.acc_seg: 94.2472, loss: 0.0177\n","2022-05-30 17:25:31,279 - mmseg - INFO - Iter [19500/20000]\tlr: 1.503e-06, eta: 0:07:07, time: 0.392, data_time: 0.007, memory: 3323, decode.loss_focal: 0.0182, decode.acc_seg: 93.9925, loss: 0.0182\n","2022-05-30 17:26:12,587 - mmseg - INFO - Iter [19600/20000]\tlr: 1.203e-06, eta: 0:05:40, time: 0.413, data_time: 0.028, memory: 3323, decode.loss_focal: 0.0170, decode.acc_seg: 94.4787, loss: 0.0170\n","2022-05-30 17:26:51,692 - mmseg - INFO - Iter [19700/20000]\tlr: 9.030e-07, eta: 0:04:14, time: 0.391, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0174, decode.acc_seg: 94.3062, loss: 0.0174\n","2022-05-30 17:27:30,814 - mmseg - INFO - Iter [19800/20000]\tlr: 6.030e-07, eta: 0:02:49, time: 0.391, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0187, decode.acc_seg: 93.9147, loss: 0.0187\n","2022-05-30 17:28:09,662 - mmseg - INFO - Iter [19900/20000]\tlr: 3.030e-07, eta: 0:01:24, time: 0.388, data_time: 0.006, memory: 3323, decode.loss_focal: 0.0178, decode.acc_seg: 94.1238, loss: 0.0178\n","2022-05-30 17:28:48,777 - mmseg - INFO - Saving checkpoint at 20000 iterations\n","2022-05-30 17:29:08,735 - mmseg - INFO - Iter [20000/20000]\tlr: 3.000e-09, eta: 0:00:00, time: 0.591, data_time: 0.008, memory: 3323, decode.loss_focal: 0.0187, decode.acc_seg: 93.8396, loss: 0.0187\n"]},{"output_type":"stream","name":"stdout","text":["[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 66/66, 0.1 task/s, elapsed: 451s, ETA:     0s"]},{"output_type":"stream","name":"stderr","text":["2022-05-30 17:36:39,413 - mmseg - INFO - per class results:\n","2022-05-30 17:36:39,414 - mmseg - INFO - \n","+------------+-------+-------+\n","|   Class    |  IoU  |  Acc  |\n","+------------+-------+-------+\n","| background | 92.13 | 97.14 |\n","|    road    | 64.62 | 73.59 |\n","+------------+-------+-------+\n","2022-05-30 17:36:39,416 - mmseg - INFO - Summary:\n","2022-05-30 17:36:39,417 - mmseg - INFO - \n","+-------+-------+-------+\n","|  aAcc |  mIoU |  mAcc |\n","+-------+-------+-------+\n","| 93.12 | 78.38 | 85.37 |\n","+-------+-------+-------+\n","2022-05-30 17:36:39,423 - mmseg - INFO - Iter(val) [66]\taAcc: 0.9312, mIoU: 0.7838, mAcc: 0.8537, IoU.background: 0.9213, IoU.road: 0.6462, Acc.background: 0.9714, Acc.road: 0.7359\n"]}],"source":["from mmseg.datasets import build_dataset\n","from mmseg.models import build_segmentor\n","from mmseg.apis import train_segmentor\n","\n","# Build the dataset\n","datasets = [build_dataset(cfg.data.train)]\n","\n","# Build the detector\n","model = build_segmentor(\n","    cfg.model, train_cfg=cfg.get('train_cfg'), test_cfg=cfg.get('test_cfg'))\n","\n","# Add an attribute for visualization convenience\n","model.CLASSES = datasets[0].CLASSES\n","\n","# Create work_dir\n","mmcv.mkdir_or_exist(osp.abspath(cfg.work_dir))\n","train_segmentor(model, datasets, cfg, distributed=False, validate=True,\n","                meta=dict(CLASSES=classes, PALETTE=palette))"]},{"cell_type":"markdown","source":["### 모델 결과 시각화"],"metadata":{"id":"Pre69QNK_dwU"}},{"cell_type":"code","source":["img_result = ['BLD00002_PS3_K3A_NIA0276.png',\n","              'BLD00010_PS3_K3A_NIA0276.png',\n","              'BLD00047_PS3_K3A_NIA0276.png',\n","              'BLD12071_PS3_K3A_NIA0391.png',\n","              'BLD11907_PS3_K3A_NIA0391.png',\n","              'BLD11611_PS3_K3A_NIA0390.png',\n","              'BLD11474_PS3_K3A_NIA0390.png',\n","              'BLD10413_PS3_K3A_NIA0388.png',\n","              'BLD10150_PS3_K3A_NIA0388.png',\n","              'BLD00836_PS3_K3A_NIA0277.png']\n","\n","checkpoint_file = '/content/drive/MyDrive/SIA/semantic_checkpoint/Segformer/road/DFL_class2/iter_20000.pth'  #학습된 모델\n","\n","\n","# checkpoint 저장된 model 파일을 이용하여 모델을 생성, 이때 Config는 위에서 update된 config 사용. \n","model_ckpt = init_segmentor(cfg, checkpoint_file, device='cuda:0')  #cuda gpu 사용\n","\n","for ir in range(len(img_result)):\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+img_result[ir])\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)\n"],"metadata":{"id":"v2VyaZksCGEP","executionInfo":{"status":"ok","timestamp":1653932282648,"user_tz":-540,"elapsed":81588,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1JX6e6ahJS_qKaki6F-k4vdHoX6AzTEpv"},"outputId":"cc941949-bc2f-466e-c66e-681f9b6b9d79"},"execution_count":17,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]},{"cell_type":"code","source":["import os\n","file_list = os.listdir('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val')\n","test_png = []\n","for i in file_list:\n","  if '.png' in i:\n","    test_png.append(i)\n","\n","for j in test_png:\n","  img = mmcv.imread('/content/drive/MyDrive/SIA/Data_set/road_dataset/img_dir/val/'+j)\n","  result = inference_segmentor(model_ckpt, img)\n","  show_result_pyplot(model_ckpt, img, result, palette)"],"metadata":{"id":"MGL7wC0QE_Lp","executionInfo":{"status":"ok","timestamp":1653933255460,"user_tz":-540,"elapsed":972825,"user":{"displayName":"po6ba paul","userId":"06984546638095914625"}},"colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1KErP8JKGEKqSc55kNgM80gTnA8bQkfjb"},"outputId":"1b094eaa-9f87-4769-93d8-9e07589c934e"},"execution_count":18,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"machine_shape":"hm","name":"Segformer_road_512x512_iter_20k_loss_focal.ipynb의 사본","provenance":[{"file_id":"1-tUNSqxwGyamS6a3CkRHoXF5GMszfber","timestamp":1652320453219}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}